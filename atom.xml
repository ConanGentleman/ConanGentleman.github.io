<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>MiDoLi&#39;s Blog</title>
  
  <subtitle>Code builds world !</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-12-01T15:05:42.330Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>MiDoLi</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Unity编辑器拓展（七）-Scene窗口拓展</title>
    <link href="http://example.com/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/"/>
    <id>http://example.com/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/</id>
    <published>2025-11-11T14:03:13.000Z</published>
    <updated>2025-12-01T15:05:42.330Z</updated>
    
    <content type="html"><![CDATA[<p>Unity编辑器拓展（七）-Scene窗口拓展 学习笔记</p><span id="more"></span><h1 id="%E4%B8%80%E3%80%81-handles%E7%B1%BB%E6%98%AF%E4%BB%80%E4%B9%88%E5%8F%8A%E5%93%8D%E5%BA%94%E5%87%BD%E6%95%B0" tabindex="-1">一、 Handles类是什么及响应函数</h1><h2 id="1.1-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%80-handles%E5%85%AC%E5%85%B1%E7%B1%BB%E7%9A%84%E4%BD%9C%E7%94%A8" tabindex="-1">1.1 知识点一 Handles公共类的作用</h2><p>Handles类提供了很多API</p><ul><li><p>让我们可以在Scene窗口中绘制我们的自定义内容</p></li><li><p>它和GUI、EditorGUI类似，只不过它专门提供给Scene窗口使用</p></li><li><p>想要在Scene窗口中显示自定义内容，我们<strong>需要在对应的响应函数中进行处理</strong></p></li></ul><h2 id="1.2-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%BA%8C-scene%E7%AA%97%E5%8F%A3%E6%9B%B4%E6%96%B0%E5%93%8D%E5%BA%94%E5%87%BD%E6%95%B0" tabindex="-1">1.2 知识点二 Scene窗口更新响应函数</h2><p>关键点：<br>前两个步骤 和自定义Inspector窗口显示内容 一致</p><ol><li><p>单独为某一个脚本实现一个自定义脚本，并且脚本需要继承Editor</p><ul><li>一般该脚本命名为 自定义脚本名 + Editor</li></ul></li><li><p>在该脚本前加上特性</p><ul><li>命名空间：UnityEditor</li><li>特性名：CustomEditor(想要自定义脚本类名的Type)</li></ul></li><li><p>在该脚本中实现void OnSceneGUI()方法</p><ul><li><strong>该方法会在我们选中挂载自定义脚本的对象时自动更新</strong></li><li><strong>注意：只有选中时才会执行，没有选中不执行</strong></li></ul></li></ol><h2 id="1.3-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%89-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%AA%97%E5%8F%A3%E4%B8%AD%E7%9B%91%E5%90%ACscene%E7%AA%97%E5%8F%A3%E6%9B%B4%E6%96%B0%E5%93%8D%E5%BA%94%E5%87%BD%E6%95%B0" tabindex="-1">1.3 知识点三 自定义窗口中监听Scene窗口更新响应函数</h2><p>可以在自定义窗口显示时</p><ul><li>监听更新事件</li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SceneView.duringSceneGui += 事件函数</span><br></pre></td></tr></table></figure><ul><li>窗口隐藏或销毁时移除事件</li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SceneView.duringSceneGui -= 事件函数</span><br></pre></td></tr></table></figure><h2 id="1.4-%E6%80%BB%E7%BB%93" tabindex="-1">1.4 总结</h2><p>Scene窗口拓展功能<br>主要是提供给自定义脚本和自定义窗口的<br>我们采用对应的规则进行处理<br>便可以在之后的章节中利用场景更新响应函数来自定义一些Scene窗口的显示内容</p><h2 id="1.5-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" tabindex="-1">1.5 代码示例</h2><ol><li>scene窗口更新响应函数</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lesson26.cs</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson26</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//lesson26Editor</span></span><br><span class="line">[<span class="meta">CustomEditor(typeof(Lesson26))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson26Editor</span> : <span class="title">Editor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnSceneGUI</span>() <span class="comment">//选中挂载了Lesson26的对象时会调用该函数</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;Scene窗口拓展相关逻辑&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>自定义窗口监听scene窗口更新响应函数</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson26Window</span> : <span class="title">EditorWindow</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">MenuItem(<span class="string">&quot;Unity编辑器拓展/Lesson26/打开Scene拓展窗口&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OpenLesson26</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Lesson26Window win = EditorWindow.GetWindow&lt;Lesson26Window&gt;();</span><br><span class="line">        win.Show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        SceneView.duringSceneGui += SceneUpdate; <span class="comment">//Scene视图每次调用 OnGUI 方法时会触发一次duringSceneGui</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnDestroy</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        SceneView.duringSceneGui -= SceneUpdate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SceneUpdate</span>(<span class="params">SceneView view</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;自定义窗口拓展Scene相关内容&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1.6-%E6%95%88%E6%9E%9C" tabindex="-1">1.6 效果</h2><p>包含函数和自定义窗口监听scene更新<br><img src="/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L26Handles%E7%B1%BB%E6%98%AF%E4%BB%80%E4%B9%88%E5%8F%8A%E5%93%8D%E5%BA%94%E5%87%BD%E6%95%B0.gif" alt></p><h1 id="%E4%BA%8C%E3%80%81handles%E7%B1%BB%E4%B8%AD%E7%9A%84-%E6%96%87%E6%9C%AC%E3%80%81%E7%BA%BF%E6%AE%B5%E3%80%81%E8%99%9A%E7%BA%BF%E6%8E%A7%E4%BB%B6" tabindex="-1">二、Handles类中的 文本、线段、虚线控件</h1><p>知识点回顾 Editor中的target成员</p><ol><li>我们可以利用继承Editor基类中的target成员获取到拓展的组件对象</li></ol><h2 id="2.1-handles%E4%B8%AD%E7%9A%84%E9%A2%9C%E8%89%B2%E6%8E%A7%E5%88%B6" tabindex="-1">2.1 Handles中的颜色控制</h2><p>调用Handles中的绘制API之前 设置颜色即可</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Handles.color = <span class="keyword">new</span> Color(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0.3f</span>);</span><br></pre></td></tr></table></figure><h2 id="2.2-handles%E4%B8%AD%E7%9A%84%E6%96%87%E6%9C%AC%E6%8E%A7%E4%BB%B6" tabindex="-1">2.2 Handles中的文本控件</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Handles.Label(显示位置, 文本内容);</span><br></pre></td></tr></table></figure><h2 id="2.3-handles%E4%B8%AD%E7%9A%84%E7%BA%BF%E6%AE%B5%E6%8E%A7%E4%BB%B6" tabindex="-1">2.3 Handles中的线段控件</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Handles.DrawLine(起点, 终点, 粗细);</span><br></pre></td></tr></table></figure><h2 id="2.4-handles%E4%B8%AD%E7%9A%84%E8%99%9A%E7%BA%BF%E6%8E%A7%E4%BB%B6" tabindex="-1">2.4 Handles中的虚线控件</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Handles.DrawDottedLine(起点, 终点, 粗细);</span><br></pre></td></tr></table></figure><h2 id="2.5-%E4%BB%A3%E7%A0%81" tabindex="-1">2.5 代码</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">CustomEditor(typeof(Lesson26))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson26Editor</span> : <span class="title">Editor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Lesson26 obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        obj = target <span class="keyword">as</span> Lesson26;<span class="comment">//获取脚本挂载的obj</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnSceneGUI</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;Scene窗口拓展相关逻辑&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//颜色</span></span><br><span class="line">        Handles.color = <span class="keyword">new</span> Color(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1f</span>);</span><br><span class="line">        <span class="comment">//文本</span></span><br><span class="line">        Handles.Label(obj.transform.position, <span class="string">&quot;测试文本显示&quot;</span>);</span><br><span class="line">        <span class="comment">//线段</span></span><br><span class="line">        Handles.DrawLine(obj.transform.position, obj.transform.position + obj.transform.right * <span class="number">5</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="comment">//虚线</span></span><br><span class="line">        Handles.color = <span class="keyword">new</span> Color(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1f</span>);</span><br><span class="line">        Handles.DrawDottedLine(obj.transform.position, obj.transform.position + obj.transform.forward * <span class="number">5</span>, <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2.6-%E6%95%88%E6%9E%9C" tabindex="-1">2.6 效果</h2><p>文字、红色线段，蓝色虚线<br><img src="/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L27Handles%E7%B1%BB%E4%B8%AD%E7%9A%84%20%E6%96%87%E6%9C%AC%E3%80%81%E7%BA%BF%E6%AE%B5%E3%80%81%E8%99%9A%E7%BA%BF%E6%8E%A7%E4%BB%B6.png" alt></p><h1 id="%E4%B8%89%E3%80%81handles%E7%B1%BB%E4%B8%AD%E7%9A%84-%E5%BC%A7%E7%BA%BF%E3%80%81%E5%9C%86%E3%80%81%E7%AB%8B%E6%96%B9%E4%BD%93%E3%80%81%E5%87%A0%E4%BD%95%E4%BD%93" tabindex="-1">三、Handles类中的 弧线、圆、立方体、几何体</h1><h2 id="3.1-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%80-handles%E4%B8%AD%E7%9A%84%E5%BC%A7%E7%BA%BF(%E5%9C%86%E5%BC%A7)" tabindex="-1">3.1 知识点一 Handles中的弧线(圆弧)</h2><ol><li>绘制线框弧线<br>Handles.DrawWireArc(圆心, 法线, 绘制朝向(起始方向), 角度, 半径);</li><li>绘制填充弧线<br>Handles.DrawSolidArc(圆心, 法线, 绘制朝向(起始方向), 角度, 半径);</li></ol><h2 id="3.2-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%BA%8C-handles%E4%B8%AD%E7%9A%84%E5%9C%86" tabindex="-1">3.2 知识点二 Handles中的圆</h2><ol><li><p>绘制填充圆<br>Handles.DrawSolidDisc(圆心, 法线, 半径);</p></li><li><p>绘制线框圆<br>Handles.DrawWireDisc(圆心, 法线, 半径);</p></li></ol><h2 id="3.3-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%89-handles%E4%B8%AD%E7%9A%84%E7%AB%8B%E6%96%B9%E4%BD%93%E7%BA%BF%E6%A1%86" tabindex="-1">3.3 知识点三 Handles中的立方体线框</h2><p>Handles.DrawWireCube(中心点, xyz大小);</p><h2 id="3.4-%E7%9F%A5%E8%AF%86%E7%82%B9%E5%9B%9B-handles%E4%B8%AD%E7%9A%84%E5%87%A0%E4%BD%95%E4%BD%93" tabindex="-1">3.4 知识点四 Handles中的几何体</h2><p>Handles.DrawAAConvexPolygon(几何体各顶点);</p><h2 id="3.5-%E4%BB%A3%E7%A0%81" tabindex="-1">3.5 代码</h2><p>弧线、圆、立方体，几何体</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">CustomEditor(typeof(Lesson26))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson26Editor</span> : <span class="title">Editor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Lesson26 obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        obj = target <span class="keyword">as</span> Lesson26;<span class="comment">//获取脚本挂载的obj</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnSceneGUI</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;Scene窗口拓展相关逻辑&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//弧线（圆弧）</span></span><br><span class="line">        Handles.color = Color.white;</span><br><span class="line">        Handles.DrawWireArc(obj.transform.position, Vector3.up, obj.transform.forward, <span class="number">30</span>, <span class="number">5</span>);</span><br><span class="line">        Handles.DrawSolidArc(obj.transform.position, obj.transform.up, Quaternion.Euler(<span class="number">0</span>, <span class="number">-15</span>, <span class="number">0</span>) * obj.transform.forward, <span class="number">30</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="comment">//圆</span></span><br><span class="line">        Handles.color = Color.gray;</span><br><span class="line">        Handles.DrawSolidDisc(obj.transform.position, obj.transform.up, <span class="number">2</span>);</span><br><span class="line">        Handles.DrawWireDisc(obj.transform.position, obj.transform.up, <span class="number">3</span>);</span><br><span class="line">        <span class="comment">//立方体</span></span><br><span class="line">        Handles.color = Color.red;</span><br><span class="line">        Handles.DrawWireCube(obj.transform.position, Vector3.one);</span><br><span class="line">        <span class="comment">//几何体</span></span><br><span class="line">        <span class="comment">//(0,0,0)</span></span><br><span class="line">        <span class="comment">//(1,0,0)</span></span><br><span class="line">        <span class="comment">//(1,0,1)</span></span><br><span class="line">        <span class="comment">//(0,0,z)</span></span><br><span class="line">        Handles.DrawAAConvexPolygon(Vector3.zero, Vector3.right, Vector3.right + Vector3.forward, Vector3.forward);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3.6-%E6%95%88%E6%9E%9C" tabindex="-1">3.6 效果</h2><p><img src="/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L28Handles%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%BC%A7%E7%BA%BF%E3%80%81%E5%9C%86%E3%80%81%E7%AB%8B%E6%96%B9%E4%BD%93%EF%BC%8C%E5%87%A0%E4%BD%95%E4%BD%93.png" alt></p><h1 id="%E5%9B%9B%E3%80%81handles%E7%B1%BB%E4%B8%AD%E7%9A%84-%E7%A7%BB%E5%8A%A8%E3%80%81%E6%97%8B%E8%BD%AC%E3%80%81%E7%BC%A9%E6%94%BE" tabindex="-1">四、Handles类中的 移动、旋转、缩放</h1><h2 id="4.1-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%80-handles%E4%B8%AD%E7%9A%84%E7%A7%BB%E5%8A%A8%E8%BD%B4" tabindex="-1">4.1  知识点一 Handles中的移动轴</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Vector3 Handles.DoPositionHandle(位置, 角度);</span><br><span class="line">Vector3 Handles.PositionHandle(位置, 角度);</span><br></pre></td></tr></table></figure><h2 id="4.2-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%BA%8C-handles%E4%B8%AD%E7%9A%84%E6%97%8B%E8%BD%AC%E8%BD%B4" tabindex="-1">4.2 知识点二 Handles中的旋转轴</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Quaternion Handles.DoRotationHandle(角度, 位置);</span><br><span class="line">Quaternion Handles.RotationHandle(角度, 位置);</span><br></pre></td></tr></table></figure><h2 id="4.3-handles%E4%B8%AD%E7%9A%84%E7%BC%A9%E6%94%BE%E8%BD%B4" tabindex="-1">4.3 Handles中的缩放轴</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Vector3 Handles.DoScaleHandle(缩放, 位置, 角度, HandleUtility.GetHandleSize(位置));</span><br><span class="line">Vector3 Handles.ScaleHandle(缩放, 位置, 角度, HandleUtility.GetHandleSize(位置));</span><br></pre></td></tr></table></figure><ol><li>HandleUtility.GetHandleSize方法的作用是</li></ol><ul><li>获取给定位置的操纵器控制柄的世界空间大小</li><li>使用当前相机计算合适的大小</li><li>它决定了控制柄的缩放大小</li></ul><h2 id="4.4-%E4%BB%A3%E7%A0%81" tabindex="-1">4.4 代码</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">CustomEditor(typeof(Lesson26))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson26Editor</span> : <span class="title">Editor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Lesson26 obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        obj = target <span class="keyword">as</span> Lesson26;<span class="comment">//获取脚本挂载的obj</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnSceneGUI</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;Scene窗口拓展相关逻辑&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//移动</span></span><br><span class="line">        obj.transform.position = Handles.DoPositionHandle(obj.transform.position, obj.transform.rotation);</span><br><span class="line">        <span class="comment">//obj.transform.position = Handles.PositionHandle(obj.transform.position, obj.transform.rotation);</span></span><br><span class="line">        <span class="comment">//旋转</span></span><br><span class="line">        <span class="comment">//obj.transform.rotation = Handles.DoRotationHandle(obj.transform.rotation, obj.transform.position) ;</span></span><br><span class="line">        obj.transform.rotation = Handles.RotationHandle(obj.transform.rotation, obj.transform.position);</span><br><span class="line">        <span class="comment">//缩放</span></span><br><span class="line">        obj.transform.localScale = Handles.DoScaleHandle(obj.transform.localScale, obj.transform.position, obj.transform.rotation,</span><br><span class="line">                                                         HandleUtility.GetHandleSize(obj.transform.position));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//obj.transform.localScale = Handles.ScaleHandle(obj.transform.localScale, obj.transform.position, obj.transform.rotation,</span></span><br><span class="line">        <span class="comment">//                                                 HandleUtility.GetHandleSize(Vector3.zero));</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4.5-%E6%95%88%E6%9E%9C" tabindex="-1">4.5 效果</h2><p>缩放、旋转、位置轴<br><img src="/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L29Handles%E7%B1%BB%E4%B8%AD%E7%9A%84%20%E7%A7%BB%E5%8A%A8%E3%80%81%E6%97%8B%E8%BD%AC%E3%80%81%E7%BC%A9%E6%94%BE.png" alt></p><h1 id="%E4%BA%94%E3%80%81handles%E7%B1%BB%E4%B8%AD%E7%9A%84-%E8%87%AA%E7%94%B1%E7%A7%BB%E5%8A%A8%E3%80%81%E8%87%AA%E7%94%B1%E6%97%8B%E8%BD%AC" tabindex="-1">五、Handles类中的 自由移动、自由旋转</h1><h2 id="%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE" tabindex="-1">知识回顾</h2><p>HandleUtility.GetHandleSize</p><ul><li>用于获取在 Scene 窗口中的一个单位距离所对应的屏幕空间大小</li><li>这个方法主要用于根据物体的距离来动态调整控制手柄的大小</li><li>使其在不同距离下能够在视图中显示合适的大小</li><li>一般我们把对象位置传递进去，他会自动得到一个句柄大小</li></ul><h2 id="5.1-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%80-handles%E4%B8%AD%E7%9A%84%E8%87%AA%E7%94%B1%E7%A7%BB%E5%8A%A8%EF%BC%88%E5%BD%93%E5%89%8D%E6%91%84%E5%83%8F%E6%9C%BA%E6%A8%AA%E6%88%AA%E9%9D%A2%EF%BC%89" tabindex="-1">5.1 知识点一 Handles中的自由移动（当前摄像机横截面）</h2><ul><li>一个不受约束的移动控制柄</li><li>这个把手可以在所有方向上自由移动</li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vector3 Handles.FreeMoveHandle(位置, 句柄大小, 移动步进值(按住ctrl键时会按该单位移动), 渲染控制手柄的回调函数);</span><br></pre></td></tr></table></figure><ol><li><p>句柄大小一般配合HandleUtility.GetHandleSize函数使用</p></li><li><p>渲染控制手柄的常用回调函数</p></li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Handles.RectangleHandleCap:一个矩形形状的控制手柄，通常用于表示一个平面的控制面</span><br><span class="line">Handles.CircleHandleCap:一个圆形的控制手柄，通常用于表示一个球体的控制面</span><br><span class="line">Handles.ArrowHandleCap:一个箭头形状的控制手柄，通常用于表示方向</span><br></pre></td></tr></table></figure><h2 id="5.2-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%BA%8C-handles%E4%B8%AD%E7%9A%84%E8%87%AA%E7%94%B1%E6%97%8B%E8%BD%AC" tabindex="-1">5.2 知识点二 Handles中的自由旋转</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Quaternion Handles.FreeRotateHandle(角度, 位置, 句柄大小);</span><br></pre></td></tr></table></figure><h2 id="5.3-%E4%BB%A3%E7%A0%81" tabindex="-1">5.3 代码</h2><pre><code>    //自由移动（当前摄像机横截面）    obj.transform.position = Handles.FreeMoveHandle(obj.transform.position, HandleUtility.GetHandleSize(obj.transform.position),                                                    Vector3.one * 5, Handles.CircleHandleCap);    //自由旋转    obj.transform.rotation = Handles.FreeRotateHandle(obj.transform.rotation, Vector3.zero, HandleUtility.GetHandleSize(Vector3.zero));</code></pre><h2 id="5.4-%E6%95%88%E6%9E%9C" tabindex="-1">5.4 效果</h2><p><img src="/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L30Handles%E7%B1%BB%E4%B8%AD%E7%9A%84%20%E8%87%AA%E7%94%B1%E7%A7%BB%E5%8A%A8%E3%80%81%E8%87%AA%E7%94%B1%E6%97%8B%E8%BD%AC.png" alt></p><h1 id="%E5%85%AD%E3%80%81handles%E7%B1%BB%E4%B8%AD%E7%9A%84-%E6%98%BE%E7%A4%BAgui" tabindex="-1">六、Handles类中的 显示GUI</h1><h2 id="6.1-scene%E4%B8%AD%E6%98%BE%E7%A4%BAgui" tabindex="-1">6.1 Scene中显示GUI</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Handles.BeginGUI();</span><br><span class="line">GUI相关代码</span><br><span class="line">Handles.EndGUI();</span><br></pre></td></tr></table></figure><h2 id="6.2-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%BA%8C-%E8%8E%B7%E5%8F%96scene%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F" tabindex="-1">6.2 知识点二 获取Scene窗口大小</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">获取当前Scene窗口信息</span><br><span class="line">SceneView.currentDrawingSceneView</span><br><span class="line">它继承自EditorWindow，因此通过position就能得到它的大小</span><br></pre></td></tr></table></figure><h2 id="6.3-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%89-handles%E6%9B%B4%E5%A4%9A%E5%86%85%E5%AE%B9(%E2%AD%90%E2%AD%90%E2%AD%90)" tabindex="-1">6.3 知识点三 Handles更多内容(⭐⭐⭐)</h2><p><a href="https://docs.unity3d.com/ScriptReference/Handles.html">https://docs.unity3d.com/ScriptReference/Handles.html</a></p><h2 id="6.4-%E4%BB%A3%E7%A0%81" tabindex="-1">6.4 代码</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">region</span> Lesson31 显示GUI</span></span><br><span class="line">       Handles.BeginGUI();</span><br><span class="line">       <span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;测试按钮&quot;</span>))</span><br><span class="line">       &#123;</span><br><span class="line">           Debug.Log(<span class="string">&quot;Scene中的按钮响应&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="built_in">float</span> w = SceneView.currentDrawingSceneView.position.width;</span><br><span class="line">       <span class="built_in">float</span> h = SceneView.currentDrawingSceneView.position.height;</span><br><span class="line"></span><br><span class="line">       GUILayout.BeginArea(<span class="keyword">new</span> Rect(w - <span class="number">100</span>, h - <span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>));</span><br><span class="line">       GUILayout.Label(<span class="string">&quot;测试文本控件显示&quot;</span>);</span><br><span class="line">       <span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;测试按钮&quot;</span>))</span><br><span class="line">       &#123;</span><br><span class="line">           Debug.Log(<span class="string">&quot;Scene中的按钮响应&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       GUILayout.EndArea();</span><br><span class="line"></span><br><span class="line">       Handles.EndGUI();</span><br><span class="line">       <span class="meta">#<span class="keyword">endregion</span></span></span><br></pre></td></tr></table></figure><h2 id="6.5-%E6%95%88%E6%9E%9C" tabindex="-1">6.5 效果</h2><p><img src="/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L31Handles%E7%B1%BB%E4%B8%AD%E7%9A%84%20%E6%98%BE%E7%A4%BAGUI.png" alt></p><h1 id="%E4%B8%83%E3%80%81%E5%89%8D%E5%87%A0%E4%B8%AA%E7%9A%84%E4%BB%A3%E7%A0%81%E6%B1%87%E6%80%BB" tabindex="-1">七、前几个的代码汇总</h1><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">CustomEditor(typeof(Lesson26))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson26Editor</span> : <span class="title">Editor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Lesson26 obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        obj = target <span class="keyword">as</span> Lesson26;<span class="comment">//获取脚本挂载的obj</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnSceneGUI</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;Scene窗口拓展相关逻辑&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> Lesson27 文本、线段、虚线</span></span><br><span class="line">        <span class="comment">//颜色</span></span><br><span class="line">        Handles.color = <span class="keyword">new</span> Color(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1f</span>);</span><br><span class="line">        <span class="comment">//文本</span></span><br><span class="line">        Handles.Label(obj.transform.position, <span class="string">&quot;测试文本显示&quot;</span>);</span><br><span class="line">        <span class="comment">//线段</span></span><br><span class="line">        Handles.DrawLine(obj.transform.position, obj.transform.position + obj.transform.right * <span class="number">5</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="comment">//虚线</span></span><br><span class="line">        Handles.color = <span class="keyword">new</span> Color(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1f</span>);</span><br><span class="line">        Handles.DrawDottedLine(obj.transform.position, obj.transform.position + obj.transform.forward * <span class="number">5</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> Lesson28 弧线、圆、立方体，几何体</span></span><br><span class="line">        <span class="comment">//弧线（圆弧）</span></span><br><span class="line">        Handles.color = Color.white;</span><br><span class="line">        Handles.DrawWireArc(obj.transform.position, Vector3.up, obj.transform.forward, <span class="number">30</span>, <span class="number">5</span>);</span><br><span class="line">        Handles.DrawSolidArc(obj.transform.position, obj.transform.up, Quaternion.Euler(<span class="number">0</span>, <span class="number">-15</span>, <span class="number">0</span>) * obj.transform.forward, <span class="number">30</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="comment">//圆</span></span><br><span class="line">        Handles.color = Color.gray;</span><br><span class="line">        Handles.DrawSolidDisc(obj.transform.position, obj.transform.up, <span class="number">2</span>);</span><br><span class="line">        Handles.DrawWireDisc(obj.transform.position, obj.transform.up, <span class="number">3</span>);</span><br><span class="line">        <span class="comment">//立方体</span></span><br><span class="line">        Handles.color = Color.red;</span><br><span class="line">        Handles.DrawWireCube(obj.transform.position, Vector3.one);</span><br><span class="line">        <span class="comment">//几何体</span></span><br><span class="line">        <span class="comment">//(0,0,0)</span></span><br><span class="line">        <span class="comment">//(1,0,0)</span></span><br><span class="line">        <span class="comment">//(1,0,1)</span></span><br><span class="line">        <span class="comment">//(0,0,z)</span></span><br><span class="line">        Handles.DrawAAConvexPolygon(Vector3.zero, Vector3.right, Vector3.right + Vector3.forward, Vector3.forward);</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> Lesson29 移动、旋转、缩放</span></span><br><span class="line">        <span class="comment">//移动</span></span><br><span class="line">        obj.transform.position = Handles.DoPositionHandle(obj.transform.position, obj.transform.rotation);</span><br><span class="line">        <span class="comment">//obj.transform.position = Handles.PositionHandle(obj.transform.position, obj.transform.rotation);</span></span><br><span class="line">        <span class="comment">//旋转</span></span><br><span class="line">        <span class="comment">//obj.transform.rotation = Handles.DoRotationHandle(obj.transform.rotation, obj.transform.position) ;</span></span><br><span class="line">        obj.transform.rotation = Handles.RotationHandle(obj.transform.rotation, obj.transform.position);</span><br><span class="line">        <span class="comment">//缩放</span></span><br><span class="line">        obj.transform.localScale = Handles.DoScaleHandle(obj.transform.localScale, obj.transform.position, obj.transform.rotation,</span><br><span class="line">                                                         HandleUtility.GetHandleSize(obj.transform.position));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//obj.transform.localScale = Handles.ScaleHandle(obj.transform.localScale, obj.transform.position, obj.transform.rotation,</span></span><br><span class="line">        <span class="comment">//                                                 HandleUtility.GetHandleSize(Vector3.zero));</span></span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> Lesson30 自由移动，自由旋转</span></span><br><span class="line">        <span class="comment">//自由移动</span></span><br><span class="line">        obj.transform.position = Handles.FreeMoveHandle(obj.transform.position, HandleUtility.GetHandleSize(obj.transform.position),</span><br><span class="line">                                                        Vector3.one * <span class="number">5</span>, Handles.RectangleHandleCap);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//自由旋转</span></span><br><span class="line">        obj.transform.rotation = Handles.FreeRotateHandle(obj.transform.rotation, Vector3.zero, HandleUtility.GetHandleSize(Vector3.zero));</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="keyword">region</span> Lesson31 显示GUI</span></span><br><span class="line">        Handles.BeginGUI();</span><br><span class="line">        <span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;测试按钮&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(<span class="string">&quot;Scene中的按钮响应&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">float</span> w = SceneView.currentDrawingSceneView.position.width;</span><br><span class="line">        <span class="built_in">float</span> h = SceneView.currentDrawingSceneView.position.height;</span><br><span class="line"></span><br><span class="line">        GUILayout.BeginArea(<span class="keyword">new</span> Rect(w - <span class="number">100</span>, h - <span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>));</span><br><span class="line">        GUILayout.Label(<span class="string">&quot;测试文本控件显示&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;测试按钮&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(<span class="string">&quot;Scene中的按钮响应&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        GUILayout.EndArea();</span><br><span class="line"></span><br><span class="line">        Handles.EndGUI();</span><br><span class="line">        <span class="meta">#<span class="keyword">endregion</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="%E5%85%AB%E3%80%81handleutility%E5%85%AC%E5%85%B1%E7%B1%BB" tabindex="-1">八、HandleUtility公共类</h1><h2 id="8.1-%23region-%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE-%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E4%B8%8A%E9%BC%A0%E6%A0%87%E4%BD%8D%E7%BD%AE" tabindex="-1">8.1 #region 知识回顾 获取窗口上鼠标位置</h2><p>Event.current.mousePosition</p><h2 id="8.2-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%80-handleutility%E5%85%AC%E5%85%B1%E7%B1%BB%E7%9A%84%E4%B8%BB%E8%A6%81%E4%BD%9C%E7%94%A8" tabindex="-1">8.2 知识点一 HandleUtility公共类的主要作用</h2><ul><li>HandleUtility是 Unity 中的一个工具类</li><li>用于处理场景中的编辑器句柄（Handles）以及其他一些与编辑器交互相关的功能</li><li>它提供了一系列静态方法，用于处理编辑器中的鼠标交互、坐标转换以及其他与Handles相关的功能</li></ul><h2 id="8.3-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%BA%8C-handleutility%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%B8%B8%E7%94%A8api" tabindex="-1">8.3 知识点二 HandleUtility类中的常用API</h2><ol><li>GetHandleSize(Vector3 position)</li></ol><ul><li>我们之前已经使用过的API</li><li>获取在场景中给定位置的句柄的合适尺寸</li><li>该方法通常用于根据场景中对象的距离来调整句柄的大小，以便在不同的缩放级别下保持合适的显示大小</li></ul><ol start="2"><li>WorldToGUIPoint(Vector3 worldPosition)</li></ol><ul><li>将世界坐标转换为 GUI 坐标</li><li>这个方法通常用于将场景中的某个点的位置转换为屏幕上的像素坐标</li><li>以便在 GUI 中绘制相关的信息</li></ul><ol start="3"><li>GUIPointToWorldRay(Vector2 position)</li></ol><ul><li>将屏幕上的像素坐标转换为射线</li><li>这个方法通常用于从屏幕坐标中获取一条射线，用于检测场景中的物体或进行射线投射</li></ul><ol start="4"><li>DistanceToLine(Vector3 lineStart, Vector3 lineEnd)</li></ol><ul><li>计算场景中一条线段与鼠标光标的最短距离</li><li>可以用来制作悬停变色等功能</li></ul><ol start="5"><li>PickGameObject(Vector2 position, bool isSelecting)<br>在编辑器中进行对象的拾取<br>这个方法通常用于根据鼠标光标位置获取场景中的对象，以实现对象的选择或交互操作</li></ol><h2 id="8.4-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%89-%E6%9B%B4%E5%A4%9A%E5%86%85%E5%AE%B9" tabindex="-1">8.4 知识点三 更多内容</h2><p><a href="https://docs.unity3d.com/ScriptReference/HandleUtility.html">https://docs.unity3d.com/ScriptReference/HandleUtility.html</a></p><h2 id="8.5-%E4%BB%A3%E7%A0%81" tabindex="-1">8.5 代码</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">CustomEditor(typeof(Lesson26))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson26Editor</span> : <span class="title">Editor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Lesson26 obj;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        obj = target <span class="keyword">as</span> Lesson26;<span class="comment">//获取脚本挂载的obj</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnSceneGUI</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//1.GetHandleSize(Vector3 position)</span></span><br><span class="line">        <span class="comment">//  之前学习过 所以不需要举例</span></span><br><span class="line">        <span class="comment">//2.WorldToGUIPoint(Vector3 worldPosition)</span></span><br><span class="line">        Vector2 pos = HandleUtility.WorldToGUIPoint(obj.transform.position);</span><br><span class="line">        Handles.BeginGUI();</span><br><span class="line">        GUI.Button(<span class="keyword">new</span> Rect(pos.x, pos.y, <span class="number">50</span>, <span class="number">20</span>), <span class="string">&quot;测试按钮&quot;</span>);</span><br><span class="line">        Handles.EndGUI();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.GUIPointToWorldRay(Vector2 position)</span></span><br><span class="line">        Ray r = HandleUtility.GUIPointToWorldRay(Event.current.mousePosition);</span><br><span class="line">        RaycastHit info;</span><br><span class="line">        <span class="keyword">if</span> (Physics.Raycast(r, <span class="keyword">out</span> info))</span><br><span class="line">            Debug.Log(info.collider.name);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.DistanceToLine(Vector3 lineStart, Vector3 lineEnd)</span></span><br><span class="line">        <span class="built_in">float</span> dis = HandleUtility.DistanceToLine(Vector3.zero, Vector3.right);</span><br><span class="line">        <span class="comment">//Debug.Log(dis);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.PickGameObject(Vector2 position, bool isSelecting)</span></span><br><span class="line">        GameObject testObj = HandleUtility.PickGameObject(Event.current.mousePosition, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">if</span> (testObj != <span class="literal">null</span>)</span><br><span class="line">            Debug.Log(<span class="string">&quot;选择对象的名字：&quot;</span> + testObj.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8.6-%E6%95%88%E6%9E%9C" tabindex="-1">8.6 效果</h2><p><img src="/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L32HandleUtility%E5%85%AC%E5%85%B1%E7%B1%BB.png" alt><br>距离线段距离<br><img src="/2025/11/11/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AB-Scene%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L32HandleUtility%E5%85%AC%E5%85%B1%E7%B1%BB-%E7%BA%BF%E6%AE%B5%E8%B7%9D%E7%A6%BB.png" alt></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;Unity编辑器拓展（七）-Scene窗口拓展 学习笔记&lt;/p&gt;</summary>
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity编辑器拓展" scheme="http://example.com/tags/Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95/"/>
    
  </entry>
  
  <entry>
    <title>基于UE5的多人联机TPS游戏deme</title>
    <link href="http://example.com/2025/11/09/ue5%E7%9B%B8%E5%85%B3-ue5-online-TPS/"/>
    <id>http://example.com/2025/11/09/ue5%E7%9B%B8%E5%85%B3-ue5-online-TPS/</id>
    <published>2025-11-09T15:40:02.000Z</published>
    <updated>2025-11-09T15:41:54.530Z</updated>
    
    <content type="html"><![CDATA[<p>做了个新的demo，基于UE5的多人联机TPS游戏</p><p>链接：<a href="https://www.bilibili.com/video/BV1Mx1jBzErz/?spm_id_from=333.1387.homepage.video_card.click">https://www.bilibili.com/video/BV1Mx1jBzErz/?spm_id_from=333.1387.homepage.video_card.click</a></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;做了个新的demo，基于UE5的多人联机TPS游戏&lt;/p&gt;
&lt;p&gt;链接：&lt;a href=&quot;https://www.bilibili.com/video/BV1Mx1jBzErz/?spm_id_from=333.1387.homepage.video_card.click&quot;</summary>
      
    
    
    
    <category term="ue5" scheme="http://example.com/categories/ue5/"/>
    
    
    <category term="ue5" scheme="http://example.com/tags/ue5/"/>
    
  </entry>
  
  <entry>
    <title>Unity编辑器拓展（七）-Inspector窗口拓展</title>
    <link href="http://example.com/2025/04/27/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%83-Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/"/>
    <id>http://example.com/2025/04/27/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%83-Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/</id>
    <published>2025-04-27T14:23:20.000Z</published>
    <updated>2025-11-09T14:36:04.138Z</updated>
    
    <content type="html"><![CDATA[<p>Inspector窗口拓展相关内容</p><span id="more"></span><h1 id="%E4%B8%80%E3%80%81inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86" tabindex="-1">一、Inspector窗口拓展 基础知识</h1><h2 id="1.1-inspector%E7%AA%97%E5%8F%A3%E8%87%AA%E5%AE%9A%E4%B9%89%E6%98%BE%E7%A4%BA%E6%8C%87%E4%BB%80%E4%B9%88%EF%BC%9F" tabindex="-1">1.1 Inspector窗口自定义显示指什么？</h2><ul><li>我可以完全自定义某一个脚本在Inspector窗口的相关显示</li></ul><h2 id="1.2-serializedobject%E5%92%8Cserializedproperty%E7%9A%84%E4%BD%9C%E7%94%A8" tabindex="-1">1.2 SerializedObject和SerializedProperty的作用</h2><ul><li><p>SerializedObject 和 SerializedProperty</p><ul><li>主要用于在 Unity 编辑器中操作和修改序列化对象的属性。</li><li>它们通常在自定义编辑器中使用，以创建更灵活、可定制的属性面板</li></ul></li><li><p>我们只需要记住简单的规则</p><ul><li><strong>SerializedObject 代表脚本对象</strong> ⭐⭐⭐</li><li><strong>SerializedProperty 代表脚本对象中的属性</strong> ⭐⭐⭐</li></ul></li></ul><p>SerializedObject: <a href="https://docs.unity.cn/cn/2022.1/ScriptReference/SerializedObject.html">https://docs.unity.cn/cn/2022.1/ScriptReference/SerializedObject.html</a><br>SerializedProperty: <a href="https://docs.unity.cn/cn/2022.1/ScriptReference/SerializedProperty.html">https://docs.unity.cn/cn/2022.1/ScriptReference/SerializedProperty.html</a></p><h2 id="1.3-%E8%87%AA%E5%AE%9A%E4%B9%89-%E8%84%9A%E6%9C%AC%E5%9C%A8inspector%E7%AA%97%E5%8F%A3%E4%B8%AD%E6%98%BE%E7%A4%BA%E7%9A%84%E5%86%85%E5%AE%B9" tabindex="-1">1.3 自定义 脚本在Inspector窗口中显示的内容</h2><p>关键步骤：</p><ol><li>单独为某一个脚本实现一个自定义脚本，并且脚本需要继承Editor。<strong>一般该脚本命名为 自定义脚本名 + Editor</strong></li><li>在该脚本前加上特性<ul><li>命名空间：UnityEditor</li><li>特性名：CustomEditor(想要自定义脚本类名的Type)</li></ul></li><li>声明对应SerializedProperty序列化属性 对象<ul><li>主要通过它和自定义脚本中的成员进行关联</li><li>可以利用继承Editor后的成员serializedObject中的FindProperty(“成员变量名”)方法关联对应成员;<ul><li>例如：</li></ul>  <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SerializedProperty mySerializedProperty;</span><br><span class="line">mySerializedProperty = serializedObject.FindProperty(<span class="string">&quot;自定义脚本中的成员名&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>一般在OnEnable函数中初始化</li></ul></li></ul></li><li>重写OnInspectorGUI函数<ul><li>该函数控制了Inspector窗口中显示的内容</li><li>只需要在其中重写内容便可以自定义窗口</li><li>注意：其中的逻辑需要包裹在这两句代码之间</li></ul> <figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  更新序列化对象的表示形式</span></span><br><span class="line">serializedObject.Update();</span><br><span class="line"><span class="comment">//  之间应用属性修改</span></span><br><span class="line">serializedObject.ApplyModifiedProperties();</span><br></pre></td></tr></table></figure></li></ol><h2 id="1.4-%E8%8E%B7%E5%8F%96%E8%84%9A%E6%9C%AC%E4%BE%9D%E9%99%84%E7%9A%84%E5%AF%B9%E8%B1%A1" tabindex="-1">1.4 获取脚本依附的对象</h2><ul><li>通过Editor中的target成员变量获取，<strong>获取到的是依附在对象上的Lesson22组件对象并不是依附的GameObject</strong></li></ul><h2 id="1.5-%E6%80%BB%E7%BB%93" tabindex="-1">1.5 总结</h2><ul><li>为继承Editor的脚本添加[CustomEditor(typeof(想要自定义Inspector窗口的脚本))]特性</li><li>在该脚本中按照一定的规则进行编写</li><li>便可为Inspector窗口中的某个脚本自定义窗口布局</li></ul><h2 id="1.6-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" tabindex="-1">1.6 代码示例</h2><ol><li>Lesson22.cs（不能放在Editor文件夹下）</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//攻击力</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span> atk;</span><br><span class="line"><span class="comment">//防御力</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">float</span> def;</span><br><span class="line"><span class="comment">//敌对目标对象依附的Gameobject</span></span><br><span class="line"><span class="keyword">public</span> GameObject obj;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Start</span>()</span></span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update</span>()</span></span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>Lesson22Editor.cs(放在Editor文件夹下)</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过这个特性，我们就可以为Lesson22脚本自定义Inspector窗口中的显示了</span></span><br><span class="line">[<span class="meta">CustomEditor(typeof(Lesson22))</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson22Editor</span> : <span class="title">Editor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> SerializedProperty atk;</span><br><span class="line">    <span class="keyword">private</span> SerializedProperty def;</span><br><span class="line">    <span class="keyword">private</span> SerializedProperty obj;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">bool</span> foldOut;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        atk = serializedObject.FindProperty(<span class="string">&quot;atk&quot;</span>); <span class="comment">//关联Lesson22中的对应变量，serializedObject代表的就是Lesson22.cs</span></span><br><span class="line">        def = serializedObject.FindProperty(<span class="string">&quot;def&quot;</span>);</span><br><span class="line">        obj = serializedObject.FindProperty(<span class="string">&quot;obj&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  该函数控制了Inspector窗口中显示的内容</span></span><br><span class="line">    <span class="comment">//  只需要在其中重写内容便可以自定义窗口</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnInspectorGUI</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//base.OnInspectorGUI();</span></span><br><span class="line">        serializedObject.Update(); <span class="comment">//需要用Update()和ApplyModifiedProperties()进行包裹</span></span><br><span class="line">        <span class="comment">//自定义Inspector窗口的内容</span></span><br><span class="line">        foldOut = EditorGUILayout.BeginFoldoutHeaderGroup(foldOut, <span class="string">&quot;基础属性&quot;</span>); <span class="comment">//折叠控件（头）</span></span><br><span class="line">        <span class="keyword">if</span>(foldOut)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(GUILayout.Button(<span class="string">&quot;测试自定义Inspector窗口&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Debug.Log(target.name);</span><br><span class="line">            &#125;</span><br><span class="line">            EditorGUILayout.IntSlider(atk, <span class="number">0</span>, <span class="number">100</span>, <span class="string">&quot;攻击力&quot;</span>);</span><br><span class="line">            def.floatValue = EditorGUILayout.FloatField(<span class="string">&quot;防御力&quot;</span>, def.floatValue);</span><br><span class="line">            EditorGUILayout.ObjectField(obj, <span class="keyword">new</span> GUIContent(<span class="string">&quot;敌对对象&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        EditorGUILayout.EndFoldoutHeaderGroup(); <span class="comment">//折叠控件（尾）</span></span><br><span class="line">        serializedObject.ApplyModifiedProperties();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2025/04/27/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%83-Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L22Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.png" alt></p><h1 id="%E4%BA%8C%E3%80%81%E6%95%B0%E7%BB%84%E3%80%81list%E5%B1%9E%E6%80%A7-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%98%BE%E7%A4%BA" tabindex="-1">二、数组、List属性 自定义显示</h1><h2 id="2.1-%E6%95%B0%E7%BB%84%E3%80%81list%E5%B1%9E%E6%80%A7%E5%9C%A8inspector%E7%AA%97%E5%8F%A3%E6%98%BE%E7%A4%BA-%E5%9F%BA%E7%A1%80%E6%96%B9%E5%BC%8F" tabindex="-1">2.1 数组、List属性在Inspector窗口显示 基础方式</h2><ol><li>主要知识点：</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EditorGUILayout.PropertyField(SerializedProperty对象, 标题);</span><br><span class="line">    <span class="comment">//该API会按照属性类型自己去处理控件绘制的逻辑</span></span><br></pre></td></tr></table></figure><h2 id="2.2-%E6%95%B0%E7%BB%84%E3%80%81list%E5%B1%9E%E6%80%A7%E5%9C%A8inspector%E7%AA%97%E5%8F%A3%E6%98%BE%E7%A4%BA-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%B9%E5%BC%8F" tabindex="-1">2.2 数组、List属性在Inspector窗口显示 自定义方式</h2><p>如果我们不想要Unity默认的绘制方式去显示 数组、List相关内容<br>我们也可以完全自定义布局方式</p><ol><li>主要知识点：<br>利用SerializedProperty中数组相关的API来完成自定义<ul><li>(1) arraySize 获取数组或List容量</li><li>(2) InsertArrayElementAtIndex(索引) 为数组在指定索引插入默认元素（容量会变化）</li><li>(3).DeleteArrayElementAtIndex(索引) 为数组在指定索引删除元素（容量会变化）</li><li>(4).GetArrayElementAtIndex(索引) 获取数组中指定索引位置的 SerializedProperty 对象</li></ul></li></ol><h2 id="2.3-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" tabindex="-1">2.3 代码示例</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lesson22.cs</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>[] strs;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span>[] ints;</span><br><span class="line">    <span class="keyword">public</span> GameObject[] gameObjects;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;GameObject&gt; listObjs;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> count;</span><br><span class="line"></span><br><span class="line"><span class="comment">// lesson22Editor.cs</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SerializedProperty strs;</span><br><span class="line">    <span class="keyword">private</span> SerializedProperty ints;</span><br><span class="line">    <span class="keyword">private</span> SerializedProperty gameObjects;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SerializedProperty listObjs;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span>&#123;</span><br><span class="line">         <span class="comment">//默认得到的数组和List容量为空</span></span><br><span class="line">        strs = serializedObject.FindProperty(<span class="string">&quot;strs&quot;</span>); </span><br><span class="line">        ints = serializedObject.FindProperty(<span class="string">&quot;ints&quot;</span>); </span><br><span class="line">        gameObjects = serializedObject.FindProperty(<span class="string">&quot;gameObjects&quot;</span>); </span><br><span class="line"></span><br><span class="line">        listObjs = serializedObject.FindProperty(<span class="string">&quot;listObjs&quot;</span>);</span><br><span class="line">        <span class="comment">//初始化当前容量 否则 每次一开始都是0</span></span><br><span class="line">        count = listObjs.arraySize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnInspectorGUI</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        serializedObject.Update(); <span class="comment">//需要用Update()和ApplyModifiedProperties()进行包裹</span></span><br><span class="line">        <span class="comment">//容量设置</span></span><br><span class="line">        count = EditorGUILayout.IntField(<span class="string">&quot;List容量&quot;</span>, count);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//是否要缩减 移除尾部的内容</span></span><br><span class="line">        <span class="comment">//从后往前去移除 避免移除不干净</span></span><br><span class="line">        <span class="comment">//当容量变少时 才会走这的逻辑</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = listObjs.arraySize - <span class="number">1</span>; i &gt;= count; i--)</span><br><span class="line">            listObjs.DeleteArrayElementAtIndex(i);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//根据容量绘制需要设置的每一个索引位置的对象</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//去判断如果数组或者LIst容量不够 去通过插入的形式去扩容</span></span><br><span class="line">            <span class="keyword">if</span> (listObjs.arraySize &lt;= i)</span><br><span class="line">                listObjs.InsertArrayElementAtIndex(i);</span><br><span class="line"></span><br><span class="line">            SerializedProperty indexPro = listObjs.GetArrayElementAtIndex(i);</span><br><span class="line">            EditorGUILayout.ObjectField(indexPro, <span class="keyword">new</span> GUIContent(<span class="string">$&quot;索引<span class="subst">&#123;i&#125;</span>&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        EditorGUILayout.Space(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        EditorGUILayout.PropertyField(strs, <span class="keyword">new</span> GUIContent(<span class="string">&quot;字符串数组&quot;</span>)); <span class="comment">//不能放到折叠中（因为数组本身自带折叠</span></span><br><span class="line">        EditorGUILayout.PropertyField(ints, <span class="keyword">new</span> GUIContent(<span class="string">&quot;整形数组&quot;</span>)); <span class="comment">//不能放到折叠中（因为数组本身自带折叠</span></span><br><span class="line">        EditorGUILayout.PropertyField(gameObjects, <span class="keyword">new</span> GUIContent(<span class="string">&quot;游戏对象数组&quot;</span>)); <span class="comment">//不能放到折叠中（因为数组本身自带折叠</span></span><br><span class="line">        <span class="comment">//EditorGUILayout.PropertyField(listObjs, new GUIContent(&quot;游戏对象List&quot;));</span></span><br><span class="line">        serializedObject.ApplyModifiedProperties();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="2.4-%E6%95%88%E6%9E%9C" tabindex="-1">2.4 效果</h2><p><img src="/2025/04/27/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%83-Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L23Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95-%E6%95%B0%E7%BB%84%E3%80%81List%E5%B1%9E%E6%80%A7%20%E8%87%AA%E5%AE%9A%E4%B9%89%E6%98%BE%E7%A4%BA.png" alt></p><h1 id="%E4%B8%89%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%98%BE%E7%A4%BA" tabindex="-1">三、自定义属性 自定义显示</h1><h2 id="3.1-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7-%E5%9C%A8inspector%E7%AA%97%E5%8F%A3%E6%98%BE%E7%A4%BA-%E5%9F%BA%E7%A1%80%E6%96%B9%E5%BC%8F" tabindex="-1">3.1 自定义属性 在Inspector窗口显示 基础方式</h2><p>主要知识点：</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EditorGUILayout.PropertyField(SerializedProperty对象, 标题);</span><br><span class="line"><span class="comment">//该API会按照属性类型自己去处理控件绘制的逻辑</span></span><br></pre></td></tr></table></figure><h2 id="3.2-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7-%E5%9C%A8inspector%E7%AA%97%E5%8F%A3%E6%98%BE%E7%A4%BA-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%B9%E5%BC%8F" tabindex="-1">3.2 自定义属性 在Inspector窗口显示 自定义方式</h2><p>如果我们不想要Unity默认的绘制方式去显示 自定义数据结构类 相关内容<br>我们也可以完全自定义布局方式</p><ol><li>主要知识点：</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下面两种方法访问自定义属性的子属性</span></span><br><span class="line">SerializedProperty.FindPropertyRelative(属性)</span><br><span class="line">serializedObject.FindProperty(属性.子属性)</span><br></pre></td></tr></table></figure><h2 id="3.3-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" tabindex="-1">3.3 代码示例</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lesson22.cs</span></span><br><span class="line">[<span class="meta">Serializable</span>] <span class="comment">//想在inspector窗口上显示则 必加该特性 </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyCustonPro</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> i;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">float</span> f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson22</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">     <span class="keyword">public</span> MyCustonPro myCustom;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// lesson22Editor.cs</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        serializedObject.Update(); <span class="comment">//需要用Update()和ApplyModifiedProperties()进行包裹</span></span><br><span class="line">        myCustom = serializedObject.FindProperty(<span class="string">&quot;myCustom&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//下面两种获取方式</span></span><br><span class="line">        <span class="comment">//myCustomI = myCustom.FindPropertyRelative(&quot;i&quot;);</span></span><br><span class="line">        <span class="comment">//myCustomF = myCustom.FindPropertyRelative(&quot;f&quot;);</span></span><br><span class="line">        myCustomI = serializedObject.FindProperty(<span class="string">&quot;myCustom.i&quot;</span>);</span><br><span class="line">        myCustomF = serializedObject.FindProperty(<span class="string">&quot;myCustom.f&quot;</span>);</span><br><span class="line">        serializedObject.ApplyModifiedProperties();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="3.4-%E6%95%88%E6%9E%9C" tabindex="-1">3.4 效果</h2><p><img src="/2025/04/27/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%83-Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L24Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%20%E8%87%AA%E5%AE%9A%E4%B9%89%E6%98%BE%E7%A4%BA.png" alt></p><h1 id="%E5%9B%9B%E3%80%81%E5%AD%97%E5%85%B8%E5%B1%9E%E6%80%A7-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%98%BE%E7%A4%BA" tabindex="-1">四、字典属性 自定义显示</h1><h2 id="4.0-%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE-serizlizefield%E7%89%B9%E6%80%A7" tabindex="-1">4.0 知识回顾 SerizlizeField特性</h2><p>让私有字段可以被序列化（能够在Unity的Inspector窗口被看到）</p><h2 id="4.1-%E5%A6%82%E4%BD%95%E5%9C%A8inspector%E7%AA%97%E5%8F%A3%E7%BC%96%E8%BE%91%E5%AD%97%E5%85%B8%E6%88%90%E5%91%98" tabindex="-1">4.1 如何在Inspector窗口编辑字典成员</h2><p>Unity默认是不支持Dictionary在Inspector窗口被显示的<br>我们只有<strong>利用两个List（或数组）成员来间接设置Dictionary</strong></p><h2 id="4.2-iserializationcallbackreceiver%E6%8E%A5%E5%8F%A3" tabindex="-1">4.2 ISerializationCallbackReceiver接口</h2><p><strong>该接口是Unity提供的用于序列化和反序列化时执行自定义逻辑的接口</strong><br>实现该接口的类能够在对象被序列化到磁盘或从磁盘反序列化时执行一些额外代码</p><ol><li><p><strong>接口中函数：</strong></p><ul><li>OnBeforeSerialize: 在对象被序列化之前调用</li><li>OnAfterDeserialize: 在对象从磁盘反序列化后调用</li></ul><p>由于我们需要用两个List存储Dictionary的具体值<br>相当于字典中的真正内容是存储在两个List中的<br><strong>所以我们需要在</strong><br><strong>OnBeforeSerialize序列化之前：将Dictionary里的数据存入List中进行序列化</strong><br><strong>OnAfterDeserialize反序列化之后：将List中反序列化出来的数据存储到Dictionary中</strong></p></li></ol><h2 id="4.3-%E5%88%A9%E7%94%A8%E4%B8%A4%E4%B8%AAlist%E5%9C%A8inspector%E7%AA%97%E5%8F%A3%E4%B8%AD%E8%87%AA%E5%AE%9A%E4%B9%89dictionary%E6%98%BE%E7%A4%BA" tabindex="-1">4.3 利用两个List在Inspector窗口中自定义Dictionary显示</h2><p>由于我们在Inspector窗口中显示的信息的数据来源是List<br>因此我们只需要利用List在Inspector窗口中自定义显示即可</p><h2 id="4.4-%E6%80%BB%E7%BB%93" tabindex="-1">4.4 总结</h2><p>由于Unity中不支持在Inspector窗口直接使用Dictionary<br>因此我们可以利用两个List（或数组）来间接的表达Dictionary成员</p><h2 id="4.5-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B" tabindex="-1">4.5 代码示例</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lesson22.cs</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson22</span> : <span class="title">MonoBehaviour</span>, <span class="title">ISerializationCallbackReceiver</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> Dictionary&lt;<span class="built_in">int</span>, <span class="built_in">string</span>&gt; myDic = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">int</span>, <span class="built_in">string</span>&gt;() &#123; &#123; <span class="number">1</span>, <span class="string">&quot;123&quot;</span> &#125;, &#123; <span class="number">2</span>, <span class="string">&quot;234&quot;</span> &#125; &#125;;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    <span class="keyword">private</span> List&lt;<span class="built_in">int</span>&gt; keys = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;();</span><br><span class="line">    [<span class="meta">SerializeField</span>]</span><br><span class="line">    <span class="keyword">private</span> List&lt;<span class="built_in">string</span>&gt; values = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//反序列化之后自动调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnAfterDeserialize</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        myDic.Clear();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; keys.Count; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!myDic.ContainsKey(keys[i]))</span><br><span class="line">                myDic.Add(keys[i], values[i]);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                Debug.LogWarning(<span class="string">&quot;字典Dictionary容器中不允许有相同的键&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//序列化之前自动调用</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnBeforeSerialize</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        keys.Clear();</span><br><span class="line">        values.Clear();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> myDic)</span><br><span class="line">        &#123;</span><br><span class="line">            keys.Add(item.Key);</span><br><span class="line">            values.Add(item.Value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> myDic)</span><br><span class="line">        &#123;</span><br><span class="line">            print(<span class="string">$&quot;Dic:<span class="subst">&#123;item.Key&#125;</span> - <span class="subst">&#123;item.Value&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// lesson2Editor.cs</span></span><br><span class="line">    <span class="keyword">private</span> SerializedProperty keys;</span><br><span class="line">    <span class="keyword">private</span> SerializedProperty values;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> dicCount;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">        dicCount = keys.arraySize;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnInspectorGUI</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        serializedObject.Update(); <span class="comment">//需要用Update()和ApplyModifiedProperties()进行包裹</span></span><br><span class="line">         dicCount = EditorGUILayout.IntField(<span class="string">&quot;字典容量&quot;</span>, dicCount);</span><br><span class="line">        <span class="comment">//容量变少时 把多的删了</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = keys.arraySize - <span class="number">1</span>; i &gt;= dicCount; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            keys.DeleteArrayElementAtIndex(i);</span><br><span class="line">            values.DeleteArrayElementAtIndex(i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; dicCount; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//如果容量不够 扩容</span></span><br><span class="line">            <span class="keyword">if</span> (keys.arraySize &lt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                keys.InsertArrayElementAtIndex(i);</span><br><span class="line">                values.InsertArrayElementAtIndex(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//去真正的自定义键值对的修改</span></span><br><span class="line">            SerializedProperty indexKey = keys.GetArrayElementAtIndex(i);</span><br><span class="line">            SerializedProperty indexValue = values.GetArrayElementAtIndex(i);</span><br><span class="line">            EditorGUILayout.BeginHorizontal();</span><br><span class="line">            indexKey.intValue = EditorGUILayout.IntField(<span class="string">&quot;字典的键&quot;</span>, indexKey.intValue);</span><br><span class="line">            indexValue.stringValue = EditorGUILayout.TextField(<span class="string">&quot;字典的值&quot;</span>, indexValue.stringValue);</span><br><span class="line">            EditorGUILayout.EndHorizontal();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        serializedObject.ApplyModifiedProperties();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="4.6-%E6%95%88%E6%9E%9C" tabindex="-1">4.6 效果</h2><p><img src="/2025/04/27/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%83-Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/L25Inspector%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95-%E5%AD%97%E5%85%B8%E5%B1%9E%E6%80%A7%20%E8%87%AA%E5%AE%9A%E4%B9%89%E6%98%BE%E7%A4%BA.png" alt></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;Inspector窗口拓展相关内容&lt;/p&gt;</summary>
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity编辑器拓展" scheme="http://example.com/tags/Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95/"/>
    
  </entry>
  
  <entry>
    <title>Unity编辑器拓展（六）-Event公共类</title>
    <link href="http://example.com/2025/04/26/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AD-Event%E5%85%AC%E5%85%B1%E7%B1%BB/"/>
    <id>http://example.com/2025/04/26/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%85%AD-Event%E5%85%AC%E5%85%B1%E7%B1%BB/</id>
    <published>2025-04-26T15:03:00.000Z</published>
    <updated>2025-04-27T14:19:52.563Z</updated>
    
    <content type="html"><![CDATA[<p>Event公共类相关内容</p><span id="more"></span><h1 id="%E4%B8%80%E3%80%81event%E5%85%AC%E5%85%B1%E7%B1%BB%E6%98%AF%E7%94%A8%E6%9D%A5%E5%81%9A%E4%BB%80%E4%B9%88%E7%9A%84%EF%BC%9F" tabindex="-1">一、Event公共类是用来做什么的？</h1><ul><li>它提供了许多属性和方法，允许你检查和处理用户输入</li><li>主要用于在Unity编辑器拓展开发中</li><li>因为<strong>Input相关内容需要在运行时才能监听输入</strong></li><li>而<strong>Event专门提供给编辑模式下使用，可以帮助我们检测鼠标键盘输入等事件相关操作</strong></li><li>在 <strong>OnGUI 和 OnSceneView 中都能使用</strong></li></ul><h1 id="%E4%BA%8C%E3%80%81-%E9%87%8D%E8%A6%81api" tabindex="-1">二、 重要API</h1><ol><li>获取当前输入事件</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current</span><br></pre></td></tr></table></figure><ol start="2"><li>alt键是否按下</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.alt</span><br></pre></td></tr></table></figure><ol start="3"><li>shift键是否按下</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.shift</span><br></pre></td></tr></table></figure><ol start="4"><li>ctrl键是否按下</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.control</span><br></pre></td></tr></table></figure><ol start="5"><li>是否是鼠标事件</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.isMouse</span><br></pre></td></tr></table></figure><ol start="6"><li>判断鼠标左中右键</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Evnet.current.button (<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span> 分别代表 左,右,中 如果大于<span class="number">2</span>可能是其他鼠标按键)</span><br></pre></td></tr></table></figure><ol start="7"><li>鼠标位置</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.curretn.mousePosition</span><br></pre></td></tr></table></figure><ol start="8"><li>判断是否是键盘输入</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.isKey</span><br></pre></td></tr></table></figure><ol start="9"><li>获取键盘输入的字符</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.character</span><br></pre></td></tr></table></figure><ol start="10"><li>获取键盘输入对应的KeyCode</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.keyCode</span><br></pre></td></tr></table></figure><ol start="11"><li>判断输入类型</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Event.current.type</span><br><span class="line">EventType枚举和它比较即可</span><br><span class="line">EventType中有常用的 鼠标按下抬起拖拽，键盘按下抬起等等类型</span><br></pre></td></tr></table></figure><ol start="12"><li>是否锁定大写 对应键盘上caps键是否开启</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.capsLock</span><br></pre></td></tr></table></figure><ol start="13"><li>Windows键或Command键是否按下</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.command</span><br></pre></td></tr></table></figure><ol start="14"><li>键盘事件 字符串</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.commandName</span><br></pre></td></tr></table></figure><ul><li>可以用来判断是否触发了对应的键盘事件</li><li>返回值：<ul><li>Copy:拷贝</li><li>Paste:粘贴</li><li>Cut:剪切</li></ul></li></ul><ol start="15"><li>鼠标间隔移动距离</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.delta</span><br></pre></td></tr></table></figure><ol start="16"><li>是否是功能键输入</li></ol><ul><li>功能键指小键盘中的 方向键, page up, page down, backspace等等</li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.functionKey</span><br></pre></td></tr></table></figure><ol start="17"><li>小键盘是否开启</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.numeric</span><br></pre></td></tr></table></figure><ol start="18"><li>避免组合键冲突</li></ol><ul><li>在处理完对应输入事件后，调用该方法，可以阻止事件继续派发，放置和Unity其他编辑器事件逻辑冲突</li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Event.current.Use()</span><br></pre></td></tr></table></figure><h1 id="%E4%B8%89%E3%80%81-api%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B" tabindex="-1">三、 API使用示例</h1><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.获取当前事件</span></span><br><span class="line"><span class="comment">//  Event.current</span></span><br><span class="line">Event eve = Event.current;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.alt键是否按下</span></span><br><span class="line"><span class="comment">//  Event.current.alt</span></span><br><span class="line"><span class="keyword">if</span> (eve.alt)</span><br><span class="line">    Debug.Log(<span class="string">&quot;alt键按下了&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.shift键是否按下</span></span><br><span class="line"><span class="comment">//  Event.current.shift</span></span><br><span class="line"><span class="keyword">if</span> (eve.shift)</span><br><span class="line">    Debug.Log(<span class="string">&quot;shift键按下了&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.ctrl键是否按下</span></span><br><span class="line"><span class="comment">//  Event.current.control</span></span><br><span class="line"><span class="keyword">if</span> (eve.control)</span><br><span class="line">    Debug.Log(<span class="string">&quot;control键按下了&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.是否是鼠标事件</span></span><br><span class="line"><span class="comment">//  Event.current.isMouse</span></span><br><span class="line"><span class="keyword">if</span> (eve.isMouse)</span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;鼠标相关事件&quot;</span>);</span><br><span class="line">    <span class="comment">//6.判断鼠标左中右键</span></span><br><span class="line">    <span class="comment">//  Event.current.button (0,1,2 分别代表 左,右,中 如果大于2可能是其他鼠标按键)</span></span><br><span class="line">    Debug.Log(eve.button);</span><br><span class="line">    <span class="comment">//7.鼠标位置</span></span><br><span class="line">    <span class="comment">//  Event.current.mousePosition</span></span><br><span class="line">    Debug.Log(<span class="string">&quot;鼠标位置&quot;</span> + eve.mousePosition);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//8.判断是否是键盘输入</span></span><br><span class="line"><span class="comment">//  Event.current.isKey</span></span><br><span class="line"><span class="keyword">if</span>(eve.isKey)</span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;键盘相关事件&quot;</span>);</span><br><span class="line">    <span class="comment">//9.获取键盘输入的字符</span></span><br><span class="line">    <span class="comment">//  Event.current.character</span></span><br><span class="line">    Debug.Log(eve.character);</span><br><span class="line">    <span class="comment">//10.获取键盘输入对应的KeyCode</span></span><br><span class="line">    <span class="comment">//  Event.current.keyCode</span></span><br><span class="line">    <span class="comment">//Debug.Log(eve.keyCode);</span></span><br><span class="line">    <span class="keyword">switch</span> (eve.keyCode)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> KeyCode.Space:</span><br><span class="line">            Debug.Log(<span class="string">&quot;空格键输入&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//11.判断输入类型</span></span><br><span class="line"><span class="comment">//  Event.current.type</span></span><br><span class="line"><span class="comment">//  EventType枚举和它比较即可</span></span><br><span class="line"><span class="comment">//  EventType中有常用的 鼠标按下抬起拖拽，键盘按下抬起等等类型</span></span><br><span class="line"><span class="comment">//  一般会配合它 来判断 比如 键盘 鼠标的抬起按下相关的操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//12.是否锁定大写 对应键盘上caps键是否开启</span></span><br><span class="line"><span class="comment">//  Event.current.capsLock</span></span><br><span class="line"><span class="keyword">if</span> (eve.capsLock)</span><br><span class="line">    Debug.Log(<span class="string">&quot;大小写锁定开启&quot;</span>);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    Debug.Log(<span class="string">&quot;大小写锁定关闭&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//13.Windows键或Command键是否按下</span></span><br><span class="line"><span class="comment">//  Event.current.command</span></span><br><span class="line"><span class="keyword">if</span> (eve.command)</span><br><span class="line">    Debug.Log(<span class="string">&quot;PC win键按下 或 Mac Command键按下&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//14.键盘事件 字符串</span></span><br><span class="line"><span class="comment">//  Event.current.commandName</span></span><br><span class="line"><span class="comment">//  可以用来判断是否触发了对应的键盘事件</span></span><br><span class="line"><span class="comment">//  返回值：</span></span><br><span class="line"><span class="comment">//  Copy:拷贝</span></span><br><span class="line"><span class="comment">//  Paste:粘贴</span></span><br><span class="line"><span class="comment">//  Cut:剪切</span></span><br><span class="line"><span class="keyword">if</span>(eve.commandName == <span class="string">&quot;Copy&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;按下了ctrl + c&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (eve.commandName == <span class="string">&quot;Paste&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;按下了ctrl + v&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (eve.commandName == <span class="string">&quot;Cut&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;按下了ctrl + x&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//15.鼠标间隔移动距离</span></span><br><span class="line"><span class="comment">//  Event.current.delta</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Debug.Log(eve.delta);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//16.是否是功能键输入</span></span><br><span class="line"><span class="comment">//  Event.current.functionKey</span></span><br><span class="line"><span class="comment">//  功能键指小键盘中的 方向键, page up, page down, backspace等等</span></span><br><span class="line"><span class="keyword">if</span> (eve.functionKey)</span><br><span class="line">    Debug.Log(<span class="string">&quot;有功能按键输入&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//17.小键盘是否开启</span></span><br><span class="line"><span class="comment">//  Event.current.numeric</span></span><br><span class="line"><span class="keyword">if</span>(eve.numeric)</span><br><span class="line">    Debug.Log(<span class="string">&quot;小键盘是否开启&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//18.避免组合键冲突</span></span><br><span class="line"><span class="comment">//  Event.current.Use()</span></span><br><span class="line"><span class="comment">//  在处理完对应输入事件后，调用该方法，可以阻止事件继续派发，防止和Unity其他编辑器事件逻辑冲突</span></span><br><span class="line">eve.Use();</span><br></pre></td></tr></table></figure><h1 id="%E4%BA%94%E3%80%81-%E6%9B%B4%E5%A4%9A%E5%86%85%E5%AE%B9" tabindex="-1">五、 更多内容</h1><p><a href="https://docs.unity3d.com/ScriptReference/Event.html">https://docs.unity3d.com/ScriptReference/Event.html</a></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;Event公共类相关内容&lt;/p&gt;</summary>
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity编辑器拓展" scheme="http://example.com/tags/Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95/"/>
    
  </entry>
  
  <entry>
    <title>Unity编辑器拓展（五）-Selection公共类</title>
    <link href="http://example.com/2025/04/23/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%BA%94-Selection%E5%85%AC%E5%85%B1%E7%B1%BB/"/>
    <id>http://example.com/2025/04/23/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%BA%94-Selection%E5%85%AC%E5%85%B1%E7%B1%BB/</id>
    <published>2025-04-23T15:32:26.000Z</published>
    <updated>2025-04-26T15:17:17.666Z</updated>
    
    <content type="html"><![CDATA[<p>Selection公共类</p><span id="more"></span><ul><li><a href="#%E4%B8%80selection%E5%85%AC%E5%85%B1%E7%B1%BB%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88">一、Selection公共类的作用是什么</a><ul><li><a href="#11-selection%E5%85%AC%E5%85%B1%E7%B1%BB%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88">1.1 Selection公共类的作用是什么</a></li></ul></li><li><a href="#%E4%BA%8Cselection%E4%B8%AD%E5%B8%B8%E7%94%A8%E9%9D%99%E6%80%81%E6%88%90%E5%91%98">二、Selection中常用静态成员</a><ul><li><a href="#21-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84object">2.1 获取当前选择的Object</a></li><li><a href="#22-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84gameobject">2.2 获取当前选择的GameObject</a></li><li><a href="#23-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84transform">2.3 获取当前选择的Transform</a></li><li><a href="#24-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84%E6%89%80%E6%9C%89object">2.4 获取当前选择的所有Object</a></li><li><a href="#25-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84%E6%89%80%E6%9C%89gameobject">2.5 获取当前选择的所有GameObject</a></li><li><a href="#26-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84%E6%89%80%E6%9C%89transform">2.6 获取当前选择的所有Transform</a></li><li><a href="#27-%E5%89%8D%E9%9D%A26%E4%B8%AD%E6%83%85%E5%86%B5%E4%BD%BF%E7%94%A8">2.7 前面6中情况使用</a></li></ul></li><li><a href="#%E4%B8%89selection%E5%B8%B8%E7%94%A8%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95">三、Selection常用静态方法</a><ul><li><a href="#31-%E5%88%A4%E6%96%AD%E6%9F%90%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E8%A2%AB%E9%80%89%E4%B8%AD">3.1 判断某个对象是否被选中</a></li><li><a href="#32-%E7%AD%9B%E9%80%89%E5%AF%B9%E8%B1%A1">3.2 筛选对象</a></li><li><a href="#33-%E5%BD%93%E9%80%89%E4%B8%AD%E5%8F%98%E5%8C%96%E6%97%B6%E4%BC%9A%E8%B0%83%E7%94%A8%E7%9A%84%E5%A7%94%E6%89%98">3.3 当选中变化时会调用的委托</a></li><li><a href="#34-%E6%95%88%E6%9E%9C">3.4 效果</a></li></ul></li><li><a href="#%E5%9B%9B%E6%80%BB%E7%BB%93">四、总结</a></li></ul><h1 id="%E4%B8%80%E3%80%81selection%E5%85%AC%E5%85%B1%E7%B1%BB%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88" tabindex="-1">一、Selection公共类的作用是什么</h1><h2 id="1.1-selection%E5%85%AC%E5%85%B1%E7%B1%BB%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88" tabindex="-1">1.1 Selection公共类的作用是什么</h2><ul><li>主要用来获取当前在Unity编辑器中选择的对象</li><li>只能用于编辑器开发中</li></ul><h1 id="%E4%BA%8C%E3%80%81selection%E4%B8%AD%E5%B8%B8%E7%94%A8%E9%9D%99%E6%80%81%E6%88%90%E5%91%98" tabindex="-1">二、Selection中常用静态成员</h1><h2 id="2.1-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84object" tabindex="-1">2.1 获取当前选择的Object</h2><ol><li>作用：</li></ol><ul><li>获取当前在面板上选择的游戏物体Object，未选择则返回Null</li><li>选择多个则返回最后一个选择的游戏物体</li></ul><ol start="2"><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Selection.activeObject</span><br></pre></td></tr></table></figure><h2 id="2.2-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84gameobject" tabindex="-1">2.2 获取当前选择的GameObject</h2><ol><li>作用：</li></ol><ul><li>获取当前在面板上选择的游戏物体GameObject，未选择则返回Null</li><li>选择多个则返回最后一个选择的游戏物体</li></ul><ol start="2"><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Selection.activeGameObject</span><br></pre></td></tr></table></figure><h2 id="2.3-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84transform" tabindex="-1">2.3 获取当前选择的Transform</h2><ol><li>作用</li></ol><ul><li>获取当前在面板上选择的游戏物体的Transform，未选择则返回Null</li><li>选择多个则返回最后一个选择的游戏物体</li><li><strong>只能获取到场景中（Hierarchy）的对象的Transform</strong></li></ul><ol start="2"><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Selection.activeTransform</span><br></pre></td></tr></table></figure><h2 id="2.4-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84%E6%89%80%E6%9C%89object" tabindex="-1">2.4 获取当前选择的所有Object</h2><ol><li>作用：</li></ol><ul><li>获取当前在面板上选择的物体<strong>数组</strong>，未选择则返回Null</li></ul><ol start="2"><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Selection.objects </span><br></pre></td></tr></table></figure><h2 id="2.5-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84%E6%89%80%E6%9C%89gameobject" tabindex="-1">2.5 获取当前选择的所有GameObject</h2><ol><li>作用：</li></ol><ul><li>获取当前在面板上选择的<strong>游戏物体或Project中预设体 GameObject数组</strong></li><li>未选择则返回Null</li></ul><ol start="2"><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Selection.gameObjects</span><br><span class="line"><span class="comment">//可以遍历获取所有信息</span></span><br></pre></td></tr></table></figure><h2 id="2.6-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%80%89%E6%8B%A9%E7%9A%84%E6%89%80%E6%9C%89transform" tabindex="-1">2.6 获取当前选择的所有Transform</h2><ol><li>作用</li></ol><ul><li>获取当前在面板上选择的游戏物体Transform数组，未选择则返回Null</li></ul><ol start="2"><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Selection.transforms</span><br><span class="line"><span class="comment">//可以遍历获取所有信息</span></span><br></pre></td></tr></table></figure><h2 id="2.7-%E5%89%8D%E9%9D%A26%E4%B8%AD%E6%83%85%E5%86%B5%E4%BD%BF%E7%94%A8" tabindex="-1">2.7 前面6中情况使用</h2><ol><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> StringBuilder str = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;没有选择&quot;</span>);</span><br><span class="line"><span class="keyword">private</span> StringBuilder str2 = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;没有选择&quot;</span>);</span><br><span class="line"><span class="keyword">private</span> StringBuilder str3 = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;没有选择&quot;</span>);</span><br><span class="line"><span class="keyword">private</span> StringBuilder str4 = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;没有选择&quot;</span>);</span><br><span class="line"><span class="comment">//1.当前选择的Object</span></span><br><span class="line"><span class="keyword">if</span>(GUILayout.Button(<span class="string">&quot;获取当前选择的Object的名字&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(Selection.activeObject != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        str.Clear();</span><br><span class="line">        str.Append(Selection.activeObject.name);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Selection.activeObject <span class="keyword">is</span> GameObject)</span><br><span class="line">            Debug.Log(<span class="string">&quot;它是游戏对象&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Selection.activeObject <span class="keyword">is</span> Texture)</span><br><span class="line">            Debug.Log(<span class="string">&quot;它是一张纹理&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (Selection.activeObject <span class="keyword">is</span> TextAsset)</span><br><span class="line">            Debug.Log(<span class="string">&quot;它是一个文本&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            Debug.Log(<span class="string">&quot;它是其他类型的资源&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        str.Clear();</span><br><span class="line">        str.Append(<span class="string">&quot;没有选择&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;当前选择的对象&quot;</span>, str.ToString());</span><br><span class="line"><span class="comment">//2.当前选择的GameObject</span></span><br><span class="line"><span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;获取当前选择的GameObject的名字&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (Selection.activeGameObject != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        str2.Clear();</span><br><span class="line">        str2.Append(Selection.activeGameObject.name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        str2.Clear();</span><br><span class="line">        str2.Append(<span class="string">&quot;没有选择&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;当前选择GameObject对象&quot;</span>, str2.ToString());</span><br><span class="line"><span class="comment">//3.当前选择的Transform</span></span><br><span class="line"><span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;获取当前选择的Transform的名字&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (Selection.activeTransform != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        str3.Clear();</span><br><span class="line">        str3.Append(Selection.activeTransform.name);</span><br><span class="line">        Selection.activeTransform.position = <span class="keyword">new</span> Vector3(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>); <span class="comment">//改变对象的位置</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        str3.Clear();</span><br><span class="line">        str3.Append(<span class="string">&quot;没有选择&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;当前选择Transform对象&quot;</span>, str3.ToString());</span><br><span class="line"><span class="comment">//4.当前选择的所有Object</span></span><br><span class="line"><span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;获取当前选择的所有Object的名字&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (Selection.count != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        str4.Clear();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; Selection.objects.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            str4.Append(Selection.objects[i].name + <span class="string">&quot;||&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        str4.Clear();</span><br><span class="line">        str4.Append(<span class="string">&quot;没有选择&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;当前选择的所有Object对象&quot;</span>, str4.ToString());</span><br><span class="line"><span class="comment">//5.当前选择的所有GameObject</span></span><br><span class="line"><span class="comment">//Selection.gameObjects</span></span><br><span class="line"><span class="comment">//6.当前选择的所有Transform</span></span><br><span class="line"><span class="comment">//Selection.transforms</span></span><br></pre></td></tr></table></figure><ol start="2"><li>效果</li></ol><ul><li>选择代码对象<br><img src="/2025/04/23/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%BA%94-Selection%E5%85%AC%E5%85%B1%E7%B1%BB/L19Selection%E4%B8%AD%E5%B8%B8%E7%94%A8%E9%9D%99%E6%80%81%E6%88%90%E5%91%98(%E9%80%89%E6%8B%A9%E4%BB%A3%E7%A0%81%E5%AF%B9%E8%B1%A1).png" alt></li><li>多选场景对象<br><img src="/2025/04/23/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%BA%94-Selection%E5%85%AC%E5%85%B1%E7%B1%BB/L19Selection%E4%B8%AD%E5%B8%B8%E7%94%A8%E9%9D%99%E6%80%81%E6%88%90%E5%91%98(%E5%A4%9A%E9%80%89%E5%9C%BA%E6%99%AF%E5%AF%B9%E8%B1%A1).png" alt></li></ul><h1 id="%E4%B8%89%E3%80%81selection%E5%B8%B8%E7%94%A8%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95" tabindex="-1">三、Selection常用静态方法</h1><h2 id="3.1-%E5%88%A4%E6%96%AD%E6%9F%90%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E8%A2%AB%E9%80%89%E4%B8%AD" tabindex="-1">3.1 判断某个对象是否被选中</h2><ol><li>方法<br>选择多个对象时，只要在里面也能判断为被选中</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Contains <span class="comment">//判断某个对象是否被选中(选择多个对象时，只要在里面也能判断为被选中)</span></span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> Object obj;</span><br><span class="line">    <span class="comment">//判断某个对象是否被选中</span></span><br><span class="line">    obj = EditorGUILayout.ObjectField(<span class="string">&quot;用于判断是否被选中的对象&quot;</span>, obj, <span class="keyword">typeof</span>(GameObject), <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;判断对象是否被选中&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Selection.Contains(obj))</span><br><span class="line">            Debug.Log(<span class="string">&quot;对象有被选中&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            Debug.Log(<span class="string">&quot;对象没有被选中&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">```   </span><br><span class="line"></span><br><span class="line"><span class="meta">## 3.2 筛选对象</span></span><br><span class="line"><span class="number">1.</span> 作用：从当前选择对象中，筛选出想要的内容</span><br><span class="line"><span class="number">2.</span> 方法</span><br><span class="line">```cs</span><br><span class="line">    Selection.GetFiltered(类型, 筛选模式)</span><br><span class="line">    Selection.GetFiltered&lt;类型&gt;(筛选模式)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  筛选模式：SelectionMode</span></span><br><span class="line">    <span class="comment">//  Unfiltered: 不过滤</span></span><br><span class="line">    <span class="comment">//  TopLevel: 只获取最上层对象，子对象不获取</span></span><br><span class="line">    <span class="comment">//  Deep: 父对象、子对象都获取</span></span><br><span class="line">    <span class="comment">//  ExcludePrefab: 排除预设体</span></span><br><span class="line">    <span class="comment">//  Editable: 只选择可编辑的对象</span></span><br><span class="line">    <span class="comment">//  OnlyUserModifiable: 仅用户可修改的内容</span></span><br><span class="line">    <span class="comment">//  Assets: 只返回资源文件夹下的内容</span></span><br><span class="line">    <span class="comment">//  DeepAssets: 如果存在子文件夹，其中的内容也获取</span></span><br><span class="line">    <span class="comment">//  如果要混用 位或 | 即可</span></span><br></pre></td></tr></table></figure><ol start="3"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//筛选对象</span></span><br><span class="line"><span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;筛选所有对象&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    Object[] objs = Selection.GetFiltered(<span class="keyword">typeof</span>(Object), SelectionMode.Assets | SelectionMode.DeepAssets);</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; objs.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(objs[i].name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3.3-%E5%BD%93%E9%80%89%E4%B8%AD%E5%8F%98%E5%8C%96%E6%97%B6%E4%BC%9A%E8%B0%83%E7%94%A8%E7%9A%84%E5%A7%94%E6%89%98" tabindex="-1">3.3 当选中变化时会调用的委托</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Selection.selectionChanged += 函数;<span class="comment">//选择的物体变化时调用</span></span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Selection.selectionChanged += SelectionChanged;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnDestroy</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Selection.selectionChanged -= SelectionChanged;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">SelectionChanged</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;选择的对象变化了&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3.4-%E6%95%88%E6%9E%9C" tabindex="-1">3.4 效果</h2><ul><li>判断某个对象是否被选中及当选中变化时会调用的委托<br><img src="/2025/04/23/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%BA%94-Selection%E5%85%AC%E5%85%B1%E7%B1%BB/L20Selection%E5%B8%B8%E7%94%A8%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95.png" alt></li><li>筛选对象（筛选了Editor下的内容及其子文件夹内容）<br><img src="/2025/04/23/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%BA%94-Selection%E5%85%AC%E5%85%B1%E7%B1%BB/L20Selection%E5%B8%B8%E7%94%A8%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95-%E7%AD%9B%E9%80%89%E5%AF%B9%E8%B1%A1.png" alt></li></ul><h1 id="%E5%9B%9B%E3%80%81%E6%80%BB%E7%BB%93" tabindex="-1">四、总结</h1><ul><li>Selection公共类主要是帮助我们获取到选择的对象的</li><li>我们可以利用它对选中对象进行一些处理</li></ul><p>Selection公共类 更多API：<a href="https://docs.unity.cn/cn/2022.1/ScriptReference/Selection.html">https://docs.unity.cn/cn/2022.1/ScriptReference/Selection.html</a></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;Selection公共类&lt;/p&gt;</summary>
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity编辑器拓展" scheme="http://example.com/tags/Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95/"/>
    
  </entry>
  
  <entry>
    <title>Unity编辑器拓展（四）-EditorGUIUtility公共类</title>
    <link href="http://example.com/2025/04/15/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%9B%9B-EditorGUIUtility%E5%85%AC%E5%85%B1%E7%B1%BB/"/>
    <id>http://example.com/2025/04/15/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%9B%9B-EditorGUIUtility%E5%85%AC%E5%85%B1%E7%B1%BB/</id>
    <published>2025-04-15T14:44:03.000Z</published>
    <updated>2025-04-26T15:04:11.529Z</updated>
    
    <content type="html"><![CDATA[<p>EditorGUIUtility公共类相关内容</p><span id="more"></span><ul><li><a href="#%E4%B8%80editorguiutility%E5%85%AC%E5%85%B1%E7%B1%BB%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88">一、EditorGUIUtility公共类的作用是什么</a></li><li><a href="#%E4%BA%8C%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD">二、资源加载</a><ul><li><a href="#21-editor-default-resources%E6%96%87%E4%BB%B6%E5%A4%B9">2.1 Editor Default Resources文件夹</a></li><li><a href="#22-%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90%E5%A6%82%E6%9E%9C%E8%B5%84%E6%BA%90%E4%B8%8D%E5%AD%98%E5%9C%A8%E8%BF%94%E5%9B%9Enull">2.2 加载资源（如果资源不存在返回null）</a></li><li><a href="#23-%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90%E5%A6%82%E6%9E%9C%E8%B5%84%E6%BA%90%E4%B8%8D%E5%AD%98%E5%9C%A8%E4%BC%9A%E7%9B%B4%E6%8E%A5%E6%8A%A5%E9%94%99">2.3 加载资源（如果资源不存在会直接报错）</a></li><li><a href="#23-%E6%95%88%E6%9E%9C">2.3 效果</a></li></ul></li><li><a href="#%E4%B8%89%E6%90%9C%E7%B4%A2%E6%A1%86%E6%9F%A5%E8%AF%A2%E5%AF%B9%E8%B1%A1%E9%80%89%E4%B8%AD%E6%8F%90%E7%A4%BA">三、搜索框查询、对象选中提示</a><ul><li><a href="#31-%E6%90%9C%E7%B4%A2%E6%A1%86%E6%9F%A5%E8%AF%A2">3.1 搜索框查询</a></li><li><a href="#32-%E5%AF%B9%E8%B1%A1%E9%80%89%E4%B8%AD%E6%8F%90%E7%A4%BA">3.2 对象选中提示</a></li><li><a href="#33-%E6%95%88%E6%9E%9C">3.3 效果</a></li></ul></li><li><a href="#%E5%9B%9B%E7%AA%97%E5%8F%A3%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2">四、窗口事件传递、坐标转换</a><ul><li><a href="#41-region-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%80-%E7%AA%97%E5%8F%A3%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92">4.1 region 知识点一 窗口事件传递</a></li><li><a href="#42-%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2">4.2 坐标转换</a></li><li><a href="#43-%E6%95%88%E6%9E%9C">4.3 效果</a></li></ul></li><li><a href="#%E4%BA%94%E6%8C%87%E5%AE%9A%E5%8C%BA%E5%9F%9F%E4%BD%BF%E7%94%A8%E5%AF%B9%E5%BA%94%E9%BC%A0%E6%A0%87%E6%8C%87%E9%92%88">五、指定区域使用对应鼠标指针</a><ul><li><a href="#51-%E6%96%B9%E6%B3%95">5.1 方法</a></li><li><a href="#52-%E7%A4%BA%E4%BE%8B">5.2 示例</a></li><li><a href="#53-%E6%95%88%E6%9E%9C">5.3 效果</a></li></ul></li><li><a href="#%E5%85%AD%E7%BB%98%E5%88%B6%E8%89%B2%E6%9D%BF%E7%BB%98%E5%88%B6%E6%9B%B2%E7%BA%BF">六、绘制色板、绘制曲线</a><ul><li><a href="#61-%E7%BB%98%E5%88%B6%E8%89%B2%E6%9D%BF">6.1 绘制色板</a></li><li><a href="#62-%E7%BB%98%E5%88%B6%E6%9B%B2%E7%BA%BF">6.2 绘制曲线</a></li><li><a href="#63-%E6%95%88%E6%9E%9C">6.3 效果</a></li></ul></li><li><a href="#%E4%B8%83%E6%9B%B4%E5%A4%9Aapi">七、更多API</a></li></ul><h1 id="%E4%B8%80%E3%80%81editorguiutility%E5%85%AC%E5%85%B1%E7%B1%BB%E7%9A%84%E4%BD%9C%E7%94%A8%E6%98%AF%E4%BB%80%E4%B9%88" tabindex="-1">一、EditorGUIUtility公共类的作用是什么</h1><ul><li>Utility是实用的意思，EditorGUIUtility 是 EditorGUI 中的一个实用工具类</li><li>提供了一些 EditorGUI 相关的其他辅助API</li><li>本文只学习其中的相对常用的内容<br>官方文档：<a href="https://docs.unity3d.com/ScriptReference/EditorGUIUtility.html">https://docs.unity3d.com/ScriptReference/EditorGUIUtility.html</a></li></ul><h1 id="%E4%BA%8C%E3%80%81%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD" tabindex="-1">二、资源加载</h1><h2 id="2.1-editor-default-resources%E6%96%87%E4%BB%B6%E5%A4%B9" tabindex="-1">2.1 Editor Default Resources文件夹</h2><ul><li><strong>Editor Default Resources</strong> 也是Unity当中的一个特殊文件夹，<strong>它的主要作用是放置提供给 EditorGUIUtility 加载的资源</strong></li><li>想要使用EditorGUIUtility公共类来加载资源</li><li><strong>我们需要将资源放置在 Editor Default Resources 文件夹中</strong></li></ul><h2 id="2.2-%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90%EF%BC%88%E5%A6%82%E6%9E%9C%E8%B5%84%E6%BA%90%E4%B8%8D%E5%AD%98%E5%9C%A8%E8%BF%94%E5%9B%9Enull%EF%BC%89" tabindex="-1">2.2 加载资源（如果资源不存在返回null）</h2><ol><li>方法<br><strong>注意事项：</strong></li></ol><ul><li>只能加载Assets/Editor Default Resources/文件夹下的资源</li><li>加载资源时，<strong>需要填写资源后缀名</strong></li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对应API：</span></span><br><span class="line">EditorGUIUtility.Load</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载资源（如果资源不存在返回null)</span></span><br><span class="line"><span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;加载编辑器图片资源&quot;</span>))</span><br><span class="line">    img = EditorGUIUtility.Load(<span class="string">&quot;EditorTeach.png&quot;</span>) <span class="keyword">as</span> Texture;</span><br><span class="line"><span class="keyword">if</span> (img != <span class="literal">null</span>)</span><br><span class="line">    GUI.DrawTexture(<span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">50</span>, <span class="number">160</span>, <span class="number">90</span>), img); <span class="comment">//显示图片</span></span><br></pre></td></tr></table></figure><h2 id="2.3-%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90%EF%BC%88%E5%A6%82%E6%9E%9C%E8%B5%84%E6%BA%90%E4%B8%8D%E5%AD%98%E5%9C%A8%E4%BC%9A%E7%9B%B4%E6%8E%A5%E6%8A%A5%E9%94%99%EF%BC%89" tabindex="-1">2.3 加载资源（如果资源不存在会直接报错）</h2><ol><li>方法</li></ol><p><strong>注意事项：</strong></p><ul><li>只能加载Assets/Editor Default Resources/文件夹下的资源</li><li>加载资源时，需要填写资源后缀名</li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对应API：</span></span><br><span class="line">EditorGUIUtility.LoadRequired</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载资源（如果资源不存在会直接报错）</span></span><br><span class="line"><span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;加载编辑器图片资源&quot;</span>))</span><br><span class="line">    img2 = EditorGUIUtility.LoadRequired(<span class="string">&quot;EditorTeach.png&quot;</span>) <span class="keyword">as</span> Texture;</span><br><span class="line"><span class="keyword">if</span> (img2 != <span class="literal">null</span>)</span><br><span class="line">    GUI.DrawTexture(<span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">150</span>, <span class="number">160</span>, <span class="number">90</span>), img2); <span class="comment">//显示图片</span></span><br></pre></td></tr></table></figure><h2 id="2.3-%E6%95%88%E6%9E%9C" tabindex="-1">2.3 效果</h2><p><img src="/2025/04/15/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%9B%9B-EditorGUIUtility%E5%85%AC%E5%85%B1%E7%B1%BB/L13%E5%8A%A0%E8%BD%BD%E8%B5%84%E6%BA%90.png" alt></p><h1 id="%E4%B8%89%E3%80%81%E6%90%9C%E7%B4%A2%E6%A1%86%E6%9F%A5%E8%AF%A2%E3%80%81%E5%AF%B9%E8%B1%A1%E9%80%89%E4%B8%AD%E6%8F%90%E7%A4%BA" tabindex="-1">三、搜索框查询、对象选中提示</h1><h2 id="3.1-%E6%90%9C%E7%B4%A2%E6%A1%86%E6%9F%A5%E8%AF%A2" tabindex="-1">3.1 搜索框查询</h2><ol><li>主要作用：<br>弹出一个搜索窗口，用于选择自己想要的资源，只能打开窗口，无法监听选择的对象信息，需要配合第3点中的EditorGUIUtility.GetObjectPickerObject()进行使用</li><li>主要API：</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EditorGUIUtility.ShowObjectPicker&lt;资源类型&gt;(默认被选中的对象, 是否允许查找场景对象, <span class="string">&quot;查找对象名称过滤&quot;</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><ul><li>参数1. 默认被选中的对象的引用</li><li>参数2. 是否允许查找场景对象</li><li>参数3. 查找对象名称过滤（比如这里的normal是指文件名称中有normal的会被搜索到）</li><li>参数4. controlID, 默认写0</li></ul><ol start="3"><li>获取选择对象，主要API：</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EditorGUIUtility.GetObjectPickerObject()</span><br></pre></td></tr></table></figure><ul><li>弹出的搜索窗口会通过发送事件的形式，通知开启它的窗口对象信息的变化</li><li>通过Event公共类可以获取其它窗口发送给自己的事件。（即Event公共类会给当前打开的窗口发送事件信息）</li><li>Event.current 获取当前事件<ul><li>commandName 获取事件命令的名字<ul><li>ObjectSelectorUpdated 对象选择发生变化时发送</li><li>ObjectSelectorClosed 对象选择窗口关闭时发送</li></ul></li></ul></li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(Event.current.commandName == <span class="string">&quot;ObjectSelectorUpdated&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//当选择发生更新时通知进入</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (Event.current.commandName == <span class="string">&quot;ObjectSelectorClosed&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//当选择窗口关闭时通知进入</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Texture img3;</span><br><span class="line"><span class="comment">//搜索框查询</span></span><br><span class="line"><span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;打开搜索框查询窗口&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    EditorGUIUtility.ShowObjectPicker&lt;Texture&gt;(<span class="literal">null</span>, <span class="literal">false</span>, <span class="string">&quot;Editor&quot;</span>, <span class="number">0</span>);<span class="comment">//传参分别表示，默认选中的是null对象，不允许查找场景物体，文件名称中有Editor的会被搜索到的Texture资源</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Event.current.commandName == <span class="string">&quot;ObjectSelectorUpdated&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    img3 = EditorGUIUtility.GetObjectPickerObject() <span class="keyword">as</span> Texture;</span><br><span class="line">    <span class="keyword">if</span> (img3 != <span class="literal">null</span>)</span><br><span class="line">        Debug.Log(img3.name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (Event.current.commandName == <span class="string">&quot;ObjectSelectorClosed&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">    img3 = EditorGUIUtility.GetObjectPickerObject() <span class="keyword">as</span> Texture;</span><br><span class="line">    <span class="keyword">if</span> (img3 != <span class="literal">null</span>)</span><br><span class="line">        Debug.Log(<span class="string">&quot;窗口关闭 - &quot;</span> + img3.name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3.2-%E5%AF%B9%E8%B1%A1%E9%80%89%E4%B8%AD%E6%8F%90%E7%A4%BA" tabindex="-1">3.2 对象选中提示</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EditorGUIUtility.PingObject(想要提示选中的对象);</span><br></pre></td></tr></table></figure><ol><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对象选中提示提示</span></span><br><span class="line"><span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;高亮选中对象&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (img3 != <span class="literal">null</span>)</span><br><span class="line">        EditorGUIUtility.PingObject(img3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3.3-%E6%95%88%E6%9E%9C" tabindex="-1">3.3 效果</h2><ol><li>搜索框查询<br><img src="/2025/04/15/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%9B%9B-EditorGUIUtility%E5%85%AC%E5%85%B1%E7%B1%BB/L14%E6%89%93%E5%BC%80%E6%90%9C%E7%B4%A2%E6%A1%86%E6%9F%A5%E8%AF%A2.png" alt></li><li>对象选中提示<br><img src="/2025/04/15/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%9B%9B-EditorGUIUtility%E5%85%AC%E5%85%B1%E7%B1%BB/L14%E9%80%89%E4%B8%AD%E5%AF%B9%E8%B1%A1%E6%8F%90%E7%A4%BA.png" alt></li></ol><h1 id="%E5%9B%9B%E3%80%81%E7%AA%97%E5%8F%A3%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92%E3%80%81%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2" tabindex="-1">四、窗口事件传递、坐标转换</h1><h2 id="4.1-region-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%80-%E7%AA%97%E5%8F%A3%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92" tabindex="-1">4.1 region 知识点一 窗口事件传递</h2><ol><li>方法<br>在传递事件时,会自动将接受事件的窗口打开,不管对象是否有监听处理对应的内容</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Event e = EditorGUIUtility.CommandEvent(<span class="string">&quot;事件名&quot;</span>);</span><br><span class="line"><span class="comment">//获取到另一个窗口后，让该窗口调用SendEvent(e) </span></span><br><span class="line"><span class="comment">//在另一个窗口中可以通过</span></span><br><span class="line">Event.current.type == EventType.ExecuteCommand 判断</span><br><span class="line">Event.current.commandName == <span class="string">&quot;事件名&quot;</span> 判断</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//窗口事件传递</span></span><br><span class="line">    <span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;传递事件&quot;</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//声明事件</span></span><br><span class="line">        Event e = EditorGUIUtility.CommandEvent(<span class="string">&quot;测试事件&quot;</span>);</span><br><span class="line">        Lesson3 win = EditorWindow.GetWindow&lt;Lesson3&gt;();</span><br><span class="line">        win.SendEvent(e);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//````````````````````````````````````````````````````````````````</span></span><br><span class="line">    <span class="comment">//另一个窗口代码的OnGUI中（这里指Lesson3.cs的OnGUI中）</span></span><br><span class="line">    <span class="keyword">if</span> (Event.current.type == EventType.ExecuteCommand)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Event.current.commandName == <span class="string">&quot;测试事件&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(<span class="string">&quot;收到测试事件&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="4.2-%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2" tabindex="-1">4.2 坐标转换</h2><ul><li>屏幕坐标系：原点为屏幕左上角</li><li>GUI坐标系：原点为当前窗口左上角</li></ul><ol><li>方法</li></ol><ul><li><p>GUIToScreenPoint:将点从GUI位置转换为屏幕空间</p></li><li><p>GUIToScreenRect:将rect从GUI位置转换为屏幕空间</p></li><li><p>ScreenToGUIPoint:将点从屏幕空间转换为GUI位置</p></li><li><p>ScreenToGUIRect:将rect从屏幕空间转换为GUI位置</p></li></ul><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//坐标转换</span></span><br><span class="line"><span class="keyword">if</span> (GUILayout.Button(<span class="string">&quot;坐标转换测试&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    Vector2 v = <span class="keyword">new</span> Vector2(<span class="number">10</span>, <span class="number">10</span>);<span class="comment">//GUI坐标</span></span><br><span class="line">    GUI.BeginGroup(<span class="keyword">new</span> Rect(<span class="number">10</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">100</span>));</span><br><span class="line">    <span class="comment">//转换函数 如果包裹在布局相关函数中 那么位置会加上布局的偏移 再进行转换</span></span><br><span class="line">    Vector2 screenPos = EditorGUIUtility.GUIToScreenPoint(v);</span><br><span class="line">    GUI.EndGroup();</span><br><span class="line">    Debug.Log(<span class="string">&quot;GUI:&quot;</span> + v + <span class="string">&quot;Screen:&quot;</span> + screenPos);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4.3-%E6%95%88%E6%9E%9C" tabindex="-1">4.3 效果</h2><p><img src="/2025/04/15/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%9B%9B-EditorGUIUtility%E5%85%AC%E5%85%B1%E7%B1%BB/L15%E7%AA%97%E5%8F%A3%E4%BA%8B%E4%BB%B6%E5%92%8C%E5%9D%90%E6%A0%87%E8%BD%AC%E6%8D%A2.png" alt></p><h1 id="%E4%BA%94%E3%80%81%E6%8C%87%E5%AE%9A%E5%8C%BA%E5%9F%9F%E4%BD%BF%E7%94%A8%E5%AF%B9%E5%BA%94%E9%BC%A0%E6%A0%87%E6%8C%87%E9%92%88" tabindex="-1">五、指定区域使用对应鼠标指针</h1><h2 id="5.1-%E6%96%B9%E6%B3%95" tabindex="-1">5.1 方法</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">AddCursorRect(Rect position, MouseCursor mouse);</span><br><span class="line"><span class="comment">//  MouseCursor鼠标光标类型枚举</span></span><br><span class="line"><span class="comment">//  Arrow            普通指针箭头</span></span><br><span class="line"><span class="comment">//  Text                文本文本光标</span></span><br><span class="line"><span class="comment">//  ResizeVertical      调整大小垂直调整大小箭头</span></span><br><span class="line"><span class="comment">//  ResizeHorizontal    调整大小水平调整大小箭头</span></span><br><span class="line"><span class="comment">//  Link                带有链接徽章的链接箭头</span></span><br><span class="line"><span class="comment">//  SlideArrow          滑动箭头带有小箭头的箭头，用于指示在数字字段处滑动</span></span><br><span class="line"><span class="comment">//  ResizeUpRight       调整大小向上向右调整窗口边缘的大小</span></span><br><span class="line"><span class="comment">//  ResizeUpLeft        窗口边缘为左</span></span><br><span class="line"><span class="comment">//  MoveArrow           带有移动符号的箭头旁边用于场景视图</span></span><br><span class="line"><span class="comment">//  RotateArrow         旁边有用于场景视图的旋转符号</span></span><br><span class="line"><span class="comment">//  ScaleArrow          旁边有用于场景视图的缩放符号</span></span><br><span class="line"><span class="comment">//  ArrowPlus           旁边带有加号的箭头</span></span><br><span class="line"><span class="comment">//  ArrowMinus          旁边带有减号的箭头</span></span><br><span class="line"><span class="comment">//  Pan                 用拖动的手拖动光标进行平移</span></span><br><span class="line"><span class="comment">//  Orbit               用眼睛观察轨道的光标</span></span><br><span class="line"><span class="comment">//  Zoom                使用放大镜进行缩放的光标</span></span><br><span class="line"><span class="comment">//  FPS                 带眼睛的光标和用于FPS导航的样式化箭头键</span></span><br><span class="line"><span class="comment">//  CustomCursor        当前用户定义的光标</span></span><br><span class="line"><span class="comment">//  SplitResizeUpDown   向上-向下调整窗口拆分器的大小箭头</span></span><br><span class="line"><span class="comment">//  SplitResizeLeftRight窗口拆分器的左-右调整大小箭头</span></span><br></pre></td></tr></table></figure><h2 id="5.2-%E7%A4%BA%E4%BE%8B" tabindex="-1">5.2 示例</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EditorGUI.DrawRect(<span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">150</span>, <span class="number">100</span>, <span class="number">100</span>), Color.green);<span class="comment">//绘制一块绿色矩形</span></span><br><span class="line">EditorGUIUtility.AddCursorRect(<span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">150</span>, <span class="number">100</span>, <span class="number">100</span>), MouseCursor.Text);</span><br></pre></td></tr></table></figure><h2 id="5.3-%E6%95%88%E6%9E%9C" tabindex="-1">5.3 效果</h2><p><img src="/2025/04/15/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%9B%9B-EditorGUIUtility%E5%85%AC%E5%85%B1%E7%B1%BB/L16%E6%8C%87%E5%AE%9A%E5%8C%BA%E5%9F%9F%E4%BD%BF%E7%94%A8%E5%AF%B9%E5%BA%94%E9%BC%A0%E6%A0%87%E6%8C%87%E9%92%88.jpg" alt></p><h1 id="%E5%85%AD%E3%80%81%E7%BB%98%E5%88%B6%E8%89%B2%E6%9D%BF%E3%80%81%E7%BB%98%E5%88%B6%E6%9B%B2%E7%BA%BF" tabindex="-1">六、绘制色板、绘制曲线</h1><h2 id="6.1-%E7%BB%98%E5%88%B6%E8%89%B2%E6%9D%BF" tabindex="-1">6.1 绘制色板</h2><ol><li>方法<br>在指定区域绘制一个色板矩形,主要配合 EditorGUILayout.ColorField 颜色输入控件使用</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EditorGUIUtility.DrawColorSwatch(Rect 绘制色板的矩形, Color 颜色);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Color color;</span><br><span class="line"><span class="comment">//绘制色板</span></span><br><span class="line">color = EditorGUILayout.ColorField(<span class="keyword">new</span> GUIContent(<span class="string">&quot;选取颜色&quot;</span>), color, <span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">EditorGUIUtility.DrawColorSwatch(<span class="keyword">new</span> Rect(<span class="number">180</span>, <span class="number">180</span>, <span class="number">30</span>, <span class="number">30</span>), Color.blue);<span class="comment">//绘制蓝色色板</span></span><br></pre></td></tr></table></figure><h2 id="6.2-%E7%BB%98%E5%88%B6%E6%9B%B2%E7%BA%BF" tabindex="-1">6.2 绘制曲线</h2><ol><li>方法<br>在指定区域绘制曲线,主要配合EditorGUILayout.CurveField 曲线输入控件使用</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">EditorGUIUtility.DrawCurveSwatch(Rect 绘制曲线的范围,</span><br><span class="line">                                   AnimationCurve 曲线,</span><br><span class="line">                                   SerializedProperty 要绘制为SerializedProperty的曲线,</span><br><span class="line">                                   Color 绘制曲线的颜色,</span><br><span class="line">                                   Color 绘制背景的颜色);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//绘制曲线</span></span><br><span class="line">    <span class="keyword">private</span> AnimationCurve curve = <span class="keyword">new</span> AnimationCurve();</span><br><span class="line">    curve = EditorGUILayout.CurveField(<span class="string">&quot;曲线设置&quot;</span>, curve);</span><br><span class="line">    EditorGUIUtility.DrawCurveSwatch(<span class="keyword">new</span> Rect(<span class="number">0</span>, <span class="number">300</span>, <span class="number">100</span>, <span class="number">80</span>), curve, <span class="literal">null</span>, Color.red, Color.white);</span><br></pre></td></tr></table></figure><h2 id="6.3-%E6%95%88%E6%9E%9C" tabindex="-1">6.3 效果</h2><p><img src="/2025/04/15/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E5%9B%9B-EditorGUIUtility%E5%85%AC%E5%85%B1%E7%B1%BB/L17%E7%BB%98%E5%88%B6%E8%89%B2%E6%9D%BF%E3%80%81%E7%BB%98%E5%88%B6%E6%9B%B2%E7%BA%BF.png" alt></p><h1 id="%E4%B8%83%E3%80%81%E6%9B%B4%E5%A4%9Aapi" tabindex="-1">七、更多API</h1><p>官方文档：<a href="https://docs.unity3d.com/ScriptReference/EditorGUIUtility.html">https://docs.unity3d.com/ScriptReference/EditorGUIUtility.html</a></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;EditorGUIUtility公共类相关内容&lt;/p&gt;</summary>
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity编辑器拓展" scheme="http://example.com/tags/Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95/"/>
    
  </entry>
  
  <entry>
    <title>GUI的工作原理和主要作用</title>
    <link href="http://example.com/2025/03/31/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-UI%E7%B3%BB%E7%BB%9F%E4%B9%8BGUI-%E4%BA%8C-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%92%8C%E4%B8%BB%E8%A6%81%E4%BD%9C%E7%94%A8/"/>
    <id>http://example.com/2025/03/31/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-UI%E7%B3%BB%E7%BB%9F%E4%B9%8BGUI-%E4%BA%8C-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%92%8C%E4%B8%BB%E8%A6%81%E4%BD%9C%E7%94%A8/</id>
    <published>2025-03-31T14:39:08.000Z</published>
    <updated>2025-03-31T14:40:12.825Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; href=&quot;//cdn.jsdelivr.net/npm/katex/dist/katex.min.css&quot;&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;//cdn.jsdelivr.net/npm/markdown-</summary>
      
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="UI系统之GUI" scheme="http://example.com/tags/UI%E7%B3%BB%E7%BB%9F%E4%B9%8BGUI/"/>
    
  </entry>
  
  <entry>
    <title>第一章-GUI概述</title>
    <link href="http://example.com/2025/03/31/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-UI%E7%B3%BB%E7%BB%9F%E4%B9%8BGUI-%E4%B8%80-GUI%E6%A6%82%E8%BF%B0/"/>
    <id>http://example.com/2025/03/31/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-UI%E7%B3%BB%E7%BB%9F%E4%B9%8BGUI-%E4%B8%80-GUI%E6%A6%82%E8%BF%B0/</id>
    <published>2025-03-31T14:27:48.000Z</published>
    <updated>2025-03-31T14:39:34.637Z</updated>
    
    <content type="html"><![CDATA[<p>学习 Unity中的UI系统之GUI部分</p><span id="more"></span><h1 id="%E4%B8%80%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AFui%E7%B3%BB%E7%BB%9F" tabindex="-1">一、什么是UI系统</h1><ul><li>Ul是User Interface(用户界面)的简称</li><li>用户界面就是游戏中的登录，注册，背包，人物等等功能面板，游戏中最多的逻辑功能就是和UI相关的功能</li><li>Unity中的UI系统可以理解为：Unity提供给我们制作UI功能的手段</li></ul><h1 id="%E4%BA%8C%E3%80%81ui%E7%B3%BB%E7%BB%9F%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7" tabindex="-1">二、UI系统的重要性</h1><p>UI是游戏中最重要的部分，不管是2D游戏还是3D游戏，几乎所有游戏功能都和UI有关系，所以它是极其重要的。UI开发几乎会伴随你的整个游戏开发生涯</p><h1 id="%E4%B8%89%E3%80%81ui%E7%9A%84%E9%87%8D%E8%A6%81%E5%86%85%E5%AE%B9" tabindex="-1">三、UI的重要内容</h1><ul><li>基本控件使用</li><li>复合控件使用</li><li>对GUI进行封装，让其使用更方便。</li></ul><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;学习 Unity中的UI系统之GUI部分&lt;/p&gt;</summary>
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="UI系统之GUI" scheme="http://example.com/tags/UI%E7%B3%BB%E7%BB%9F%E4%B9%8BGUI/"/>
    
  </entry>
  
  <entry>
    <title>3D数学基础-图形和游戏开发-学习笔记 第六章 矩阵详解</title>
    <link href="http://example.com/2025/03/29/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%9F%A9%E9%98%B5%E8%AF%A6%E8%A7%A3/"/>
    <id>http://example.com/2025/03/29/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%9F%A9%E9%98%B5%E8%AF%A6%E8%A7%A3/</id>
    <published>2025-03-29T03:27:30.000Z</published>
    <updated>2025-03-30T14:50:08.448Z</updated>
    
    <content type="html"><![CDATA[<p>之前第4章介绍了矩阵的大部分重要属性和操作,并讨论了如何使用矩阵来表示一般的几何变换。第5章详细讨论了矩阵和几何变换。本章将通过讨论一些更有趣和有用的矩阵运算来结束矩阵主题。</p><span id="more"></span><ul><li>第6.1节将介绍矩阵的行列式。</li><li>第6.2节将解释矩阵的逆矩阵。</li><li>第6.3节将讨论正交矩阵。</li><li>第6.4节将介绍齐次矢量和4×4矩阵,并演示如何将它们应用于三维中执行仿射变换。</li><li>第6.5节将讨论透视投影,并展示如何使用4x4矩阵进行透视投影。</li></ul><h1 id="6.1-%E7%9F%A9%E9%98%B5%E8%A1%8C%E5%88%97%E5%BC%8F" tabindex="-1">6.1 矩阵行列式</h1><p>对于方形矩阵,有一个特殊的标量称为矩阵的行列式(Determinant)。行列式在线性代数中有许多有用的属性,在几何中也有一些有趣的解释。<br>按照习惯,我们将首先讨论一些数学,然后做一些几何解释；第6.1.1节将介绍行列式的符号，并给出用于计算2×2或3×3矩阵的行列式的线性代数规则；第6.1.2节将讨论子矩阵行列式(Minor)和余子式(Cofactor)；第6.1.3节节将展示如何使用子矩阵和余子式计算任意nxn矩阵的行列式；第6.1.4节将从几何角度解释行列式。</p><h2 id="6.1.1-%E5%85%B3%E4%BA%8E2%C3%972%E5%92%8C3%C3%973%E7%9A%84%E8%A1%8C%E5%88%97%E5%BC%8F" tabindex="-1">6.1.1 关于2×2和3×3的行列式</h2><ol><li>方形矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi></mrow><annotation encoding="application/x-tex">\bold{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">M</span></span></span></span></eq>的行列式表示为<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="bold">M</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\bold{M}|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathbf">M</span><span class="mord">∣</span></span></span></span></eq>,有些图书也将它表示为&quot;det <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi></mrow><annotation encoding="application/x-tex">\bold{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">M</span></span></span></span></eq>&quot;。非方形矩阵的行列式是未定义的。本节将介绍如何计算2×2和3×3矩阵的行列式。第6.1.3节将讨论相当复杂的一般性<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></eq>矩阵的行列式。</li></ol><ul><li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn mathvariant="bold">2</mn><mo>×</mo><mn mathvariant="bold">2</mn></mrow><annotation encoding="application/x-tex">\bold{2}\times \bold{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord mathbf">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathbf">2</span></span></span></span></eq>的行列式由下式给出：<br><img src="/2025/03/29/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%9F%A9%E9%98%B5%E8%AF%A6%E8%A7%A3/6.6.1%202x2%E7%9F%A9%E9%98%B5%E7%9A%84%E8%A1%8C%E5%88%97%E5%BC%8F.png" alt><br>（当编写矩阵的行列式时，将使用垂直线代替括号）<ul><li>使用下面的示意图可以更容易地记住式(6.1)。只需沿对角线和反对角线分别让元素相乘,然后使用对角线元素相乘的结果减去反对角线元无素相乘的结果即可。<br><img src="/2025/03/29/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%9F%A9%E9%98%B5%E8%AF%A6%E8%A7%A3/6.1.1%202x2%E8%A1%8C%E5%88%97%E5%BC%8F%E8%AE%A1%E7%AE%97.png" alt></li></ul></li><li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn mathvariant="bold">3</mn><mo>×</mo><mn mathvariant="bold">3</mn></mrow><annotation encoding="application/x-tex">\bold{3}\times \bold{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord mathbf">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathbf">3</span></span></span></span></eq>的行列式由下式给出：<br><img src="/2025/03/29/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%9F%A9%E9%98%B5%E8%AF%A6%E8%A7%A3/6.6.1%203x3%E7%9F%A9%E9%98%B5%E7%9A%84%E8%A1%8C%E5%88%97%E5%BC%8F.png" alt><ul><li>我们可以通过一个类似的示意图来帮助记忆式(6.2)。先并排编写矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">M</mi></mrow><annotation encoding="application/x-tex">\bold{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">M</span></span></span></span></eq>的两个副本,然后沿对角线和反对角线分别让元素相乘,最后使用对角线元素相乘的结果的和减去反对角线元素相乘的结果即可。<br><img src="/2025/03/29/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%9F%A9%E9%98%B5%E8%AF%A6%E8%A7%A3/6.6.1%203x3%E8%A1%8C%E5%88%97%E5%BC%8F%E8%AE%A1%E7%AE%97.png" alt></li></ul></li></ul><ol start="3"><li>如果将<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn mathvariant="bold">3</mn><mo>×</mo><mn mathvariant="bold">3</mn></mrow><annotation encoding="application/x-tex">\bold{3}\times \bold{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord mathbf">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathbf">3</span></span></span></span></eq>矩阵的行解释为3个矢量,那么该矩阵的行列式就等价于3个矢量的所谓三重积(TripleProduct),具体如下:<br><img src="/2025/03/29/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E7%9F%A9%E9%98%B5%E8%AF%A6%E8%A7%A3/6.6.1%203x3%E7%9F%A9%E9%98%B5%E8%A1%8C%E5%88%97%E5%BC%8F%E4%B8%8E%E4%B8%89%E7%BB%B4%E7%9F%A2%E9%87%8F%E4%B8%89%E9%87%8D%E7%A7%AF.png" alt></li></ol><h2 id="6.1.2-%E5%AD%90%E7%9F%A9%E9%98%B5%E8%A1%8C%E5%88%97%E5%BC%8F%E5%92%8C%E4%BD%99%E5%AD%90%E5%BC%8F" tabindex="-1">6.1.2 子矩阵行列式和余子式</h2><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;之前第4章介绍了矩阵的大部分重要属性和操作,并讨论了如何使用矩阵来表示一般的几何变换。第5章详细讨论了矩阵和几何变换。本章将通过讨论一些更有趣和有用的矩阵运算来结束矩阵主题。&lt;/p&gt;</summary>
    
    
    
    <category term="3D数学基础" scheme="http://example.com/categories/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="3D数学基础" scheme="http://example.com/tags/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>Unity编辑器拓展（三）-EditorGUI相关</title>
    <link href="http://example.com/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/"/>
    <id>http://example.com/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/</id>
    <published>2025-03-04T13:02:36.000Z</published>
    <updated>2025-04-15T14:44:33.089Z</updated>
    
    <content type="html"><![CDATA[<p>EditorGUI相关的内容</p><span id="more"></span><ul><li><a href="#%E4%B8%80editorgui%E6%98%AF%E4%BB%80%E4%B9%88">一、EditorGUI是什么</a><ul><li><a href="#11-%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE">1.1 知识回顾</a></li><li><a href="#12-editorgui%E6%98%AF%E4%BB%80%E4%B9%88">1.2 EditorGUI是什么？</a></li></ul></li><li><a href="#%E4%BA%8C%E6%96%87%E6%9C%AC%E5%B1%82%E7%BA%A7%E5%92%8C%E6%A0%87%E7%AD%BE%E9%A2%9C%E8%89%B2%E6%8B%BE%E5%8F%96%E6%8E%A7%E4%BB%B6">二、文本、层级和标签、颜色拾取控件</a><ul><li><a href="#21-editorguilayout%E4%B8%AD%E7%9A%84%E6%96%87%E6%9C%AC%E6%8E%A7%E4%BB%B6">2.1 EditorGUILayout中的文本控件</a></li><li><a href="#22-editorguilayout%E4%B8%AD%E7%9A%84%E5%B1%82%E7%BA%A7%E6%A0%87%E7%AD%BE%E9%80%89%E6%8B%A9">2.2 EditorGUILayout中的层级、标签选择</a></li><li><a href="#23-editorguilayout%E4%B8%AD%E7%9A%84%E9%A2%9C%E8%89%B2%E8%8E%B7%E5%8F%96">2.3 EditorGUILayout中的颜色获取</a></li></ul></li><li><a href="#24-%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA">2.4 效果展示</a></li><li><a href="#%E4%B8%89%E6%9E%9A%E4%B8%BE%E9%80%89%E6%8B%A9%E6%95%B4%E6%95%B0%E9%80%89%E6%8B%A9%E6%8C%89%E4%B8%8B%E5%B0%B1%E8%A7%A6%E5%8F%91%E7%9A%84%E6%8C%89%E9%92%AE">三、枚举选择、整数选择、按下就触发的按钮</a><ul><li><a href="#31-%E6%9E%9A%E4%B8%BE%E9%80%89%E6%8B%A9%E6%8E%A7%E4%BB%B6">3.1 枚举选择控件</a></li><li><a href="#32-%E6%95%B4%E6%95%B0%E9%80%89%E6%8B%A9%E6%8E%A7%E4%BB%B6">3.2 整数选择控件</a></li><li><a href="#33-%E6%8C%89%E4%B8%8B%E5%B0%B1%E8%A7%A6%E5%8F%91%E7%9A%84%E6%8C%89%E9%92%AE%E6%8E%A7%E4%BB%B6">3.3 按下就触发的按钮控件</a></li><li><a href="#34-%E6%95%88%E6%9E%9C">3.4 效果</a></li></ul></li><li><a href="#%E5%9B%9B%E5%AF%B9%E8%B1%A1%E5%85%B3%E8%81%94%E5%90%84%E7%B1%BB%E5%9E%8B%E8%BE%93%E5%85%A5-%E6%8E%A7%E4%BB%B6">四、对象关联、各类型输入 控件</a><ul><li><a href="#41-%E5%AF%B9%E8%B1%A1%E5%85%B3%E8%81%94%E6%8E%A7%E4%BB%B6">4.1 对象关联控件</a></li><li><a href="#42-%E5%90%84%E7%B1%BB%E5%9E%8B%E8%BE%93%E5%85%A5%E6%8E%A7%E4%BB%B6">4.2 各类型输入控件</a></li><li><a href="#43-%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA">4.3 效果展示</a></li></ul></li><li><a href="#%E4%BA%94-%E6%8A%98%E5%8F%A0%E6%8A%98%E5%8F%A0%E7%BB%84%E6%8E%A7%E4%BB%B6">五、 折叠、折叠组控件</a><ul><li><a href="#51-%E6%8A%98%E5%8F%A0%E6%8E%A7%E4%BB%B6">5.1 折叠控件</a></li><li><a href="#52-%E6%8A%98%E5%8F%A0%E7%BB%84%E6%8E%A7%E4%BB%B6">5.2 折叠组控件</a></li><li><a href="#53-%E6%8A%98%E5%8F%A0%E5%92%8C%E6%8A%98%E5%8F%A0%E7%BB%84%E7%9A%84%E5%8C%BA%E5%88%AB">5.3 折叠和折叠组的区别</a></li><li><a href="#54-%E6%95%88%E6%9E%9C">5.4 效果</a></li></ul></li><li><a href="#%E5%85%AD%E5%BC%80%E5%85%B3%E5%BC%80%E5%85%B3%E7%BB%84%E6%8E%A7%E4%BB%B6">六、开关、开关组控件</a><ul><li><a href="#61-%E5%BC%80%E5%85%B3%E6%8E%A7%E4%BB%B6">6.1 开关控件</a></li><li><a href="#62-%E5%BC%80%E5%85%B3%E7%BB%84%E6%8E%A7%E4%BB%B6">6.2 开关组控件</a></li><li><a href="#63-%E6%95%88%E6%9E%9C">6.3 效果</a></li></ul></li><li><a href="#%E4%B8%83-%E6%BB%91%E5%8A%A8%E6%9D%A1%E5%8F%8C%E5%9D%97%E6%BB%91%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6">七、 滑动条、双块滑动条控件</a><ul><li><a href="#71-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%80-%E6%BB%91%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6">7.1 知识点一 滑动条控件</a></li><li><a href="#72-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%BA%8C-%E5%8F%8C%E5%9D%97%E6%BB%91%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6">7.2 知识点二 双块滑动条控件</a></li><li><a href="#73-%E6%95%88%E6%9E%9C">7.3 效果</a></li></ul></li><li><a href="#%E5%85%AB%E5%B8%AE%E5%8A%A9%E6%A1%86%E5%9E%82%E7%9B%B4%E9%97%B4%E9%9A%94-%E6%8E%A7%E4%BB%B6">八、帮助框、垂直间隔 控件</a><ul><li><a href="#81-%E5%B8%AE%E5%8A%A9%E6%A1%86%E6%8E%A7%E4%BB%B6">8.1 帮助框控件</a></li><li><a href="#82--%E9%97%B4%E9%9A%94%E6%8E%A7%E4%BB%B6">8.2  间隔控件</a></li><li><a href="#83-%E6%95%88%E6%9E%9C">8.3 效果</a></li></ul></li><li><a href="#%E4%B9%9D%E5%8A%A8%E7%94%BB%E6%9B%B2%E7%BA%BF%E6%8E%A7%E4%BB%B6%E5%92%8C%E5%B8%83%E5%B1%80api">九、动画曲线控件和布局API</a><ul><li><a href="#91-%E5%8A%A8%E7%94%BB%E6%9B%B2%E7%BA%BF%E6%8E%A7%E4%BB%B6">9.1 动画曲线控件</a></li><li><a href="#92-%E5%B8%83%E5%B1%80%E7%9B%B8%E5%85%B3api">9.2 布局相关API</a></li><li><a href="#93-%E6%95%88%E6%9E%9C">9.3 效果</a></li></ul></li><li><a href="#%E5%8D%81%E6%80%BB%E7%BB%93">十、总结</a></li></ul><h1 id="%E4%B8%80%E3%80%81editorgui%E6%98%AF%E4%BB%80%E4%B9%88" tabindex="-1">一、EditorGUI是什么</h1><h2 id="1.1-%E7%9F%A5%E8%AF%86%E5%9B%9E%E9%A1%BE" tabindex="-1">1.1 知识回顾</h2><ol><li><p>GUILayout 是一个GUI自动布局的公共类</p></li><li><p>它其中的方法和GUI基本一模一样，都是用来绘制、响应各种UI控件的</p></li><li><p>只不过它在<strong>GUI的基础上加入了自动布局功能</strong></p></li><li><p>我们无需过多的去关心UI控件的位置和大小</p></li><li><p>guilayoutoption 布局选项</p></li></ol><ul><li>方法 ：GUILayout.Button(“文本”,[guilayoutoption])</li><li>使用示例：</li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GUILayout.Button(<span class="string">&quot;确定&quot;</span>,guilayout.width(<span class="number">300</span>),guilayout.height(<span class="number">200</span>),...)</span><br></pre></td></tr></table></figure><ul><li>更多：</li></ul><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法 ：GUILayout.Button(&quot;确定&quot;,[guilayoutoption])</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//控件的固定宽高</span></span><br><span class="line">guilayout.width(<span class="number">300</span>);</span><br><span class="line">guilayout.height(<span class="number">200</span>);</span><br><span class="line"><span class="comment">//允许控件的最小宽高</span></span><br><span class="line">guilayout.minwidth(<span class="number">50</span>);</span><br><span class="line">guilayout.minheight(<span class="number">50</span>);</span><br><span class="line"><span class="comment">//允许控件的最大宽高</span></span><br><span class="line">guilayout.maxwidth(<span class="number">100</span>);</span><br><span class="line">guilayout.maxheight(<span class="number">100</span>);</span><br><span class="line"><span class="comment">//允许或禁止水平拓展</span></span><br><span class="line">guilayout.expandwidth(<span class="literal">true</span>);<span class="comment">//允许</span></span><br><span class="line">guilayout.expandheight(<span class="literal">false</span>);<span class="comment">//禁止</span></span><br><span class="line">guilayout.expandheight(<span class="literal">true</span>);<span class="comment">//允许</span></span><br><span class="line">guilayout.expandheight(<span class="literal">false</span>);<span class="comment">//禁止</span></span><br></pre></td></tr></table></figure><ol start="6"><li>创建一个GUI窗口</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">MenuItem(<span class="string">&quot;Unity编辑器拓展/Lesson3/EditorGUI窗口&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OpenLesson3</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Lesson3 win = EditorWindow.GetWindow&lt;Lesson3&gt;(<span class="string">&quot;EditorGUI窗口&quot;</span>);</span><br><span class="line">    <span class="comment">//win.titleContent = new GUIContent(&quot;EditorGUI窗口&quot;); </span></span><br><span class="line">    win.Show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1.2-editorgui%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F" tabindex="-1">1.2 EditorGUI是什么？</h2><ol><li><p>EditorGUI 类似 GUI，是一个主要用于绘制编辑器拓展 UI 的工具类</p><ul><li>它提供了一些 GUI 中没有的API，主要是 编辑器功能中会用到的一些特殊控件</li></ul></li><li><p>而EditorGUILayout 类似于 GUILayout，是一个<strong>带有自动布局功能的</strong> EditorGUI 绘制工具类</p></li><li><p>我们经常会将 EditorGUI 和 GUI 混合使用 来制作一些编辑器拓展功能</p><ul><li>但是由于更多时候我们会用到自动布局功能</li><li>因此着重学习 EditorGUILayout 中的功能</li></ul></li><li><p>EditorGUI和EditorGUILayout的区别仅仅是需要自己设置位置而已</p></li><li><p>更多详细内容：<a href="https://docs.unity.cn/cn/2022.3/ScriptReference/EditorGUILayout.html">https://docs.unity.cn/cn/2022.3/ScriptReference/EditorGUILayout.html</a></p></li></ol><h1 id="%E4%BA%8C%E3%80%81%E6%96%87%E6%9C%AC%E3%80%81%E5%B1%82%E7%BA%A7%E5%92%8C%E6%A0%87%E7%AD%BE%E3%80%81%E9%A2%9C%E8%89%B2%E6%8B%BE%E5%8F%96%E6%8E%A7%E4%BB%B6" tabindex="-1">二、文本、层级和标签、颜色拾取控件</h1><h2 id="2.1-editorguilayout%E4%B8%AD%E7%9A%84%E6%96%87%E6%9C%AC%E6%8E%A7%E4%BB%B6" tabindex="-1">2.1 EditorGUILayout中的文本控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;文本标题&quot;</span>, <span class="string">&quot;文本内容&quot;</span>);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> layer;</span><br><span class="line"><span class="built_in">string</span> tag;</span><br><span class="line">Color color;</span><br><span class="line"><span class="comment">//文本控件</span></span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;文本标题&quot;</span>, <span class="string">&quot;测试内容&quot;</span>);</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;文本内容&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="2.2-editorguilayout%E4%B8%AD%E7%9A%84%E5%B1%82%E7%BA%A7%E3%80%81%E6%A0%87%E7%AD%BE%E9%80%89%E6%8B%A9" tabindex="-1">2.2 EditorGUILayout中的层级、标签选择</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Layer</span></span><br><span class="line">    <span class="built_in">int</span>变量 = EditorGUILayout.LayerField(<span class="string">&quot;层级选择&quot;</span>, <span class="built_in">int</span>变量);</span><br><span class="line"><span class="comment">//Tag</span></span><br><span class="line">    <span class="built_in">string</span>变量 = EditorGUILayout.TagField(<span class="string">&quot;标签选择&quot;</span>, <span class="built_in">string</span>变量);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//层级标签控件</span></span><br><span class="line"><span class="comment">//layer = EditorGUILayout.LayerField(layer); //这样写就只会有个下拉框,没有说明文本</span></span><br><span class="line">layer = EditorGUILayout.LayerField(<span class="string">&quot;层级选择&quot;</span>, layer);</span><br><span class="line"><span class="comment">//tag = EditorGUILayout.TagField(tag); //这样写就只会有个下拉框,没有说明文本</span></span><br><span class="line">tag = EditorGUILayout.TagField(<span class="string">&quot;标签选择&quot;</span>, tag);</span><br></pre></td></tr></table></figure><h2 id="2.3-editorguilayout%E4%B8%AD%E7%9A%84%E9%A2%9C%E8%89%B2%E8%8E%B7%E5%8F%96" tabindex="-1">2.3 EditorGUILayout中的颜色获取</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">color变量 = EditorGUILayout.ColorField(<span class="keyword">new</span> GUIContent(<span class="string">&quot;标题&quot;</span>),color变量, 是否显示拾色器, 是否显示透明度通道, 是否支持HDR);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//颜色获取控件</span></span><br><span class="line">color = EditorGUILayout.ColorField(<span class="keyword">new</span> GUIContent(<span class="string">&quot;自定义颜色获取&quot;</span>), color, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><h1 id="2.4-%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA" tabindex="-1">2.4 效果展示</h1><p><img src="/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/%E6%96%87%E6%9C%AC%E3%80%81%E5%B1%82%E7%BA%A7%E5%92%8C%E6%A0%87%E7%AD%BE%E3%80%81%E9%A2%9C%E8%89%B2%E6%8B%BE%E5%8F%96%E6%8E%A7%E4%BB%B6%20%E6%95%88%E6%9E%9C.png" alt></p><h1 id="%E4%B8%89%E3%80%81%E6%9E%9A%E4%B8%BE%E9%80%89%E6%8B%A9%E3%80%81%E6%95%B4%E6%95%B0%E9%80%89%E6%8B%A9%E3%80%81%E6%8C%89%E4%B8%8B%E5%B0%B1%E8%A7%A6%E5%8F%91%E7%9A%84%E6%8C%89%E9%92%AE" tabindex="-1">三、枚举选择、整数选择、按下就触发的按钮</h1><h2 id="3.1-%E6%9E%9A%E4%B8%BE%E9%80%89%E6%8B%A9%E6%8E%A7%E4%BB%B6" tabindex="-1">3.1 枚举选择控件</h2><ol><li>枚举选择（方法）</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">枚举变量 = (枚举类型)EditorGUILayout.EnumPopup(<span class="string">&quot;枚举选择&quot;</span>, 枚举变量);</span><br></pre></td></tr></table></figure><ol start="2"><li>多选枚举（方法）<br>注意：<strong>多选枚举进行的是或运算</strong>，声明枚举时一定注意其中的赋值，并且一定要有多种情况的搭配值）,<strong>即如果是多选枚举，需要给每个不同的枚举要赋值为2的次方</strong></li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">枚举变量 = (枚举类型)EditorGUILayout.EnumFlagsField(<span class="string">&quot;枚举多选&quot;</span>, 枚举变量);</span><br></pre></td></tr></table></figure><ol start="3"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> E_TestType</span><br><span class="line">&#123;</span><br><span class="line">    One = <span class="number">1</span>,</span><br><span class="line">    Two = <span class="number">2</span>,</span><br><span class="line">    Three = <span class="number">4</span>,</span><br><span class="line">    One_and_Two = <span class="number">1</span> | <span class="number">2</span>,</span><br><span class="line">&#125;</span><br><span class="line">E_TestType type;</span><br><span class="line">E_TestType type2;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>[] strs = &#123; <span class="string">&quot;选择123&quot;</span>, <span class="string">&quot;选择234&quot;</span>, <span class="string">&quot;选择345&quot;</span> &#125;;</span><br><span class="line"><span class="built_in">int</span>[] ints = &#123; <span class="number">123</span>, <span class="number">234</span>, <span class="number">345</span> &#125;;</span><br><span class="line"><span class="built_in">int</span> num = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">//枚举选择</span></span><br><span class="line">type = (E_TestType)EditorGUILayout.EnumPopup(<span class="string">&quot;枚举选择&quot;</span>, type);</span><br><span class="line"></span><br><span class="line">type2 = (E_TestType)EditorGUILayout.EnumFlagsField(<span class="string">&quot;枚举多选&quot;</span>, type2);</span><br></pre></td></tr></table></figure><h2 id="3.2-%E6%95%B4%E6%95%B0%E9%80%89%E6%8B%A9%E6%8E%A7%E4%BB%B6" tabindex="-1">3.2 整数选择控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>变量 = EditorGUILayout.IntPopup(<span class="string">&quot;整数单选框&quot;</span>, <span class="built_in">int</span>变量, 字符串数组, <span class="built_in">int</span>数组);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//整数选择控件</span></span><br><span class="line"><span class="comment">// strs是每个值的描述</span></span><br><span class="line"><span class="comment">// ints是每个描述对应的值</span></span><br><span class="line"><span class="comment">//返回值num 是整数数组当中的某一个值，而不是索引</span></span><br><span class="line"></span><br><span class="line">num = EditorGUILayout.IntPopup(<span class="string">&quot;整数单选框&quot;</span>, num, strs, ints);</span><br><span class="line"></span><br><span class="line">EditorGUILayout.LabelField(num.ToString());</span><br></pre></td></tr></table></figure><h2 id="3.3-%E6%8C%89%E4%B8%8B%E5%B0%B1%E8%A7%A6%E5%8F%91%E7%9A%84%E6%8C%89%E9%92%AE%E6%8E%A7%E4%BB%B6" tabindex="-1">3.3 按下就触发的按钮控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EditorGUILayout.DropdownButton(<span class="keyword">new</span> GUIContent(<span class="string">&quot;按钮上文字&quot;</span>), FocusType.Passive)</span><br></pre></td></tr></table></figure><ol start="2"><li>参数的类型：</li></ol><ul><li>FocusType枚举时告诉UI系统能够获得键盘焦点 当用户按Tab键时在控件之间进行切换</li><li>Keyboard该控件可接收键盘焦点。</li><li>Passive 该控件不能接收键盘焦点。</li></ul><ol start="3"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//按下就响应的按钮</span></span><br><span class="line"><span class="keyword">if</span> (EditorGUILayout.DropdownButton(<span class="keyword">new</span> GUIContent(<span class="string">&quot;按钮上文字&quot;</span>), FocusType.Passive))</span><br><span class="line">    Debug.Log(<span class="string">&quot;按下就响应&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="3.4-%E6%95%88%E6%9E%9C" tabindex="-1">3.4 效果</h2><p><img src="/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/L5%E6%9E%9A%E4%B8%BE%E9%80%89%E6%8B%A9%E3%80%81%E6%95%B4%E6%95%B0%E9%80%89%E6%8B%A9%E3%80%81%E6%8C%89%E4%B8%8B%E5%B0%B1%E8%A7%A6%E5%8F%91%E7%9A%84%E6%8C%89%E9%92%AE.png" alt></p><h1 id="%E5%9B%9B%E3%80%81%E5%AF%B9%E8%B1%A1%E5%85%B3%E8%81%94%E3%80%81%E5%90%84%E7%B1%BB%E5%9E%8B%E8%BE%93%E5%85%A5-%E6%8E%A7%E4%BB%B6" tabindex="-1">四、对象关联、各类型输入 控件</h1><h2 id="4.1-%E5%AF%B9%E8%B1%A1%E5%85%B3%E8%81%94%E6%8E%A7%E4%BB%B6" tabindex="-1">4.1 对象关联控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对象变量 = EditorGUILayout.ObjectField(对象变量, <span class="keyword">typeof</span>(对象类型), 是否允许关联场景上对象资源) <span class="keyword">as</span> 对象类型;</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GameObject obj;</span><br><span class="line"><span class="comment">//对象关联</span></span><br><span class="line">obj = EditorGUILayout.ObjectField(<span class="string">&quot;关联资源对象&quot;</span>, obj, <span class="keyword">typeof</span>(GameObject), <span class="literal">false</span>) <span class="keyword">as</span> GameObject;</span><br></pre></td></tr></table></figure><h2 id="4.2-%E5%90%84%E7%B1%BB%E5%9E%8B%E8%BE%93%E5%85%A5%E6%8E%A7%E4%BB%B6" tabindex="-1">4.2 各类型输入控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>变量 = EditorGUILayout.IntField(<span class="string">&quot;Int输入框&quot;</span>, <span class="built_in">int</span>变量);</span><br><span class="line"><span class="built_in">long</span>变量 = EditorGUILayout.LongField(<span class="string">&quot;long输入框&quot;</span>, <span class="built_in">long</span>变量);</span><br><span class="line"><span class="built_in">float</span>变量 = EditorGUILayout.FloatField(<span class="string">&quot;Float 输入：&quot;</span>, <span class="built_in">float</span>变量);</span><br><span class="line"><span class="built_in">double</span>变量 = EditorGUILayout.DoubleField(<span class="string">&quot;double 输入：&quot;</span>, <span class="built_in">double</span>变量);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>变量 = EditorGUILayout.TextField(<span class="string">&quot;Text输入：&quot;</span>, <span class="built_in">string</span>变量);</span><br><span class="line">vector2变量 = EditorGUILayout.Vector2Field(<span class="string">&quot;Vec2输入： &quot;</span>, vector2变量);</span><br><span class="line">vector3变量 = EditorGUILayout.Vector3Field(<span class="string">&quot;Vec3输入： &quot;</span>, vector3变量);</span><br><span class="line">vector4变量 = EditorGUILayout.Vector4Field(<span class="string">&quot;Vec4输入： &quot;</span>, vector4变量);</span><br><span class="line">rect变量 = EditorGUILayout.RectField(<span class="string">&quot;rect输入： &quot;</span>, rect变量);</span><br><span class="line">bounds变量 = EditorGUILayout.BoundsField(<span class="string">&quot;Bounds输入： &quot;</span>, bounds变量);</span><br><span class="line">boundsInt变量 = EditorGUILayout.BoundsIntField(<span class="string">&quot;Bounds输入： &quot;</span>, boundsInt变量);</span><br></pre></td></tr></table></figure><ol start="2"><li>注意：EditorGUILayout中还有一些Delayed开头的输入控件<br>他们和普通输入控件<strong>最主要的区别是：在用户按 Enter 键或将焦点从字段移开之前，返回值不会更改</strong></li><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//各类型输入</span></span><br><span class="line">i = EditorGUILayout.IntField(<span class="string">&quot;Int输入框&quot;</span>, i);</span><br><span class="line">EditorGUILayout.LabelField(i.ToString());</span><br><span class="line">l = EditorGUILayout.LongField(<span class="string">&quot;long输入框&quot;</span>, l);</span><br><span class="line">f = EditorGUILayout.FloatField(<span class="string">&quot;Float 输入：&quot;</span>, f);</span><br><span class="line">d = EditorGUILayout.DoubleField(<span class="string">&quot;double 输入：&quot;</span>, d);</span><br><span class="line"></span><br><span class="line">str = EditorGUILayout.TextField(<span class="string">&quot;Text输入：&quot;</span>, str);</span><br><span class="line">vec2 = EditorGUILayout.Vector2Field(<span class="string">&quot;Vec2输入： &quot;</span>, vec2);</span><br><span class="line">vec3 = EditorGUILayout.Vector3Field(<span class="string">&quot;Vec3输入： &quot;</span>, vec3);</span><br><span class="line">vec4 = EditorGUILayout.Vector4Field(<span class="string">&quot;Vec4输入： &quot;</span>, vec4);</span><br><span class="line"></span><br><span class="line">rect = EditorGUILayout.RectField(<span class="string">&quot;rect输入： &quot;</span>, rect); <span class="comment">//矩形变量</span></span><br><span class="line">bounds = EditorGUILayout.BoundsField(<span class="string">&quot;Bounds输入： &quot;</span>, bounds); <span class="comment">//范围变量</span></span><br><span class="line">boundsInt = EditorGUILayout.BoundsIntField(<span class="string">&quot;Bounds输入： &quot;</span>, boundsInt);<span class="comment">//范围变量（整型）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//注意：EditorGUILayout中还有一些Delayed开头的输入控件</span></span><br><span class="line"><span class="comment">//     他们和普通输入控件最主要的区别是：在用户按 Enter 键或将焦点从字段移开之前，返回值不会更改。个人这边测试下来感觉DelayedIntField就是 不会实时更改i2，而是enter或者焦点移开后更改</span></span><br><span class="line">i2 = EditorGUILayout.DelayedIntField(<span class="string">&quot;Int输入框&quot;</span>, i2);</span><br><span class="line">EditorGUILayout.LabelField(i2.ToString());</span><br></pre></td></tr></table></figure><h2 id="4.3-%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA" tabindex="-1">4.3 效果展示</h2><p><img src="/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/L6%E5%AF%B9%E8%B1%A1%E5%85%B3%E8%81%94%E3%80%81%E5%90%84%E7%B1%BB%E5%9E%8B%E8%BE%93%E5%85%A5%E6%8E%A7%E4%BB%B6.png" alt></p><h1 id="%E4%BA%94%E3%80%81-%E6%8A%98%E5%8F%A0%E3%80%81%E6%8A%98%E5%8F%A0%E7%BB%84%E6%8E%A7%E4%BB%B6" tabindex="-1">五、 折叠、折叠组控件</h1><h2 id="5.1-%E6%8A%98%E5%8F%A0%E6%8E%A7%E4%BB%B6" tabindex="-1">5.1 折叠控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span>变量 = EditorGUILayout.Foldout(<span class="built_in">bool</span>变量, <span class="string">&quot;标题名&quot;</span>);</span><br><span class="line"><span class="comment">//通过bool变量配合 if(bool变量)&#123;</span></span><br><span class="line"><span class="comment">//  折叠的内容进行使用</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> isHide;</span><br><span class="line">isHide = EditorGUILayout.Foldout(isHide, <span class="string">&quot;折叠控件&quot;</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (isHide)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//枚举选择</span></span><br><span class="line">    type = (E_TestType)EditorGUILayout.EnumPopup(<span class="string">&quot;枚举选择&quot;</span>, type);</span><br><span class="line"></span><br><span class="line">    type2 = (E_TestType)EditorGUILayout.EnumFlagsField(<span class="string">&quot;枚举多选&quot;</span>, type2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//整数选择控件</span></span><br><span class="line">    <span class="comment">// strs是每个值的描述</span></span><br><span class="line">    <span class="comment">// ints是每个描述对应的值</span></span><br><span class="line">    <span class="comment">//返回值num 是整数数组当中的某一个值，而不是索引</span></span><br><span class="line">    num = EditorGUILayout.IntPopup(<span class="string">&quot;整数单选框&quot;</span>, num, strs, ints);</span><br><span class="line">    EditorGUILayout.LabelField(num.ToString());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//按下就响应的按钮</span></span><br><span class="line">    <span class="keyword">if</span> (EditorGUILayout.DropdownButton(<span class="keyword">new</span> GUIContent(<span class="string">&quot;按钮上文字&quot;</span>), FocusType.Passive))</span><br><span class="line">        Debug.Log(<span class="string">&quot;按下就响应&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5.2-%E6%8A%98%E5%8F%A0%E7%BB%84%E6%8E%A7%E4%BB%B6" tabindex="-1">5.2 折叠组控件</h2><p>配合其他控件使用，避免控件展示过多、或者分类控件</p><ol><li>方法<br>两行代码需要成对存在</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span>变量 = EditorGUILayout.BeginFoldoutHeaderGroup(<span class="built_in">bool</span>变量, <span class="string">&quot;标题名&quot;</span>,整行是否能点击折叠交互);</span><br><span class="line"><span class="comment">//通过bool变量配合 if(bool变量)&#123;</span></span><br><span class="line"><span class="comment">//  折叠的内容进行使用</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line">EditorGUILayout.EndFoldoutHeaderGroup(); </span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> isHideGroup;</span><br><span class="line">isHideGroup = EditorGUILayout.BeginFoldoutHeaderGroup(isHideGroup, <span class="string">&quot;折叠组控件&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (isHideGroup)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//对象关联 ----对象变量 = EditorGUILayout.ObjectField(对象变量, typeof(对象类型), 是否允许关联场景上对象资源) as 对象类型;</span></span><br><span class="line">    obj = EditorGUILayout.ObjectField(<span class="string">&quot;关联资源对象&quot;</span>, obj, <span class="keyword">typeof</span>(GameObject), <span class="literal">false</span>) <span class="keyword">as</span> GameObject;</span><br><span class="line">    <span class="comment">//各类型输入</span></span><br><span class="line">    i = EditorGUILayout.IntField(<span class="string">&quot;Int输入框&quot;</span>, i);</span><br><span class="line">    EditorGUILayout.LabelField(i.ToString());</span><br><span class="line">    l = EditorGUILayout.LongField(<span class="string">&quot;long输入框&quot;</span>, l);</span><br><span class="line">    f = EditorGUILayout.FloatField(<span class="string">&quot;Float 输入：&quot;</span>, f);</span><br><span class="line">    d = EditorGUILayout.DoubleField(<span class="string">&quot;double 输入：&quot;</span>, d);</span><br><span class="line"></span><br><span class="line">    str = EditorGUILayout.TextField(<span class="string">&quot;Text输入：&quot;</span>, str);</span><br><span class="line">    vec2 = EditorGUILayout.Vector2Field(<span class="string">&quot;Vec2输入： &quot;</span>, vec2);</span><br><span class="line">    vec3 = EditorGUILayout.Vector3Field(<span class="string">&quot;Vec3输入： &quot;</span>, vec3);</span><br><span class="line">    vec4 = EditorGUILayout.Vector4Field(<span class="string">&quot;Vec4输入： &quot;</span>, vec4);</span><br><span class="line"></span><br><span class="line">    rect = EditorGUILayout.RectField(<span class="string">&quot;rect输入： &quot;</span>, rect);<span class="comment">//矩形变量</span></span><br><span class="line">    bounds = EditorGUILayout.BoundsField(<span class="string">&quot;Bounds输入： &quot;</span>, bounds);<span class="comment">//范围变量</span></span><br><span class="line">    boundsInt = EditorGUILayout.BoundsIntField(<span class="string">&quot;Bounds输入： &quot;</span>, boundsInt);<span class="comment">//范围变量（整型）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//注意：EditorGUILayout中还有一些Delayed开头的输入控件</span></span><br><span class="line">    <span class="comment">//     他们和普通输入控件最主要的区别是：在用户按 Enter 键或将焦点从字段移开之前，返回值不会更改</span></span><br><span class="line">    i2 = EditorGUILayout.DelayedIntField(<span class="string">&quot;Int输入框&quot;</span>, i2);</span><br><span class="line">    EditorGUILayout.LabelField(i2.ToString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">EditorGUILayout.EndFoldoutHeaderGroup();</span><br></pre></td></tr></table></figure><h2 id="5.3-%E6%8A%98%E5%8F%A0%E5%92%8C%E6%8A%98%E5%8F%A0%E7%BB%84%E7%9A%84%E5%8C%BA%E5%88%AB" tabindex="-1">5.3 折叠和折叠组的区别</h2><p>折叠组的文本会加粗高亮，并且默认点击整行也会交互展开，主要是表现上的区别。具体看下面效果图</p><h2 id="5.4-%E6%95%88%E6%9E%9C" tabindex="-1">5.4 效果</h2><p><img src="/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/L7%E6%8A%98%E5%8F%A0%E3%80%81%E6%8A%98%E5%8F%A0%E7%BB%84.png" alt></p><h1 id="%E5%85%AD%E3%80%81%E5%BC%80%E5%85%B3%E3%80%81%E5%BC%80%E5%85%B3%E7%BB%84%E6%8E%A7%E4%BB%B6" tabindex="-1">六、开关、开关组控件</h1><h2 id="6.1-%E5%BC%80%E5%85%B3%E6%8E%A7%E4%BB%B6" tabindex="-1">6.1 开关控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span>变量 = EditorGUILayout.Toggle(<span class="string">&quot;普通开关&quot;</span>, <span class="built_in">bool</span>变量);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span>变量 = EditorGUILayout.ToggleLeft(<span class="string">&quot;开关在左侧&quot;</span>, <span class="built_in">bool</span>变量);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例<br>下面与开关组一起写了</li></ol><h2 id="6.2-%E5%BC%80%E5%85%B3%E7%BB%84%E6%8E%A7%E4%BB%B6" tabindex="-1">6.2 开关组控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span>变量 = EditorGUILayout.BeginToggleGroup(<span class="string">&quot;开关组&quot;</span>, <span class="built_in">bool</span>变量);</span><br><span class="line"><span class="comment">//其他控件绘制(包裹起来)</span></span><br><span class="line">EditorGUILayout.EndToggleGroup();</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//开关组控件</span></span><br><span class="line">isTogGroup = EditorGUILayout.BeginToggleGroup(<span class="string">&quot;开关组控件&quot;</span>, isTogGroup);</span><br><span class="line"><span class="comment">//开关控件</span></span><br><span class="line">isTog = EditorGUILayout.Toggle(<span class="string">&quot;开关控件&quot;</span>, isTog);</span><br><span class="line">isTogLeft = EditorGUILayout.ToggleLeft(<span class="string">&quot;左侧开关&quot;</span>, isTogLeft);</span><br><span class="line">EditorGUILayout.EndToggleGroup();</span><br></pre></td></tr></table></figure><h2 id="6.3-%E6%95%88%E6%9E%9C" tabindex="-1">6.3 效果</h2><p><img src="/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/L8%E5%BC%80%E5%85%B3%E3%80%81%E5%BC%80%E5%85%B3%E7%BB%84.png" alt></p><h1 id="%E4%B8%83%E3%80%81-%E6%BB%91%E5%8A%A8%E6%9D%A1%E3%80%81%E5%8F%8C%E5%9D%97%E6%BB%91%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6" tabindex="-1">七、 滑动条、双块滑动条控件</h1><h2 id="7.1-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%B8%80-%E6%BB%91%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6" tabindex="-1">7.1 知识点一 滑动条控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">float</span>变量 = EditorGUILayout.Slider(<span class="string">&quot;滑动条&quot;</span>, <span class="built_in">float</span>变量, 最小值, 最大值);</span><br><span class="line"><span class="built_in">int</span>变量 = EditorGUILayout.IntSlider(<span class="string">&quot;整数值滑动条&quot;</span>, <span class="built_in">int</span>变量, 最小值, 最大值);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//滑动条</span></span><br><span class="line">fSlider = EditorGUILayout.Slider(<span class="string">&quot;滑动条&quot;</span>, fSlider, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">iSlider = EditorGUILayout.IntSlider(<span class="string">&quot;整形滑动条&quot;</span>, iSlider, <span class="number">0</span>, <span class="number">10</span>);</span><br></pre></td></tr></table></figure><h2 id="7.2-%E7%9F%A5%E8%AF%86%E7%82%B9%E4%BA%8C-%E5%8F%8C%E5%9D%97%E6%BB%91%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6" tabindex="-1">7.2 知识点二 双块滑动条控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EditorGUILayout.MinMaxSlider(<span class="string">&quot;双块滑动条&quot;</span>, <span class="keyword">ref</span> 左侧值, <span class="keyword">ref</span> 右侧值, 最小值, 最大值);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//双块滑动条</span></span><br><span class="line">EditorGUILayout.MinMaxSlider(<span class="string">&quot;双块滑动条&quot;</span>, <span class="keyword">ref</span> leftV, <span class="keyword">ref</span> rightV, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">EditorGUILayout.LabelField(leftV.ToString());</span><br><span class="line">EditorGUILayout.LabelField(rightV.ToString());</span><br></pre></td></tr></table></figure><h2 id="7.3-%E6%95%88%E6%9E%9C" tabindex="-1">7.3 效果</h2><p><img src="/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/L9%E6%BB%91%E5%8A%A8%E6%9D%A1%E3%80%81%E5%8F%8C%E5%9D%97%E6%BB%91%E5%8A%A8%E6%9D%A1%E6%8E%A7%E4%BB%B6.png" alt></p><h1 id="%E5%85%AB%E3%80%81%E5%B8%AE%E5%8A%A9%E6%A1%86%E3%80%81%E5%9E%82%E7%9B%B4%E9%97%B4%E9%9A%94-%E6%8E%A7%E4%BB%B6" tabindex="-1">八、帮助框、垂直间隔 控件</h1><h2 id="8.1-%E5%B8%AE%E5%8A%A9%E6%A1%86%E6%8E%A7%E4%BB%B6" tabindex="-1">8.1 帮助框控件</h2><ol><li>方法及示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EditorGUILayout.HelpBox(<span class="string">&quot;一般提示&quot;</span>, MessageType.None);</span><br><span class="line">EditorGUILayout.HelpBox(<span class="string">&quot;感叹号提示&quot;</span>, MessageType.Info);</span><br><span class="line">EditorGUILayout.HelpBox(<span class="string">&quot;警告符号提示&quot;</span>, MessageType.Warning);</span><br><span class="line">EditorGUILayout.HelpBox(<span class="string">&quot;错误符号提示&quot;</span>, MessageType.Error);</span><br></pre></td></tr></table></figure><h2 id="8.2-%E9%97%B4%E9%9A%94%E6%8E%A7%E4%BB%B6" tabindex="-1">8.2  间隔控件</h2><ol><li>方法及示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//控件1</span></span><br><span class="line">EditorGUILayout.Space(<span class="number">10</span>); <span class="comment">//进行10个单位的间隔</span></span><br><span class="line"><span class="comment">//控件2</span></span><br></pre></td></tr></table></figure><h2 id="8.3-%E6%95%88%E6%9E%9C" tabindex="-1">8.3 效果</h2><p><img src="/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/L10%E5%B8%AE%E5%8A%A9%E6%A1%86%E3%80%81%E9%97%B4%E9%9A%94%E6%8E%A7%E4%BB%B6.png" alt></p><h1 id="%E4%B9%9D%E3%80%81%E5%8A%A8%E7%94%BB%E6%9B%B2%E7%BA%BF%E6%8E%A7%E4%BB%B6%E5%92%8C%E5%B8%83%E5%B1%80api" tabindex="-1">九、动画曲线控件和布局API</h1><h2 id="9.1-%E5%8A%A8%E7%94%BB%E6%9B%B2%E7%BA%BF%E6%8E%A7%E4%BB%B6" tabindex="-1">9.1 动画曲线控件</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AnimationCurve变量  = EditorGUILayout.CurveField(<span class="string">&quot;动画曲线：&quot;</span>, AnimationCurve变量);</span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AnimationCurve curve = <span class="keyword">new</span> AnimationCurve();</span><br><span class="line"><span class="comment">//动画曲线控件</span></span><br><span class="line">curve = EditorGUILayout.CurveField(<span class="string">&quot;曲线控件&quot;</span>, curve);</span><br></pre></td></tr></table></figure><h2 id="9.2-%E5%B8%83%E5%B1%80%E7%9B%B8%E5%85%B3api" tabindex="-1">9.2 布局相关API</h2><ol><li>方法</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">EditorGUILayout.BeginHorizontal(); <span class="comment">//开始水平布局</span></span><br><span class="line"><span class="comment">//一大堆控件</span></span><br><span class="line">EditorGUILayout.EndHorizontal();<span class="comment">//结束水平布局</span></span><br><span class="line"></span><br><span class="line">EditorGUILayout.BeginVertical();<span class="comment">//开始垂直布局</span></span><br><span class="line"><span class="comment">//一大堆控件</span></span><br><span class="line">EditorGUILayout.EndVertical();<span class="comment">//结束垂直布局</span></span><br><span class="line"></span><br><span class="line">Vector2布局 = EditorGUILayout.BeginScrollView(Vector2布局); <span class="comment">//开启滚动视图</span></span><br><span class="line"><span class="comment">//一大堆控件</span></span><br><span class="line">EditorGUILayout.EndScrollView(); <span class="comment">//结束滚动视图</span></span><br></pre></td></tr></table></figure><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Vector2 vec2Pos;</span><br><span class="line"><span class="comment">//布局API</span></span><br><span class="line">EditorGUILayout.BeginHorizontal(); <span class="comment">//开始水平布局</span></span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;123123&quot;</span>);</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;123123&quot;</span>);</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;123123&quot;</span>);</span><br><span class="line">EditorGUILayout.EndHorizontal();<span class="comment">//结束水平布局</span></span><br><span class="line"></span><br><span class="line">EditorGUILayout.BeginVertical();<span class="comment">//开始垂直布局</span></span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;123123&quot;</span>);</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;123123&quot;</span>);</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;123123&quot;</span>);</span><br><span class="line">EditorGUILayout.EndVertical();<span class="comment">//结束垂直布局</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vec2Pos = EditorGUILayout.BeginScrollView(vec2Pos); <span class="comment">//开启滚动视图</span></span><br><span class="line"><span class="comment">//一大堆控件</span></span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;滚动1&quot;</span>);</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;滚动2&quot;</span>);</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;滚动3&quot;</span>);</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;滚动4&quot;</span>);</span><br><span class="line">EditorGUILayout.LabelField(<span class="string">&quot;滚动5&quot;</span>);</span><br><span class="line">EditorGUILayout.EndScrollView(); <span class="comment">//结束滚动视图</span></span><br></pre></td></tr></table></figure><h2 id="9.3-%E6%95%88%E6%9E%9C" tabindex="-1">9.3 效果</h2><p><img src="/2025/03/04/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%89-EditorGUI%E7%9B%B8%E5%85%B3/L11%E5%8A%A8%E7%94%BB%E6%9B%B2%E7%BA%BF%E6%8E%A7%E4%BB%B6%E5%92%8C%E5%B8%83%E5%B1%80API.png" alt></p><h1 id="%E5%8D%81%E3%80%81%E6%80%BB%E7%BB%93" tabindex="-1">十、总结</h1><p>EditorGUILayout中更多内容：<a href="https://docs.unity.cn/cn/2022.3/ScriptReference/EditorGUILayout.html">https://docs.unity.cn/cn/2022.3/ScriptReference/EditorGUILayout.html</a></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;EditorGUI相关的内容&lt;/p&gt;</summary>
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity编辑器拓展" scheme="http://example.com/tags/Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95/"/>
    
  </entry>
  
  <entry>
    <title>Unity编辑器拓展（二）-自定义窗口拓展</title>
    <link href="http://example.com/2025/02/25/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%BA%8C-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/"/>
    <id>http://example.com/2025/02/25/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%BA%8C-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/</id>
    <published>2025-02-25T13:25:49.000Z</published>
    <updated>2025-03-31T15:03:41.511Z</updated>
    
    <content type="html"><![CDATA[<p>Unity编辑器拓展（二）-自定义窗口拓展学习</p><span id="more"></span><h2 id="%E4%B8%80%E3%80%81%E5%88%9B%E5%BB%BA%E7%AA%97%E5%8F%A3%E7%B1%BB" tabindex="-1">一、创建窗口类</h2><ol><li><p>命名空间：UnityEditor</p></li><li><p>继承类名：EditorWindow</p></li><li><p>方法：</p></li></ol><ul><li>当我们想要为Unity拓展一个自定义窗口时</li><li>我们只需要实现一个继承了EditorWindow的类即可</li><li>并且在该类的OnGUI函数中编写面板控件相关的逻辑</li></ul><ol start="4"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson2</span> : <span class="title">EditorWindow</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnGUI</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        GUILayout.Label(<span class="string">&quot;测试文本&quot;</span>); <span class="comment">//绘制文本</span></span><br><span class="line">        <span class="keyword">if</span>(GUILayout.Button(<span class="string">&quot;测试按钮&quot;</span>)) <span class="comment">//绘制点击按钮</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(<span class="string">&quot;Test&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="%E4%BA%8C%E3%80%81%E6%98%BE%E7%A4%BA%E7%AA%97%E5%8F%A3" tabindex="-1">二、显示窗口</h2><ol><li><p>用自定义菜单栏拓展的方式，添加一个自定义页签用于开启窗口<br>调用EditorWindow.GetWindow</p></li><li><p>EditorWindow.GetWindow方法有很多种重载，其中的主要参数一般有</p></li></ol><ul><li>Type或T：窗口类的类型</li><li>utility：为 true 可创建浮动实用程序窗口，设置为 false 可创建正常窗口。所谓浮动窗口就是可以自由拖动自由改变大小</li><li>title：窗口标题</li><li>focus：是否为窗口提供焦点（如果已存在）。（如果 GetWindow 创建新窗口，则将始终获得焦点）</li><li>desiredDockNextTo:窗口试图停靠到其上的 EditorWindow 类型的数组</li></ul><ol start="3"><li><p>创建窗口对象<br>之后调用对象的Show方法即可显示窗口</p></li><li><p>代码</p></li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">MenuItem(<span class="string">&quot;Unity编辑器拓展/Lesson2/显示自定义面板&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ShowWindow</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Lesson2 win = EditorWindow.GetWindow&lt;Lesson2&gt;(); <span class="comment">//获取窗口（唯一窗口），如果希望有多个窗口的话使用EditorWindow.CreateWindow&lt;Lesson2&gt;();</span></span><br><span class="line">    win.titleContent = <span class="keyword">new</span> GUIContent(<span class="string">&quot;我的窗口&quot;</span>); <span class="comment">//创建窗口</span></span><br><span class="line">    win.Show(); <span class="comment">//显示窗口</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="5"><li>效果（与1点的代码同时）<br><img src="/2025/02/25/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%BA%8C-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%AA%97%E5%8F%A3%E6%8B%93%E5%B1%95/2.%20%E6%98%BE%E7%A4%BA%E7%AA%97%E5%8F%A3.png" alt></li></ol><h2 id="%E4%B8%89%E3%80%81%E7%AA%97%E5%8F%A3%E4%BA%8B%E4%BB%B6%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0" tabindex="-1">三、窗口事件回调函数</h2><ol><li>继承EditorWindow的窗口类 自带一些事件回调函数，当触发对应事件时会自动进入</li></ol><ul><li>(1) OnHierarchyChange():当场景中的层次结构（Hierarchy）发生变化时调用。<ul><li>例如，当游戏对象被创建、删除或重命名时触发。</li></ul></li><li>(2) OnFocus():当窗口获得焦点时调用。<ul><li>在这个方法中，你可以执行一些在窗口获得焦点时需要进行的操作。</li></ul></li><li>(3) OnLostFocus():当窗口失去焦点时调用。<ul><li>通常在这个方法中执行一些在窗口失去焦点时需要进行的清理工作。</li></ul></li><li>(4) OnProjectChange():当项目资源发生变化时调用。<ul><li>例如，当添加、删除或修改项目中的文件时触发。</li></ul></li><li>(5) OnInspectorUpdate():在检视器（Inspector）面板更新时调用。<ul><li>可以在这个方法中执行需要在检视器面板刷新时进行的逻辑，比如更新显示的信息</li></ul></li><li>(6) OnSelectionChange():当选择的对象发生变化时调用。<ul><li>在这个方法中，你可以执行与所选对象相关的操作，以确保编辑器窗口的内容与当前选择保持同步。</li></ul></li></ul><ol start="2"><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnHierarchyChange</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;当Hierarchy窗口内容发生变化时&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnFocus</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;获取焦点&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnLostFocus</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;失去焦点&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnProjectChange</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;当Project窗口内容发生变化时&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnInspectorUpdate</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;当Inspector窗口内容发生变化时&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnSelectionChange</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;当选中对象发生变化时&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="%E5%9B%9B%E3%80%81%E7%AA%97%E5%8F%A3%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0" tabindex="-1">四、窗口中常用的生命周期函数</h2><ol><li>OnEnable():<ul><li>当窗口被激活时调用，通常在窗口创建时会调用一次。</li><li>在这个方法中，你可以进行一些初始化工作，例如注册事件监听器或设置初始变量。</li></ul></li><li>OnGUI():<ul><li>每帧都会调用此方法，用于绘制编辑器窗口的 GUI。</li><li>在这个方法中，你可以使用 GUILayout 或 EditorGUILayout 等类创建界面元素，以便用户与窗口进行交互。</li></ul></li><li>OnDestroy():<ul><li>当窗口被销毁时调用，通常在关闭编辑器或切换场景时触发。在这里进行最终的清理工作，确保没有未释放的资源。</li></ul></li><li>Update():<ul><li>在编辑器窗口每帧更新时调用。通常在这里执行一些需要在每帧进行的逻辑</li></ul></li></ol><h2 id="%E4%BA%94%E3%80%81%E7%BC%96%E8%BE%91%E5%99%A8%E7%AA%97%E5%8F%A3%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%B8%B8%E7%94%A8%E6%88%90%E5%91%98" tabindex="-1">五、编辑器窗口类中的常用成员</h2><p>Unity官方文档有关于编辑器窗口类的API说明<br><a href="https://docs.unity.cn/cn/2022.3/ScriptReference/EditorWindow.html">https://docs.unity.cn/cn/2022.3/ScriptReference/EditorWindow.html</a></p><ol><li><p>静态变量</p><ul><li>(1) focusedWindow：当前已获得键盘焦点的 EditorWindow。（只读）</li><li>(2) mouseOverWindow：当前在鼠标光标下的 EditorWindow。（只读）</li></ul></li><li><p>静态函数</p></li></ol><ul><li>(1) CreateWindow: 创建窗口，如果允许一个窗口有多个可以用该API创建窗口</li><li>(2) GetWindow: 通过它我们可以创建一个窗口对象</li><li>(3) GetWindowWithRect：返回一个指定位置、大小的窗口</li><li>(4) HasOpenInstances：检查编辑器窗口是否打开</li></ul><ol start="3"><li>成员变量</li></ol><ul><li>(1) titleContent：窗口标题名</li><li>(2) positon：窗口位置大小信息</li><li>(3) wantsMouseEnterLeaveWindow:如果设置为 true，则每当鼠标进入或离开窗口时，该窗口都会收到一次 OnGUI 调用</li></ul><ol start="4"><li>成员函数</li></ol><ul><li>(1) Show: 显示面板</li><li>(2) Repaint：重绘窗口</li><li>(3) Close: 关闭窗口</li></ul><h2 id="%E5%85%AD%E3%80%81%E6%80%BB%E7%BB%93" tabindex="-1">六、总结</h2><p>编辑器拓展中想要实现自定义窗口</p><ol><li>只需要继承EditorWindow类</li><li>主要在OnGUI中利用GUI相关API绘制控件处理功能逻辑</li><li>对应的事件回调函数，可以帮助我们监听到一些特殊情况用于处理对应逻辑</li></ol><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;Unity编辑器拓展（二）-自定义窗口拓展学习&lt;/p&gt;</summary>
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity编辑器拓展" scheme="http://example.com/tags/Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95/"/>
    
  </entry>
  
  <entry>
    <title>3D数学基础-图形和游戏开发-学习笔记 第五章 矩阵和线性变换</title>
    <link href="http://example.com/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/"/>
    <id>http://example.com/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/</id>
    <published>2025-02-17T03:37:26.000Z</published>
    <updated>2025-03-30T14:49:55.581Z</updated>
    
    <content type="html"><![CDATA[<p>本章讨论使用3x3矩阵再三位中表达线性变换（旋转、比例缩放、正交投影、反射和错切）</p><span id="more"></span><p>本章分为两大部分</p><ul><li>第一部分包括 第5.1节~5.5节，采用前面章节中介绍的基本工具来推导旋转、比例缩放、正交投影、反射和错切的原始线性变换的矩阵。</li><li>第二部分回到变换的一般性原则。<ul><li>第5.6节展示 如何通过使用矩阵乘法来组合原始变换序列以形成更复杂的变换</li><li>第5.7节讨论各种有趣的变换类型。 线性、方式、可逆、角度保持、正交和刚体变换</li></ul></li></ul><h1 id="5.1-%E6%97%8B%E8%BD%AC" tabindex="-1">5.1 旋转</h1><h2 id="5.1.1-%E5%9C%A8%E4%BA%8C%E7%BB%B4%E4%B8%AD%E7%9A%84%E6%97%8B%E8%BD%AC" tabindex="-1">5.1.1 在二维中的旋转</h2><ol><li>二维中旋转，只能进行<strong>绕点旋转</strong>，具有一个参数，即角度<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq>，定义旋转量。大多数书籍的标准惯例都是<strong>逆时针旋转正向和顺时针旋转负向</strong>。</li><li>下图显示了基矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9084em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></eq>和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>q</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9084em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></eq>如何围绕原点旋转，从而产生新的矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{p&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1553em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9609em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2469em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></eq>和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msup><mi>q</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{q&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1553em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9609em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2469em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></eq>。<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.1.1%20%E5%9C%A8%E4%BA%8C%E7%BB%B4%E4%B8%AD%E5%9B%B4%E7%BB%95%E5%8E%9F%E7%82%B9%E6%97%8B%E8%BD%AC.png" alt></li><li>知道旋转后基矢量的值后，构建一下矩阵<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.1.1%20%E4%BA%8C%E7%BB%B4%E6%97%8B%E8%BD%AC%E7%9F%A9%E9%98%B5.png" alt></li></ol><h2 id="5.1.2-%E5%9B%B4%E7%BB%95%E4%B8%BB%E8%BD%B4%E7%9A%84%E4%B8%89%E7%BB%B4%E6%97%8B%E8%BD%AC" tabindex="-1">5.1.2 围绕主轴的三维旋转</h2><ol><li><p>三维中，旋转发生在一个轴，而不是一个点上，即<strong>绕轴旋转</strong>。旋转轴不一定必须是基本的<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mtext>、</mtext><mi>y</mi><mtext>、</mtext><mi>z</mi></mrow><annotation encoding="application/x-tex">x、y、z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">x</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></eq>轴之一。本文旋转方向的正负标准遵循左手规则（可看第一章的1.3.3节）</p></li><li><p>围绕x轴的旋转，从旋转的基矢量构造矩阵，可得<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.1.2%20%E5%9B%B4%E7%BB%95x%E8%BD%B4%E7%9A%84%E4%B8%89%E7%BB%B4%E6%97%8B%E8%BD%AC.png" alt></p></li><li><p>围绕y轴的旋转矩阵<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.1.2%20%E5%9B%B4%E7%BB%95y%E8%BD%B4%E7%9A%84%E4%B8%89%E7%BB%B4%E6%97%8B%E8%BD%AC.png" alt></p></li><li><p>围绕z轴的旋转矩阵<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.1.2%20%E5%9B%B4%E7%BB%95z%E8%BD%B4%E7%9A%84%E4%B8%89%E7%BB%B4%E6%97%8B%E8%BD%AC.png" alt></p></li><li><p>三维中围绕x、y、z轴旋转<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.1.2%20%E4%B8%89%E7%BB%B4%E4%B8%AD%E5%9B%B4%E7%BB%95x%E8%BD%B4%E7%9A%84%E4%B8%89%E7%BB%B4%E6%97%8B%E8%BD%AC.png" alt><br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.1.2%20%E4%B8%89%E7%BB%B4%E4%B8%AD%E5%9B%B4%E7%BB%95y%E8%BD%B4%E7%9A%84%E4%B8%89%E7%BB%B4%E6%97%8B%E8%BD%AC.png" alt><br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.1.2%20%E4%B8%89%E7%BB%B4%E4%B8%AD%E5%9B%B4%E7%BB%95z%E8%BD%B4%E7%9A%84%E4%B8%89%E7%BB%B4%E6%97%8B%E8%BD%AC.png" alt></p></li><li><p>虽然定义正负向使用的是左手规则，但矩阵在左手或右手坐标系中均可正常使用。</p></li></ol><h2 id="5.1.3-%E5%9B%B4%E7%BB%95%E4%BB%BB%E6%84%8F%E8%BD%B4%E7%9A%84%E4%B8%89%E7%BB%B4%E6%97%8B%E8%BD%AC" tabindex="-1">5.1.3 围绕任意轴的三维旋转</h2><p>在三维中可以围绕任意轴进行旋转，但前提是该轴需要穿过原点，因为此刻不考虑平移。下面将将<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq>定义为绕轴的旋转量，轴将由单位矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>定义。<br>下面推导出一个围绕<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>旋转角度<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq>的矩阵，即推导出<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bold{R}(\bold{\widehat{n}},\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf">R</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></eq>，是的当将矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>v</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>乘以<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bold{R}(\bold{\widehat{n}},\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf">R</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></eq>时，得到的矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msup><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{v&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9609em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9609em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2469em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>是将<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></eq>围绕<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>旋转角度<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq>的以下结果：<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><msup><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>⃗</mo></mover><mo>=</mo><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mi mathvariant="bold">R</mi><mo stretchy="false">(</mo><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\vec{v&#x27;}=\vec{v}\bold{R}(\bold{\widehat{n}},\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9609em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9609em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span style="top:-3.2469em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mord mathbf">R</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span></eqn></section>。<br>推导过程较为繁琐，这里直接的出结论，<strong>围绕任意轴旋转的三维矩阵：</strong><br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.1.3%20%E5%9B%B4%E7%BB%95%E4%BB%BB%E6%84%8F%E8%BD%B4%E6%97%8B%E8%BD%AC%E7%9A%84%E4%B8%89%E7%BB%B4%E7%9F%A9%E9%98%B5.png" alt></p><h1 id="5.2-%E7%BC%A9%E6%94%BE" tabindex="-1">5.2 缩放</h1><p>缩放一个对象,使其按比例增大或减小一个k的因子。如果将这个比例应用于整个对象,则可以基于原点&quot;扩展&quot;对象。</p><ol><li>我们要执行的是均匀缩放(UniformScale)，即保留角度和比例:长度统一增加或减少一个 <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></eq> 的因子；面积增加或减小一个 <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">k^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></eq> 的因子；体积(在三维中)增加或减少一个 <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>k</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">k^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></eq> 的因子子。</li><li>如果希望&quot;拉伸&quot;或&quot;挤压&quot;对象，则可以在不同的方向上应用不同的比例因子，这样会导致不均匀缩放(NonuniformScale)。不均匀缩放将不会保留角度；而长度、面积和体积等则会根据相对于比例方向而发生变化的因子来进行调整。具体如下:<ul><li><strong>如果|k|&lt;1，则对象在那个方向会变得“更短”。</strong></li><li><strong>如果|k|&gt;1，则对象在那个方向会变得“更长”。</strong></li><li><strong>如果k=0，那么将获得一个正交投影(Orthographic Projection)</strong>，这在第5.3节中将会讨论。</li><li><strong>如果k&lt;0，那么将获得一个反射的结果</strong>，这在第5.4节中将会涉及。</li><li><strong>在本节的其余部分中,假设k&gt;0</strong>。</li></ul></li></ol><h2 id="5.2.1-%E6%B2%BF%E4%B8%BB%E8%BD%B4%E7%BC%A9%E6%94%BE" tabindex="-1">5.2.1 沿主轴缩放</h2><p>最简单的缩放操作是沿每个轴线应用单独的比例因子。沿着轴的缩放将围绕垂直轴(在二维中)或平面(在三维中)应用。<strong>如果所有轴的比例因子相等，则执行的是均匀缩放;否则它就是不均匀缩放。</strong></p><ol><li>在二维中,有两个比例因子：<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">k_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">k_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq>。下图显示了使用<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">k_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">k_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq>的各种不同比例因子缩放的一个二维对象。<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.2.1%20%E4%BD%BF%E7%94%A8kx%E5%92%8Cky%E7%9A%84%E5%90%84%E7%A7%8D%E4%B8%8D%E5%90%8C%E6%AF%94%E4%BE%8B%E5%9B%A0%E5%AD%90%E7%BC%A9%E6%94%BE%E4%B8%80%E4%B8%AA%E4%BA%8C%E7%BB%B4%E5%AF%B9%E8%B1%A1.png" alt></li><li>从直观上看,基矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>p</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9084em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">p</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></eq>和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>q</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9084em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></eq>独立地受相应比例因子的影响,具体如下:<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.2.1%20%E5%9F%BA%E7%9F%A2%E9%87%8F%E5%8F%97%E5%88%B0%E5%BD%B1%E5%93%8D%E7%9A%84%E5%85%AC%E5%BC%8F.png" alt></li><li>从这些基矢量构造二维缩放矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">S</mi><mo stretchy="false">(</mo><msub><mi>k</mi><mi>x</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>y</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bold{S}(k_x,k_y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathbf">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></eq>,可得<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.2.1%20%E5%9B%B4%E7%BB%95%E4%B8%BB%E8%BD%B4%E7%BC%A9%E6%94%BE%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%9F%A9%E9%98%B5.png" alt></li><li>对于三维来说,可以添加第三个比例因子<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>z</mi></msub></mrow><annotation encoding="application/x-tex">k_z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>,然后按下式给出三维缩放矩阵：<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.2.1%20%E5%9B%B4%E7%BB%95%E4%B8%BB%E8%BD%B4%E7%BC%A9%E6%94%BE%E7%9A%84%E4%B8%89%E7%BB%B4%E7%9F%A9%E9%98%B5.png" alt></li><li>如果将任意矢量乘以上述三维矩阵，那么，正如预期的那样，每个分量都将按适当的比例因子进行缩放，具体如下：<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.2.1%20%E5%9B%B4%E7%BB%95%E4%B8%BB%E8%BD%B4%E7%BC%A9%E6%94%BE%E4%B8%89%E7%BB%B4%E7%9A%84%E5%88%86%E9%87%8F%E8%A1%A8%E7%A4%BA.png" alt></li></ol><h2 id="5.2.2-%E4%BB%BB%E6%84%8F%E6%96%B9%E5%90%91%E7%9A%84%E7%BC%A9%E6%94%BE" tabindex="-1">5.2.2 任意方向的缩放</h2><ol><li><p>可以应用独立于坐标系统的缩放，方法是在任意方向上缩放。将<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>定义为平行于缩放方向的单位矢量,并且<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></eq>是要应用于通过原点并垂直于<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>的线(在二维中)或平<br>面(在三维中)的比例因子。<strong>缩放是沿着<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>执行,而不是围绕<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq></strong></p></li><li><p>为了推导出一个沿任意轴缩放的矩阵，使用类似于第5.1.3节中用于围绕任意轴旋转的方法。如图所示<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.2.2%20%E6%B2%BF%E4%BB%BB%E6%84%8F%E6%96%B9%E5%90%91%E7%BC%A9%E6%94%BE%E7%9F%A2%E9%87%8F.png" alt></p></li><li><p>推导过程较为繁琐，这里直接的出结论。得到一个二维矩阵，该矩阵将在由单位矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>指定的任意方向上按<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></eq>的因子缩放。<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.2.2%20%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%B9%E5%90%91%E4%B8%8A%E7%BC%A9%E6%94%BE%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%9F%A9%E9%98%B5.png" alt></p></li><li><p>根据二维矩阵进一步得到三维矩阵，该矩阵也将在由单位矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>指定的任意方向上按<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></eq>的因子缩放：<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.2.2%20%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%B9%E5%90%91%E4%B8%8A%E7%BC%A9%E6%94%BE%E7%9A%84%E4%B8%89%E7%BB%B4%E7%9F%A9%E9%98%B5.png" alt></p></li></ol><h1 id="5.3-%E6%AD%A3%E4%BA%A4%E6%8A%95%E5%BD%B1" tabindex="-1">5.3 正交投影</h1><p>一般来说，术语投影(Projection)<strong>指的是任何降维操作</strong>。正如在第5.2节中讨论的那样，我们可以实现投影的一种方法是在一个方向上使用零比例因子。在这种情况下，<strong>所有点都被扁平化或投影到垂直轴</strong>(在二维中)<strong>或平面</strong>(在三维中)<strong>上</strong>。这种类型的投影是<strong>正交投影</strong>(Orthographic Projection)，也称为<strong>平行投影</strong>(Parallel Projection)，因为从原始点到其投影对应物的线是平行的。在<strong>第6.5节</strong>中还将介个绍另一种投影,即<strong>透视投影</strong>(Perspective Projection)。</p><h2 id="5.3.1-%E6%8A%95%E5%BD%B1%E5%88%B0%E4%B8%BB%E8%BD%B4%E6%88%96%E4%B8%BB%E5%B9%B3%E9%9D%A2%E4%B8%8A" tabindex="-1">5.3.1 投影到主轴或主平面上</h2><ol><li>当将三维对象投影到主轴(在二维中)或主平面(在三维中)上时,会发生最简单<br>的投影。下图显示了关于将三维对象投影到主平面上的结果。<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.3.1%20%E5%B0%86%E4%B8%89%E7%BB%B4%E5%AF%B9%E8%B1%A1%E6%8A%95%E5%BD%B1%E5%88%B0%E4%B8%BB%E5%B9%B3%E9%9D%A2%E4%B8%8A.png" alt></li><li>在主轴或平面上的投影往往不是通过实际变换发生的，而是通过<strong>简单地丢弃其中一个坐标</strong>，同时将数据指定给较小维度的变量而进行的。例如，<strong>我们可以通过丢弃点的<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></eq>分量并仅复制<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq>和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq>来将三维对象转换为二维对象</strong>。</li><li>但是,我们也可以通过在垂直轴上使用零刻度值投影到主轴或主平面上。为完整起见,下面提出了这些变换的矩阵。</li></ol><ul><li>投影到主轴（<strong>在二维中</strong>）上的矩阵如下：<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.3.1%20%E6%8A%95%E5%BD%B1%E5%88%B0%E4%B8%BB%E8%BD%B4%E4%B8%8A(%E5%9C%A8%E4%BA%8C%E7%BB%B4%E4%B8%AD).png" alt></li><li>投影到主平面（<strong>在三维中</strong>）上的矩阵如下：<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.3.1%20%E6%8A%95%E5%BD%B1%E5%88%B0%E4%B8%BB%E5%B9%B3%E9%9D%A2(%E5%9C%A8%E4%B8%89%E7%BB%B4%E4%B8%AD).png" alt></li></ul><h2 id="5.3.2-%E6%8A%95%E5%BD%B1%E5%88%B0%E4%BB%BB%E6%84%8F%E7%BA%BF%E6%88%96%E5%B9%B3%E9%9D%A2%E4%B8%8A" tabindex="-1">5.3.2 投影到任意线或平面上</h2><p>我们还可以投影到任意线(在二维中)或平面(在三维中)上。和以前一样,<strong>由于不考虑平移</strong> ,因此<strong>线或平面必须通过原点</strong>。投影将由垂直于线或平面的单位矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>定义。</p><ol><li>我们可以使用在第5.2.2节中开发的公式,通过沿此方向应用零比例因子,推导出以任意方向投影的矩阵。在二维中,我们有<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.3.2%20%E6%8A%95%E5%BD%B1%E5%88%B0%E4%BB%BB%E6%84%8F%E7%BA%BF%E4%B8%8A%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%9F%A9%E9%98%B5.png" alt></li><li>请记住, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>垂直于正在投影的线,而不是与之平行的。在三维中,投影到垂直于<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>的平面上,具体如下:<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.3.2%20%E6%8A%95%E5%BD%B1%E5%88%B0%E4%BB%BB%E6%84%8F%E7%BA%BF%E4%B8%8A%E7%9A%84%E4%B8%89%E7%BB%B4%E7%9F%A9%E9%98%B5.png" alt></li></ol><h1 id="5.4-%E5%8F%8D%E5%B0%84" tabindex="-1">5.4 反射</h1><p>反射(Reflection)也称为镜像(Mirroring)，是一种围绕直线(在三维中)或平面(在三维中)&quot;翻转&quot;对象的变换。下图显示了分别围绕二维中的<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq>轴和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq>轴反射对象的结果。<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.4%20%E5%9B%B4%E7%BB%95%E4%BA%8C%E7%BB%B4%E4%B8%AD%E7%9A%84%E8%BD%B4%E5%8F%8D%E5%B0%84%E5%AF%B9%E8%B1%A1.png" alt></p><ol><li>可以通过应用-1的比例因子来完成反射。设<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>是二维单位矢量。然后,由下式给出围绕穿过原点并垂直于<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi mathvariant="bold">n</mi><mo stretchy="true">^</mo></mover></mrow><annotation encoding="application/x-tex">\bold{\widehat{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6844em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6844em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">n</span></span><span class="svg-align" style="top:-3.4444em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.24em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.24em" viewbox="0 0 1062 239" preserveaspectratio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"/></svg></span></span></span></span></span></span></span></span></span></eq>反射轴来执行反射的矩阵:<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.4%20%E5%9B%B4%E7%BB%95%E4%BB%BB%E6%84%8F%E8%BD%B4%E5%8F%8D%E5%B0%84%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%9F%A9%E9%98%B5.png" alt></li><li>在<strong>三维中</strong>,我们有一个<strong>反射平面</strong>而不是轴。<strong>为了使变换成为线性,平面必须包含原点</strong>,在这种情况下,执行反射的矩阵是<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.4%20%E5%9B%B4%E7%BB%95%E4%BB%BB%E6%84%8F%E5%B9%B3%E9%9D%A2%E5%8F%8D%E5%B0%84%E7%9A%84%E4%B8%89%E7%BB%B4%E7%9F%A9%E9%98%B5.png" alt><br>请注意,对象只能&quot;反射&quot;一次。如果再次反射它(甚至是围绕不同的轴或平面),那么对象将被翻转回&quot;右侧朝外&quot;,这与将对象从其初治位置旋转是一样的。图5.9的左下角显示了这样一个例子。</li></ol><h1 id="5.5-%E9%94%99%E5%88%87" tabindex="-1">5.5 错切</h1><p>错切(Shearing)是一种&quot;<strong>倾斜</strong>&quot;坐标空间的变形,它将不均匀地拉伸坐标空间,<strong>不保留角度</strong>。然而,令人惊讶的是,<strong>面积和体积却保留了</strong>。其基本思路是将一个坐标的倍数添加到另一个坐标上。例如,在二维中,可以取<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq>的倍数并将其添加到<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq>上,以便<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>x</mi><mo>+</mo><mi>s</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">x&#x27;=x+sy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">sy</span></span></span></span></eq>。下图显示了这个例子。<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.5%20%E5%9C%A8%E4%BA%8C%E7%BB%B4%E4%B8%AD%E7%9A%84%E9%94%99%E5%88%87.png" alt><br>在上图中，执行二维中的错切的矩阵是<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">H</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>s</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\bold{H}_x(s) = \begin{bmatrix}1 &amp;&amp; 0 \\s &amp;&amp; 1 \\\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.45em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></eqn></section><br>其中,符号<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">H</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">\bold{H}_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>表示<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq>坐标被另一个坐标<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq>错切；参数<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span></eq>控制错切的量和方向。另一个二维错切矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">H</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">\bold{H}_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9722em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq>,是<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">H</mi><mi>y</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>s</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\bold{H}_y(s) = \begin{bmatrix}1 &amp;&amp; s \\0 &amp;&amp; 1 \\\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.45em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></eqn></section><br>在三维中,我们可以采用一个坐标并将该坐标的不同倍数添加到另外两个坐标上。符号<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">H</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\bold{H}_{xy}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9722em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq>表示<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq>坐标和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq>坐标按照另一个坐标<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></eq>移动。完整的矩阵如下:<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.5%20%E4%B8%89%E7%BB%B4%E9%94%99%E5%88%87%E7%9F%A9%E9%98%B5.png" alt></p><p>错切是一种很少使用的变换，<strong>它也被称为倾斜变形</strong>(SkewTransform)。结合错切和缩放(均匀或不均匀)会产生一种变形效果，使人分不清它是否包含了旋转和非均匀缩放的变换。</p><h1 id="5.6-%E7%BB%84%E5%90%88%E5%8F%98%E6%8D%A2" tabindex="-1">5.6 组合变换</h1><p>本节将介绍如何<strong>获取一系列变换矩阵并将它们组合</strong>(Combine)或连接(Concatenate)<strong>到一个单一的变换矩阵中</strong>。此新矩阵表示按顺序应用所有原原始变换的累积结果。这实际上非常简单。从应用矩阵A变换,接着通过应用矩阵B变换,从而累积得到的变换具有矩阵AB。也就是说，<strong>矩阵乘法即可将组合变换表示为矩阵</strong>。</p><ol><li>一个非常常见的例子是渲染(Rendering)。想象一下,世界上任意位置和方向都有一个对象。我们希望为给定的任何位置和方向上的相机渲染此对象。要做到这一点,我们必须取对象的顶点(假设渲染某种三角形网格)并将它们<strong>从对象空间变换到世界空间中</strong>。这种变换称为<strong>模型变换</strong> (Model Transform),将其表示为 <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">M</mi><mrow><mi>o</mi><mi>b</mi><mi>j</mi><mo>→</mo><mi>w</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\bold{M}_{obj→wld}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9722em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">bj</span><span class="mrel mtight">→</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">wl</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq> 。从那里，<strong>使用视图变换</strong>（ViewTransform,表示为<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">M</mi><mrow><mi>w</mi><mi>l</mi><mi>d</mi><mo>→</mo><mi>c</mi><mi>a</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\bold{M}_{wld→cam}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">wl</span><span class="mord mathnormal mtight">d</span><span class="mrel mtight">→</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">am</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>）将世界空间顶点变换到相机空间中。所涉及的数学可以概括为<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.6%20%E6%A8%A1%E5%9E%8B%E5%8F%98%E6%8D%A2%E5%92%8C%E8%A7%86%E5%9B%BE%E5%8F%98%E6%8D%A2.png" alt><br>在第4.1.6节介绍了，矩阵乘法是可结合的，即 <strong>(AB)C=A(BC)</strong> 。因此,可以通过下式计算一个矩阵直接从对象空间变换到相机空间中:<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.6%20%E8%A7%86%E5%9B%BE%E5%8F%98%E6%8D%A2%E5%8C%96%E7%AE%80.png" alt><br>因此,可以连接顶点循环外的矩阵，并且在循环内只有一个矩阵乘法(请记住，有很多顶点)，具体如下:<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.6%20%E8%A7%86%E5%9B%BE%E5%8F%98%E6%8D%A2%EF%BC%88%E9%A1%B6%E7%82%B9%EF%BC%89.png" alt></li><li>由此可以看到，通过使用矩阵乘法的可结合属性，从代数角度进行的矩阵连接是有效的。让我们看一看是否可以对正在发生的事情进行更多的几何解释。回顾一下,在之前第4.2节中有一个突破性的发现，那就是<strong>矩阵的行包含变换标准基矢量的结果,即使在多次变换的情况下也是如此</strong>。请注意,在矩阵乘积<strong>AB</strong>中,每个结果行是矩阵<strong>A</strong>的相应行与矩阵<strong>B</strong>的乘积。换句话说,设行矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">a_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>、<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">a_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">a_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>代表<strong>A</strong>的行,则矩阵乘法可以写成<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.6%20%E8%A7%86%E5%9B%BE%E5%8F%98%E6%8D%A2%E7%9F%A9%E9%98%B5.png" alt><br>这明确地表明,<strong>AB</strong>的乘积的行实际上是将<strong>A</strong>中的基矢量乘以<strong>B</strong>之后的变换结果。</li></ol><h1 id="5.7-%E5%8F%98%E6%8D%A2%E7%9A%84%E5%88%86%E7%B1%BB" tabindex="-1">5.7 变换的分类</h1><p>我们可以<strong>根据若干个标准对变换进行分类</strong>。本节将讨论变换的分类。对于每个类，我们描述属于该类的变换的属性，并指出第5.1节~第5.5节中的哪些基本变换属于该类。<strong>变换的类不是相互排斥的</strong>，它们也不一定遵循&quot;顺序&quot;或&quot;层次结构&quot;，<strong>每一个类都可能比其他的类具有更多或更少的限制</strong>。</p><p>当<strong>讨论一般的变换时,可以使用同义词映射</strong>(Mapping)或<strong>函数</strong>(Function)。在最一般意义上，映射只是一个接受输入并产生输出的规则。例如，<strong>要表示映射F将a映射到b</strong>，则可以记作<strong><em>F</em>(a)=b</strong>(读作a等于b的<em>F</em>)。当然,我们主要对使用矩阵乘法可以表达的变换感兴趣，但重要的是，要注意其他映射也是可能的。</p><p>本节还提到了矩阵的行列式(Determinant)。在这里只是提前说一下,因为在第6.1节将给出有关行列式的完整解释。现在,只要知道矩阵的行列式是一个标量并且非常有用就足够了。</p><h2 id="5.7.1-%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2" tabindex="-1">5.7.1 线性变换</h2><ol><li><p>在第4.2节中非正式地介绍了线性函数。在数学上,<strong>当以下公式成立时,映射<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></eq>就是线性的</strong>:<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.7.1%20F%E4%B8%BA%E7%BA%BF%E6%80%A7%E6%98%A0%E5%B0%84%E7%9A%84%E6%9D%A1%E4%BB%B6.png" alt></p></li><li><p><strong>如果映射<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span></eq>保留了标量加法和乘法的基本运算</strong>,则表明映射 <strong><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span></eq>是线性的</strong>;如果将<strong>两个矢量相加</strong>,然后执行变换,则得到的<strong>结果就和单独对两个矢量执行变换然后将变换后的矢量加在一起是一样的</strong>;<strong>同样</strong>,如果<strong>缩放</strong>一个矢量然<strong>后又对其进行变换</strong>,则得到的<strong>结果应该与先变换矢量然后再缩放它的结果相同</strong>。</p></li><li><p>这种<strong>线性变换的定义有两个重要的含义</strong>。首先,映射<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">F(a)=aM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>(其中,<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>是任意方形矩阵)是一个线性变换,因为<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.7.1%20%E6%BB%A1%E8%B6%B3%E5%BC%8F%EF%BC%885.2%EF%BC%89%E7%9A%84%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95.png" alt><br>且<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.7.1%20%E6%BB%A1%E8%B6%B3%E5%BC%8F%EF%BC%885.3%EF%BC%89%E7%9A%84%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95.png" alt><br><strong>换句话说：可以通过矩阵乘法实现的任何变换都是线性变换。</strong></p></li><li><p>总结</p><ul><li><strong>可以通过矩阵乘法实现的任何变换都是线性变换</strong><ul><li>其次，<strong>任何线性变换都会将零矢量变换为零矢量</strong>。如果<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">F</mi><mo stretchy="false">(</mo><mn mathvariant="bold">0</mn><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="bold">a</mi><mo separator="true">,</mo><mi mathvariant="bold">a</mi><mo mathvariant="bold">≠</mo><mn mathvariant="bold">0</mn></mrow><annotation encoding="application/x-tex">\bold{F(0)=a,a\neq 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="mopen">(</span><span class="mord mathbf">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathbf">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">0</span></span></span></span></span></eq>,则<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span></eq>不能是线性映射,因为<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mn mathvariant="bold">0</mn><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="bold">a</mi></mrow><annotation encoding="application/x-tex">F(k\bold{0})=\bold{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathbf">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">a</span></span></span></span></eq>,所以<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mn mathvariant="bold">0</mn><mo stretchy="false">)</mo><mo mathvariant="normal">≠</mo><mi>k</mi><mi>F</mi><mo stretchy="false">(</mo><mn mathvariant="bold">0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k\bold{0})\neq kF(\bold{0})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathbf">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathbf">0</span><span class="mclose">)</span></span></span></span></eq>。因此,</li></ul></li><li><strong>线性变换不包含平移</strong><ul><li>由于<strong>在第5.1节~第5.5节中讨论的所有变换</strong>都可以使用矩阵乘法表示,因此它们<strong>都是线性变换</strong>。<strong>在某些文献中,线性变换定义为变换后平行线保持平行的变换</strong>。这几乎是完全准确的,但是有两个例外。首先,平行线在平移后保持平行,但平移不是线性变换。其次,投影怎么样?当一条线被投射并成为一个点时,可以将这个个点与任何东西&quot;平行&quot;吗?排除这些技术,直觉是正确的:<strong>线性变换可以&quot;拉伸&quot;事物,但直线不会&quot;扭曲&quot;,平行线保持平行</strong>。</li></ul></li></ul></li></ol><h2 id="5.7.2-%E4%BB%BF%E5%B0%84%E5%8F%98%E6%8D%A2" tabindex="-1">5.7.2 仿射变换</h2><p><strong>仿射(Affine)变换是线性变换+平移</strong>。因此,仿射变换集是该组线性变换的超集:<strong>任何线性变换都是仿射变换,但并非所有仿射变换都都是线性变换</strong>。<br>由于<strong>本章所讨论的所有变换都是线性变换</strong>,因此它们<strong>都是仿射变换</strong>(尽管它们都没有平移的部分)。<strong>形式<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="bold">v</mi><mo mathvariant="bold" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi mathvariant="bold">v</mi><mi mathvariant="bold">M</mi><mo>+</mo><mi mathvariant="bold">b</mi></mrow><annotation encoding="application/x-tex">\bold{v&#x27;=vM+b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8352em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">vM</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">b</span></span></span></span></span></eq>的任何变换都是仿射变换。</strong></p><h2 id="5.7.3-%E5%8F%AF%E9%80%86%E5%8F%98%E6%8D%A2" tabindex="-1">5.7.3 可逆变换</h2><ol><li>如果<strong>存在称为<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span></eq>的逆(Inverse)的相反变换(即&quot;撤销&quot;原始变换),则该变换是可逆(Invertible)的</strong>。换句话说,<strong>如果存在逆映射(InverseMapping)<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></eq>,则映射<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></eq>是可逆的,使得</strong><br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">F^{-1}(F(a)) = F(F^{-1}(a))=a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span></span></eqn></section><br>同时，也意味着<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></eq>也是可逆的。</li><li><strong>目前仅针对仿射变换的可逆进行探究。</strong></li><li>直觉上我们知道,除了投影之外的所有变换都可以&quot;撤销&quot;。如果我们旋转、缩放、反射或倾斜,我们总是可以取消旋转(Unrotate)、取消缩放(Unscale)、取消反射(Unreflect)或取消倾斜(Unskew)。但是,<strong>当对象被投影时,我们会有效地丢弃一个或多个维度的信息,而这些信息无法恢复。因此,除了投影之外的所有原始变换都是可逆的</strong>。</li><li>由于<strong>任何线性变换都可以表示为乘以矩阵</strong>,因此,<strong>找到线性变换的逆相当于找到矩阵的逆</strong>。我们将在第6.2节讨论如何执行此操作。<strong>如果矩阵没有逆,那么我们说它是奇异矩阵(SingularMatrix),并且变换是不可逆的。可逆矩阵的行列式是非零的。</strong></li><li>在非奇异矩阵中,<strong>零矢量是唯一的输入矢量</strong>,它被映射到输出空间中的零矢量,所有其他矢量都映射到其他一些非零矢量。然而,<strong>在单个矩阵中</strong>,存在<strong>输入矢量的整个子空间</strong>,<strong>称为矩阵的零空间</strong>(Null Space),其被映射到零矢量。例如,考虑一个矩阵,该<strong>矩阵以正交方式投影到包含原点的平面上</strong>。<strong>该矩阵的零空间由垂直于平面的矢量线组成,因为它们都映射到原点。</strong></li><li>当<strong>方形矩阵是奇异矩阵时</strong>,其<strong>基矢量不是线性无关的</strong>(参见第3.3.3节)。如果基矢量是线性无关的,<strong>则它们具有满秩</strong>,并且唯一地确定跨度中的任何给定矢量的坐标;<strong>如果矢量是线性有关的,那么整个n维空间的一部分不在基矢量的范围内</strong>。考虑两个矢量<strong>a</strong>和<strong>b</strong>,它们通过位于矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>的零空间中的矢量<strong>n</strong>差分,使得<strong>b = a + n</strong>。由于矩阵乘法的线性特性,<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></eq>会将<strong>a</strong>和<strong>b</strong>映射到相同的输出:<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.7.3%20%E5%8F%AF%E9%80%86%E5%8F%98%E6%8D%A2%E9%9B%B6%E7%A9%BA%E9%97%B4.png" alt></li></ol><h2 id="5.7.4-%E4%BF%9D%E6%8C%81%E8%A7%92%E5%BA%A6%E7%9A%84%E5%8F%98%E6%8D%A2" tabindex="-1">5.7.4 保持角度的变换</h2><p>如果<strong>两个矢量之间的角度在变换后的大小或方向上没有改变,则该变换就是保持角度(Angle-Preserving)的</strong>。只有<strong>平移、旋转和均匀缩放才是保持角度的变换</strong>。保持角<br>度的矩阵也将保留比例。我们<strong>不考虑反射保持角度的变换</strong>,因为即使变换后两个矢量之间的<strong>角度大小相同,角度的方向也可能是相反的</strong>。<strong>所有保持角度的变换都是仿射和可逆的。</strong></p><h2 id="5.7.8-%E6%AD%A3%E4%BA%A4%E5%8F%98%E6%8D%A2" tabindex="-1">5.7.8 正交变换</h2><ol><li>正交(Orthogonal)是用于描述矩阵的术语,该矩阵的行将形成标准正交基。之前在第3.3.3节介绍了其基本思想是<strong>轴彼此垂直并具有单位长度</strong>。正交变换 <strong>（保持向量内积不变的线性变换）</strong> 很有意思,因为很容易计算出它们的逆,并且它们在实践中经常出现。将<strong>在第6.3节讨论更多关于正交矩阵</strong>的内容</li><li><strong>平移、旋转和反射都只有正交变换,所有正交变换都是仿射和可逆的</strong>。其<strong>长度、角度、面积和体积均保留</strong>。话虽如此,我们仍然必须小心谨慎地确定其角度、面积和体积,但<strong>反射也是一个正交变换</strong>,但在第5.7.4节中刚刚说过,我们<strong>不认为反射是一个保持角度的变换</strong>。所以,也许应该<strong>更精确地说:正交矩阵将保留角度、面积和体积的大小,但其符号却可能不一样</strong>。</li><li>在第6章介绍<strong>正交矩阵的行列式为±1</strong>。</li></ol><h2 id="5.7.6-%E5%88%9A%E4%BD%93%E5%8F%98%E6%8D%A2" tabindex="-1">5.7.6 刚体变换</h2><ol><li><strong>刚体变换(Rigid Body Transformation)是指改变对象的位置和方向但不改变其形状的变换。保留所有角度、长度、面积和体积</strong>。平移和旋转都是是刚体转换,但是反射则不被认为是严格的刚体变换。</li><li><strong>刚体变换也称为合适变换</strong>(ProperTransformation)。所有刚体变换<strong>都是正交的、保持角度的、可逆的和仿射的</strong>。刚体变换是本节中讨论的最严路的变换类,但它们在实践中也非常常见。</li><li><strong>任何刚体变换矩阵的行列式均为1</strong>。</li></ol><h2 id="5.7.7-%E5%8F%98%E6%8D%A2%E7%B1%BB%E5%9E%8B%E6%80%BB%E7%BB%93" tabindex="-1">5.7.7 变换类型总结</h2><p>下表5.1总结了各种类型的变换。在此表中，<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Y</mi></mrow><annotation encoding="application/x-tex">\bold{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span></span></span></eq>表示该行中的的变换始终具有与该列关联的属性。没有<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">Y</mi></mrow><annotation encoding="application/x-tex">\bold{Y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span></span></span></eq>并不意味着“永远不”关联；相反，它意意味着&quot;并不总是&quot;关联<br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.7.7%20%E5%8F%98%E6%8D%A2%E7%9A%84%E7%B1%BB%E5%9E%8B1.png" alt><br><img src="/2025/02/17/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E7%9F%A9%E9%98%B5%E5%92%8C%E7%BA%BF%E6%80%A7%E5%8F%98%E6%8D%A2/5.7.7%20%E5%8F%98%E6%8D%A2%E7%9A%84%E7%B1%BB%E5%9E%8B2.png" alt></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;本章讨论使用3x3矩阵再三位中表达线性变换（旋转、比例缩放、正交投影、反射和错切）&lt;/p&gt;</summary>
    
    
    
    <category term="3D数学基础" scheme="http://example.com/categories/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="3D数学基础" scheme="http://example.com/tags/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>Unity编辑器拓展（一）-自定义菜单栏拓展</title>
    <link href="http://example.com/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/"/>
    <id>http://example.com/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/</id>
    <published>2024-12-02T15:06:27.000Z</published>
    <updated>2025-03-31T14:55:13.219Z</updated>
    
    <content type="html"><![CDATA[<h2 id="%E4%B8%80%E3%80%81-%E7%89%B9%E6%AE%8A%E6%96%87%E4%BB%B6%E5%A4%B9editor" tabindex="-1">一、 特殊文件夹Editor</h2><p>对于编辑器拓展相关的文件需要放置在名为Editor的文件夹中，如果被放置在其他地方，会导致打包时候不能够成功，避免打包时报错。<br><img src="/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/1.png" alt></p><span id="more"></span><h2 id="%E4%BA%8C%E3%80%81-%E8%8F%9C%E5%8D%95%E6%A0%8F%E4%B8%AD%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A1%B5%E7%AD%BE%EF%BC%88%E4%B8%8D%E5%8F%AF%E8%A2%AB%E6%89%93%E5%8C%85%EF%BC%8C%E5%9B%A0%E4%B8%BA%E5%9C%A8edior%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%EF%BC%89" tabindex="-1">二、 菜单栏中添加自定义页签（不可被打包，因为在edior文件夹下）</h2><ol><li>命名空间：UnityEditor</li><li>特性 MenuItem</li><li>用法：在静态函数前加上 [MenuItem(“页签/一级选项/二级选项/…”)]</li><li>作用： 当在菜单栏点击该页签，将执行对应的静态函数中的逻辑</li><li>注意：<ul><li>不同在意继承对象，不继承MonoBehaviour也可以</li><li>斜杠必须是/</li><li>方法是私有函数的也可以，只要是静态，且加了特性</li></ul></li><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">MenuItem(<span class="string">&quot;Unity编辑器拓展/Lesson1/TestFun&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestFun</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;TestFun&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="7"><li>效果<br><img src="/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/2%E7%BC%96%E8%BE%91%E5%99%A8%E8%8F%9C%E5%8D%95%E6%A0%8F.png" alt></li></ol><h2 id="%E4%B8%89%E3%80%81%E5%9C%A8hierarchy%E7%AA%97%E5%8F%A3%E4%B8%AD%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A1%B5%E7%AD%BE%EF%BC%88%E4%B8%8D%E5%8F%AF%E8%A2%AB%E6%89%93%E5%8C%85%EF%BC%8C%E5%9B%A0%E4%B8%BA%E5%9C%A8edior%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%EF%BC%89" tabindex="-1">三、在Hierarchy窗口中添加自定义页签（不可被打包，因为在edior文件夹下）</h2><ol><li>命名空间：UnityEditor</li><li>特性 MenuItem</li><li>用法：在静态函数前加上，并且页签命名放入GameObject路径 [MenuItem(“GameObject/页签/一级选项/二级选项/…”)]</li><li>注意情况跟第二点中一致，外还有一个：    在菜单栏的GameObject中也会出现对应选项</li><li>示例：</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">MenuItem(<span class="string">&quot;GameObject/Lesson1/TestFun2&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestFun2</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;TestFun2&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>效果：<br><img src="/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/3Hierarchy%E7%AA%97%E5%8F%A3" alt></li></ol><h2 id="%E5%9B%9B%E3%80%81%E5%9C%A8project%E7%AA%97%E5%8F%A3%E4%B8%AD%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A1%B5%E7%AD%BE%EF%BC%88%E4%B8%8D%E5%8F%AF%E8%A2%AB%E6%89%93%E5%8C%85%EF%BC%8C%E5%9B%A0%E4%B8%BA%E5%9C%A8edior%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%EF%BC%89" tabindex="-1">四、在Project窗口中添加自定义页签（不可被打包，因为在edior文件夹下）</h2><ol><li>与前面一致，唯有路径不同</li><li>用法：在静态函数前加上，并且页签命名放入Assets路径 [MenuItem(“Assets/页签/一级选项/二级选项/…”)]</li><li>在菜单栏的Assets中也会出现对应选项</li><li>示例：</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">MenuItem(<span class="string">&quot;Assets/Lesson1/TestFun3&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestFun3</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;TestFun3&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>效果：<br><img src="/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/3%E5%9C%A8Asset%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89" alt></li></ol><h2 id="%E4%BA%94%E3%80%81%E5%9C%A8%E8%8F%9C%E5%8D%95%E6%A0%8F%E7%9A%84component%E8%8F%9C%E5%8D%95%E6%B7%BB%E5%8A%A0%E8%84%9A%E6%9C%AC%EF%BC%88%E5%8F%AF%E8%A2%AB%E6%89%93%E5%8C%85%EF%BC%89" tabindex="-1">五、在菜单栏的Component菜单添加脚本（可被打包）</h2><ol><li><p>命名空间：UnityEngine</p></li><li><p>特性：AddComponentMenu</p></li><li><p>用法：<br>在想要通过Component菜单添加的<strong>脚本类前面</strong>前加上<br>[AddComponentMenu(“一级选项/二级选项/…”)]</p></li><li><p>注意：</p><ul><li>脚本需要继承MonoBehaviour对象</li><li>斜杠必须是/</li><li>最后一级选项的名字可以和脚本名（<strong>该脚本不会放在Editor文件夹内</strong>）不一样，但是建议一致</li></ul></li><li><p>示例</p></li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line">[<span class="meta">AddComponentMenu(<span class="string">&quot;Unity编辑器拓展/添加脚本/Lesson1_Test&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Lesson1_Test</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Start is called before the first frame update</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update is called once per frame</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="6"><li>效果:<br><img src="/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/5%E5%9C%A8%E8%8F%9C%E5%8D%95%E6%A0%8F%E7%9A%84Component%E8%8F%9C%E5%8D%95%E6%B7%BB%E5%8A%A0%E8%84%9A%E6%9C%AC.png" alt></li></ol><h2 id="%E5%85%AD%E3%80%81-%E5%9C%A8inspector%E4%B8%BA%E8%84%9A%E6%9C%AC%E5%8F%B3%E9%94%AE%E6%B7%BB%E5%8A%A0%E8%8F%9C%E5%8D%95%EF%BC%88%E4%B8%8D%E5%8F%AF%E8%A2%AB%E6%89%93%E5%8C%85%EF%BC%89" tabindex="-1">六、 在Inspector为脚本右键添加菜单（不可被打包）</h2><ol><li>命名空间：UnityEditor</li><li>特性 MenuItem</li><li>用法：在静态函数前加上[MenuItem(“CONTEXT/脚本名/页签/一级选项/二级选项/…”)]</li><li>注意：<ul><li>不用在意继承对象</li><li>斜杠必须是</li></ul></li><li>示例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">MenuItem(<span class="string">&quot;CONTEXT/Lesson1_Test/Lesson1/自定义功能&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestFun4</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Debug.Log(<span class="string">&quot;TestFun4&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>效果:<br><img src="/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/6%E5%9C%A8Inspector%E4%B8%BA%E8%84%9A%E6%9C%AC%E5%8F%B3%E9%94%AE%E6%B7%BB%E5%8A%A0%E8%8F%9C%E5%8D%95" alt></li></ol><h2 id="%E4%B8%83%E3%80%81%E5%8A%A0%E5%85%A5%E5%BF%AB%E6%8D%B7%E9%94%AE" tabindex="-1">七、加入快捷键</h2><ol><li><p>单键</p><ul><li>路径后 + 空格 + 下划线 + 想要的按键</li></ul></li><li><p>组合键：<br>下划线替换为</p></li></ol><ul><li>%表示ctrl</li><li>#表示shift</li><li>&amp;表示alt</li></ul><ol start="3"><li>其他支持的按键：</li></ol><ul><li>LEFT、RIGHT：持类似#LEFT是左shift之类的按键</li><li>UP、DOWN、F1…F12、HOME、END、PGUP、PGDN</li></ul><ol start="4"><li>以菜单栏中添加自定义页签 为例</li></ol><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">MenuItem(<span class="string">&quot;Unity编辑器拓展/Lesson1/TestFun %#&amp;A&quot;</span>)</span>] <span class="comment">//表示快捷键为Ctrl+Shift+Alt+A</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">TestFun</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;TestFun&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="5"><li>效果<br><img src="/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/7%E5%8A%A0%E5%85%A5%E5%BF%AB%E6%8D%B7%E9%94%AE" alt></li></ol><h2 id="%E5%85%AB%E3%80%81%E6%80%BB%E7%BB%93" tabindex="-1">八、总结</h2><ol><li>使用UnityEditor命名空间的脚本必须放在Editor文件夹下，避免打包报错</li><li>添加自定义页签 需要用到特性 MenuItem</li><li>添加代码添加页签 需要用到特性 AddComponentMenu</li></ol><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;%E4%B8%80%E3%80%81-%E7%89%B9%E6%AE%8A%E6%96%87%E4%BB%B6%E5%A4%B9editor&quot; tabindex=&quot;-1&quot;&gt;一、 特殊文件夹Editor&lt;/h2&gt;
&lt;p&gt;对于编辑器拓展相关的文件需要放置在名为Editor的文件夹中，如果被放置在其他地方，会导致打包时候不能够成功，避免打包时报错。&lt;br&gt;
&lt;img src=&quot;/2024/12/02/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%B8%E5%85%B3-Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95-%E4%B8%80-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E6%A0%8F%E6%8B%93%E5%B1%95/1.png&quot; alt&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Unity学习笔记" scheme="http://example.com/categories/Unity%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="Unity编辑器拓展" scheme="http://example.com/tags/Unity%E7%BC%96%E8%BE%91%E5%99%A8%E6%8B%93%E5%B1%95/"/>
    
  </entry>
  
  <entry>
    <title>Hexo在多台电脑上提交和更新</title>
    <link href="http://example.com/2024/12/01/Hexo%E5%9C%A8%E5%A4%9A%E5%8F%B0%E7%94%B5%E8%84%91%E4%B8%8A%E6%8F%90%E4%BA%A4%E5%92%8C%E6%9B%B4%E6%96%B0/"/>
    <id>http://example.com/2024/12/01/Hexo%E5%9C%A8%E5%A4%9A%E5%8F%B0%E7%94%B5%E8%84%91%E4%B8%8A%E6%8F%90%E4%BA%A4%E5%92%8C%E6%9B%B4%E6%96%B0/</id>
    <published>2024-12-01T04:20:21.000Z</published>
    <updated>2024-12-01T07:28:21.173Z</updated>
    
    <content type="html"><![CDATA[<p>参考链接：<a href="https://blog.csdn.net/K1052176873/article/details/122879462">https://blog.csdn.net/K1052176873/article/details/122879462</a></p><p>有时候更换电脑需要也将博客迁移，但新电脑上直接配置是效率较低的因此git来管理</p><span id="more"></span><h1 id="%E4%B8%80%E3%80%81hexo%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9%E8%AF%B4%E6%98%8E" tabindex="-1">一、Hexo的文件夹说明</h1><p><img src="/2024/12/01/Hexo%E5%9C%A8%E5%A4%9A%E5%8F%B0%E7%94%B5%E8%84%91%E4%B8%8A%E6%8F%90%E4%BA%A4%E5%92%8C%E6%9B%B4%E6%96%B0/%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E8%AF%B4%E6%98%8E.png" alt></p><h1 id="%E4%BA%8C%E3%80%81%E5%90%8C%E6%AD%A5%E5%8E%9F%E7%90%86" tabindex="-1">二、同步原理</h1><ol><li>主要思路是利用git分支来实现hexo的同步。<br><strong>hexo生成的静态页面文件默认放在master分支上，这是由_config.yml配置文件所决定的</strong><br>你可以在全局配置文件_config.yml中找到这么一段</li></ol><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:username/username.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p>因此每当我们<strong>执行hexo d</strong>的时候，hexo都会帮我们把<strong>生成好的静态页面文件推到master分支上</strong></p><p>在我们<strong>第一次部署好博客的时候</strong>，github给我们创建的唯一一个分支就是<strong>master分支，同时也是默认分支</strong>。默认分支就<strong>意味着每次我们执行git clone 仓库地址或者git pull 仓库地址拉取的是默认分支的代码</strong>。</p><p><strong>但是执行hexo d</strong> 对应的分支和默认分支是没有关系的，因为这<strong>是由配置文件决定的，配置文件写的哪个分支就是哪个分支</strong>。</p><ol start="2"><li>因此，hexo生成的<strong>静态博客文件默认放在master分支上</strong>。<strong>hexo的源文件（部署环境文件）可以都放在source分支上</strong>（可以新创建一个source分支）。然后<strong>把source分支设置成默认分支</strong>。有小伙伴可能会担心默认分支的改变会不会影响到原来的网页的正常显示，其实如果是<strong>用GitHub Pages对博客进行托管</strong>的话也很简单，第一次搭建博客默认使用master分支作为页面。在下图所示的设置里可以找到。如果<strong>不小心搞错了只要把分支设置成静态页面对应的分支就好了</strong>。<br><img src="/2024/12/01/Hexo%E5%9C%A8%E5%A4%9A%E5%8F%B0%E7%94%B5%E8%84%91%E4%B8%8A%E6%8F%90%E4%BA%A4%E5%92%8C%E6%9B%B4%E6%96%B0/%E5%8D%9A%E5%AE%A2%E5%88%86%E6%94%AF%E9%80%89%E6%8B%A9.png" alt></li></ol><p><strong>把source分支设置成默认分支，用来存放源文件，master分支依然存放静态文件</strong>。在老电脑上，我们需要<strong>把必要的源文件push到source分支。换新电脑时，直接git clone 仓库地址此时会从source分支下载源文件</strong>，剩下的就是安装hexo环境，在新电脑上就可以重新生成静态页面了，并且<strong>因为配置文件clone下来，deploy配置依旧是master分支，所以在新电脑上执行hexo d还是会把更新过后的静态文件推送到master分支上</strong>。</p><p>由于master分支和source分支实际上是相互独立的两个普通的分支，所以我们<strong>源文件和静态页面的更新也是相互独立的，故而需要手动分别执行git add . git commit git push来更新源文件,然后执行hexo d更新静态页面</strong>。</p><h1 id="%E4%BA%8C%E3%80%81%E6%97%A7%E7%94%B5%E8%84%91%E5%85%B7%E4%BD%93%E6%93%8D%E4%BD%9C%EF%BC%88%E2%AD%90%EF%BC%89" tabindex="-1">二、旧电脑具体操作（⭐）</h1><ol><li>github准备<br>创建一个分支hexo，在输入框输入hexo并点击下面的创建。<br><img src="/2024/12/01/Hexo%E5%9C%A8%E5%A4%9A%E5%8F%B0%E7%94%B5%E8%84%91%E4%B8%8A%E6%8F%90%E4%BA%A4%E5%92%8C%E6%9B%B4%E6%96%B0/%E5%88%9B%E5%BB%BA%E5%88%86%E6%94%AF.png" alt></li><li>设置默认分支<br><img src="/2024/12/01/Hexo%E5%9C%A8%E5%A4%9A%E5%8F%B0%E7%94%B5%E8%84%91%E4%B8%8A%E6%8F%90%E4%BA%A4%E5%92%8C%E6%9B%B4%E6%96%B0/%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E5%88%86%E6%94%AF.png" alt></li><li>打包将要推送到GitHub上的原始文件<br>clone该仓库到本地（clone的是hexo默认分支）</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:username/username.github.io.git</span><br></pre></td></tr></table></figure><ol start="4"><li><p>下载的文件夹里仅留下.git 文件夹，其他的文件都删除</p></li><li><p>找到原博客文件位置，将文件夹内除.deploy_git 以外都复制到clone下来的文件夹中</p></li><li><p>现在clone下来的文件夹内应该有个 <strong>.gitignore文件</strong> ，用来忽略一些不需要的文件，表示这些类型文件不需要git。如果没有，右键新建，<strong>内容如下</strong>：</p></li></ol><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">.DS_Store</span></span><br><span class="line">Thumbs<span class="number">.</span><span class="built_in">db</span></span><br><span class="line"><span class="built_in">db</span><span class="number">.</span>json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line"><span class="meta">public</span>/</span><br><span class="line"><span class="meta">.deploy</span>*/</span><br></pre></td></tr></table></figure><ol start="7"><li>如果<strong>已经clone过主题文件，那么需要把theme主题文件夹里的 .git 也删除</strong>。因为git不能嵌套上传，最好是显示隐藏文件，检查一下有没有，<strong>否则上传的时候会出错</strong>，导致你的主题文件无法上传，这样你的配置在别的电脑上就用不了了。<br><img src="/2024/12/01/Hexo%E5%9C%A8%E5%A4%9A%E5%8F%B0%E7%94%B5%E8%84%91%E4%B8%8A%E6%8F%90%E4%BA%A4%E5%92%8C%E6%9B%B4%E6%96%B0/%E4%B8%BB%E9%A2%98%E6%96%87%E4%BB%B6git%E5%88%A0%E9%99%A4.png" alt></li><li>将clone并修改以后的文件夹推送到远程库</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit –m add_branch</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><ol start="9"><li>此时已经成功将整个网站推送到了远程库的默认分支hexo,</li><li>至此，网站部署至master分支，整个网站备份至hexo分支。当网站的配置或文章修改后都要将远程仓库更新。首先，依次执行</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m 内容</span><br><span class="line">git push （或者git push origin hexo）</span><br></pre></td></tr></table></figure><p>保证hexo分支版本最新。然后执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d -g</span><br></pre></td></tr></table></figure><p>在此之前，有时可能需要执行<strong>hexo clean</strong>，完成后就会发现，最新改动已经更新到master分支了，两个分支互不干扰！</p><h1 id="%E4%B8%89%E3%80%81%E6%96%B0%E7%94%B5%E8%84%91%E4%B8%8A%E7%9A%84%E6%93%8D%E4%BD%9C%EF%BC%88%E2%AD%90%EF%BC%89" tabindex="-1">三、新电脑上的操作（⭐）</h1><ol><li>将新电脑的生成的ssh key添加到GitHub账户上</li><li>在新电脑上克隆username.github.io仓库的source分支(就是存放源码的分支)到本地，此时本地git仓库处于source分支,可以执行git branch -v查看。</li><li>在新电脑的username.github.io文件夹下执行</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo (如果安装后hexo无效使用 npm install -g hexo来全局安装hexo)</span><br><span class="line">npm install</span><br><span class="line">npm install hexo-deployer-git （记得，不需要hexo init这条指令）</span><br></pre></td></tr></table></figure><ol start="4"><li>最后执行</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>等命令即可提交成功<br>上面步骤中，<strong>npm install其实就是读取了packages.json里面的信息，自动安装依赖</strong>，有的小伙伴<strong>可能只执行npm install就行了，不过按照上面的三步是最稳妥的。</strong></p><p>这里提一嘴，当新电脑上的操作成功之后，其实对于新电脑还是老电脑其实都无所谓了，任何一台电脑包括老电脑只要安装了NodeJs环境，就都可以按照在新电脑上的操作完整地复刻出一个hexo环境，你甚至可以把老电脑原有的hexo工程删掉再执行上面这几步一样可以快速构建hexo环境，可以看到步骤非常简单。</p><p>此外，为了保证同步，推荐<strong>先git pull合并</strong>更新再进行博客的编写。</p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;参考链接：&lt;a href=&quot;https://blog.csdn.net/K1052176873/article/details/122879462&quot;&gt;https://blog.csdn.net/K1052176873/article/details/122879462&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;有时候更换电脑需要也将博客迁移，但新电脑上直接配置是效率较低的因此git来管理&lt;/p&gt;</summary>
    
    
    
    <category term="hexo博客搭建" scheme="http://example.com/categories/hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    
    
    <category term="hexo博客搭建" scheme="http://example.com/tags/hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    
  </entry>
  
  <entry>
    <title>3D数学基础-图形和游戏开发-学习笔记 第四章 矩阵简介</title>
    <link href="http://example.com/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/"/>
    <id>http://example.com/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/</id>
    <published>2024-11-24T10:56:44.000Z</published>
    <updated>2024-12-04T14:49:59.682Z</updated>
    
    <content type="html"><![CDATA[<p>矩阵在3D数学中具有根本意义上的重要性,它们主要用于描述两个坐标空间之间的关系。它们通过定义将矢量从一个坐标空间转换为另一个坐标空间来实现此目的。</p><span id="more"></span><p>本章主要介绍矩阵的理论和应用。当引入矢量时，我们的讨论将遵循第2章中设置的模式:先介绍数学定义，然后提供几何解释。本章主要分为以下3节:</p><ul><li>第4.1节将严格从数学角度讨论矩阵的一些基本属性和操作(更多矩阵运算将在第6章中讨论)。</li><li>第4.2节将解释如何以几何方式解读这些属性和操作。</li><li>第4.3节将本书中矩阵的使用放在更大的线性代数领域中来考查。</li></ul><h1 id="4.1-%E7%9F%A9%E9%98%B5%E7%9A%84%E6%95%B0%E5%AD%A6%E5%AE%9A%E4%B9%89" tabindex="-1">4.1 矩阵的数学定义</h1><p>在线性代数中，矩阵是排列成行和列的矩形数字网格。前文将矢量定义为数字的一维数组，矩阵同样可以定义为数字的二维数组(Two-Dimension Aray)。“二维数组”中的“二”来自于行和列，不应与二维矢量或矩阵混淆。因此，矢量是标量的数组，而矩阵则是矢量的数组。<br>下面将分8个小节介绍矩阵，</p><ul><li>第 4.1.1节将介绍矩阵维度的概念，并描述一些矩阵表示法。</li><li>第 4.1.2节将描述方形矩阵。</li><li>第 4.1.3 节将矢量解释为矩阵。</li><li>第 4.1.4节将描述矩阵转置。</li><li>第 4.1.5 节将解释如何将矩阵乘以标量。</li><li>第 4.1.6节将解释如何将矩阵乘以另一个矩阵。</li><li>第 4.1.7节将解释如何将矢量乘以矩阵。</li><li>第 4.1.8 节将比较行和列矢量的矩阵。</li></ul><h2 id="4.1.1-%E7%9F%A9%E9%98%B5%E7%BB%B4%E5%BA%A6%E5%92%8C%E8%A1%A8%E7%A4%BA%E6%B3%95" tabindex="-1">4.1.1 矩阵维度和表示法</h2><ol><li>对于具有<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></eq>行和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq>列的矩阵,称为是<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>×</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">r \times c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq>(读作“<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></eq>乘<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq>”)，例如下面的4×3矩阵。<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.1%20%E7%9F%A9%E9%98%B5%E8%A1%A8%E7%A4%BA.png" alt></li><li>用大写字母表示矩阵变量，如<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle><mtext>、</mtext><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle><mtext>、</mtext><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>R</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}、\pmb{A}、\pmb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span class="mord cjk_fallback">、</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span><span class="mord cjk_fallback">、</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span></eq>，而矩阵中的元素则使用下标表示法，通常使用小写斜体字母。<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.1%20%E7%9F%A9%E9%98%B5%E5%AD%97%E6%AF%8D%E8%A1%A8%E7%A4%BA.png" alt></li></ol><h2 id="4.1.2-%E6%96%B9%E5%BD%A2%E7%9F%A9%E9%98%B5" tabindex="-1">4.1.2 方形矩阵</h2><ol><li>具有相同行数和列数的矩阵称为<strong>方形矩阵</strong>。</li><li><strong>方阵的对角元素是行和列索引相同的元素</strong>，例如3×3矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>的<strong>对角元素是</strong><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>11</mn></msub><mo separator="true">,</mo><msub><mi>m</mi><mn>22</mn></msub><mo separator="true">,</mo><msub><mi>m</mi><mn>33</mn></msub></mrow><annotation encoding="application/x-tex">m_{11},m_{22},m_{33}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">33</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>，<strong>其他元素是非对角元素</strong><br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.2%20%E5%AF%B9%E8%A7%92%E5%85%83%E7%B4%A0.png" alt></li><li>如果矩阵中的所有非对角元素都为零，则该矩阵为<strong>对角矩阵</strong>(DiagonalMatrix)。以下4x4矩阵就是一个对角矩阵:<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.2%20%E5%AF%B9%E8%A7%92%E7%9F%A9%E9%98%B5.png" alt></li><li>对角线上的值为1，其他元素均为0，且为<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></eq>矩阵，则称为<strong>单位矩阵</strong>，表示为<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>I</mi></mstyle><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">\pmb{I}_{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>，一般上下文清楚的情况下可以省去下标<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></eq>，即<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>I</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{I}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span></eq><br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.2%20%E5%8D%95%E4%BD%8D%E7%9F%A9%E9%98%B5.png" alt></li><li>单位矩阵在矩阵中的意义就相当于标量中的1，任何矩阵乘以单位矩阵都等于自身。</li></ol><h2 id="4.1.3-%E4%BD%9C%E4%B8%BA%E7%9F%A9%E9%98%B5%E7%9A%84%E7%9F%A2%E9%87%8F" tabindex="-1">4.1.3 作为矩阵的矢量</h2><ol><li>矩阵可以包含任何正数的行和列，这个正数也可以是1。</li><li>一行或一列的矩阵也可被称为矢量，维数n的矢量可以被是为1×n矩阵，或者n×1的矩阵。1×n矩阵称为行矢量，n×1称为列矢量。<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.3%20%E4%BD%9C%E4%B8%BA%E7%9F%A9%E9%98%B5%E7%9A%84%E7%9F%A2%E9%87%8F.png" alt></li></ol><h2 id="4.1.4-%E7%9F%A9%E9%98%B5%E8%BD%AC%E7%BD%AE" tabindex="-1">4.1.4 矩阵转置</h2><ol><li>给定<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>×</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">r\times c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq>矩阵，<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>的转置(Transpose)表示为<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\pmb{M}^{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9146em;"></span><span class="mord"><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9146em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></eq>，是<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>×</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">c\times r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></eq>矩阵，其中，列由<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>的行构成。换句话说，<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle><mo>=</mo><msup><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\pmb{M}=\pmb{M}^{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9146em;"></span><span class="mord"><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9146em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></eq>。这实际上是以对角方式“翻转”矩阵。以下式(4.1)和式(4.2)显示了两个转置矩阵的例子:<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.3%20%E8%BD%AC%E7%BD%AE%E7%9F%A9%E9%98%B5.png" alt></li><li>对于矢量，转置会将行矢量转换为列矢量，反之亦然。列矢量一般会用转置表示法写成<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">[a,b,c]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></eq><br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.3%20%E8%A1%8C%E5%88%97%E7%9F%A2%E9%87%8F%E8%BD%AC%E7%BD%AE.png" alt></li><li>转置的特性：<ul><li>对于任何维度的矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>,则<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle><mi>T</mi></msup><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">(\pmb{M}^{T})^{T}=\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1646em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9146em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>。即如果先转置矩阵，然后再转置一次，即可得到原始矩阵。</li><li>任何对角矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>D</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span></eq>等于其转置：<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>D</mi></mstyle><mi>T</mi></msub><mo>=</mo><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>D</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{D}_{T}=\pmb{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span></eq>。单位矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>I</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{I}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span></eq>也是。</li></ul></li></ol><h2 id="4.1.5-%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%A0%87%E9%87%8F%E7%9B%B8%E4%B9%98" tabindex="-1">4.1.5 矩阵与标量相乘</h2><p>矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>可以与标量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></eq>相乘，得到与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>相同维度的矩阵。结果矩阵 <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">k\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>中的每个元素是<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></eq>与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>中相应元素的乘积。例如，<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.5%20%E7%9F%A9%E9%98%B5%E4%B8%8E%E6%A0%87%E9%87%8F%E7%9B%B8%E4%B9%98.png" alt></p><h2 id="4.1.6-%E4%B8%A4%E4%B8%AA%E7%9F%A9%E9%98%B5%E7%9B%B8%E4%B9%98" tabindex="-1">4.1.6 两个矩阵相乘</h2><ol><li>两个矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle><mtext>、</mtext><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{A}、\pmb{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span><span class="mord cjk_fallback">、</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq>相乘时，需要满足<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span></span></span></span></eq>的列数与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq>中的行数相等，否则无法相乘。</li><li>矩阵乘法的计算如下：<br>设矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>C</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{C}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></span></eq>为<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">r\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></eq>矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span></span></span></span></eq>与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">n\times c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq>矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq>的<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>×</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">r\times c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq>乘积<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi><mi>B</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq>。然后每个元素<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq>等于<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span></span></span></span></eq>的行<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></eq>与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq>的列<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></eq>的矢量点积，其用计算公式表述如下:<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>a</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>b</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c_{ij}=\sum\limits_{k=1}^{n}a_{ik}b_{kj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.3535em;vertical-align:-1.0021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3514em;"><span style="top:-2.0979em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.95em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">ik</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq><br>简单的描述一下:对于结果中的每个元素<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq>，找到<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span></span></span></span></eq>中的第<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></eq>行和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq>中的第<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></eq>列:将行和列的相应元素相乘，并对积求和,<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span></eq>等于此总和，它相当于<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span></span></span></span></eq>中第<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></eq>行和<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></eq>中的第<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></eq>列的点积。例如<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.6%20%E4%B8%A4%E4%B8%AA%E7%9F%A9%E9%98%B5%E4%B9%98%E7%A7%AF.png" alt><br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.6%20%E4%B8%A4%E4%B8%AA%E7%9F%A9%E9%98%B5%E4%B9%98%E7%A7%AF1.png" alt><br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.6%20%E4%B8%A4%E4%B8%AA%E7%9F%A9%E9%98%B5%E4%B9%98%E7%A7%AF2.png" alt></li><li><strong>矩阵乘法的总结：</strong><ul><li>（1）将任何矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>乘以一个方形矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>S</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span></eq>(<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>S</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span></eq>放在哪一边都可以，即<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi><mi>S</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{MS}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05764em;">MS</span></span></span></span></span></eq>或<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>S</mi><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{SM}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">SM</span></span></span></span></span></eq>都行)将得到与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq> 大小相同的矩阵，条件是矩阵的大小允许乘法。如果<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>S</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span></eq>是单位矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>I</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{I}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span></eq>，则结果是原始矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>:<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>I</mi></mstyle><mo>=</mo><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>I</mi></mstyle><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle><mo>=</mo><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}\pmb{I}=\pmb{I}\pmb{M}=\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq></li><li>（2）矩阵乘法不可交换（没有交换律）<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle><mo mathvariant="normal">≠</mo><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{A} \pmb{B} \neq \pmb{B} \pmb{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span></span></span></span></eq></li><li>（3）矩阵乘法可以结合（有结合律），可以拓展到多个矩阵相乘的情况<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mo stretchy="false">)</mo></mstyle><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>C</mi></mstyle><mo>=</mo><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mo stretchy="false">(</mo><mi>B</mi><mi>C</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">\pmb{(AB)} \pmb{C} = \pmb{A} \pmb{(BC)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mclose">)</span></span></span></span></span></eq></li><li>（4）矩阵乘法可以与标量或矢量结合<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>k</mi><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle><mo stretchy="false">)</mo><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle><mo>=</mo><mi>k</mi><mo stretchy="false">(</mo><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi><mi>B</mi></mstyle><mo stretchy="false">)</mo><mo>=</mo><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle><mo stretchy="false">(</mo><mi>k</mi><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle><mo stretchy="false">)</mo><mtext>，</mtext><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mo stretchy="false">(</mo><mi>v</mi><mi>A</mi><mo stretchy="false">)</mo></mstyle><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle><mo>=</mo><mi>v</mi><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mo stretchy="false">)</mo></mstyle></mrow><annotation encoding="application/x-tex">(k\pmb{A}) \pmb{B}=k(\pmb{AB})=\pmb{A} (k\pmb{B})，\pmb{(vA)}  \pmb{B}=v\pmb{(AB)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span><span class="mclose">)</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span class="mclose">)</span><span class="mord cjk_fallback">，</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></span></eq></li><li>（5）转置两个矩阵的乘积与以相反顺序取得其转置的乘积相同，可以拓展到多个矩阵转置的情况<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><mo stretchy="false">)</mo></mstyle><mi>T</mi></msup><mo>=</mo><msup><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>B</mi></mstyle><mi>T</mi></msup><msup><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>A</mi></mstyle><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\pmb{(AB)}^T=\pmb{B}^T\pmb{A}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2312em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9146em;"></span><span class="mord"><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9146em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal">A</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9146em;"><span style="top:-3.1362em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></eq></li></ul></li></ol><h2 id="4.1.7-%E7%9F%A2%E9%87%8F%E5%92%8C%E7%9F%A9%E9%98%B5%E7%9B%B8%E4%B9%98" tabindex="-1">4.1.7 矢量和矩阵相乘</h2><ol><li>由于矢量可以被认为是具有一行或一列的矩阵，因此可以通过第4.1.6节中讨论<br>的规则将矢量和矩阵相乘。<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.1.7%20%E7%9F%A2%E9%87%8F%E5%92%8C%E7%9F%A9%E9%98%B5%E7%9B%B8%E4%B9%98.png" alt><br>不难发现，当将左侧的行矢量乘以右侧的矩阵时，如式(4.4)所示，其结果是行矢量;当将左边的矩阵乘以右边的列矢量时，如式(4.5)所示，其结果是列矢量。</li><li>矢量与矩阵乘法的总结：</li></ol><ul><li><strong>结果矢量中的每个元素是原始矢量与矩阵中的单个行或列的点积</strong>。</li><li>矩阵中的每个元素确定输入矢量中的特定元素对输出矢量中的元素有多大的“权重”。例如，在式(4.4)中，当使用行矢量时，<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">m_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>控制输入的x值有多少输出到了y值。<br>矢量与矩阵乘法分布在矢量加法上 <strong>(分配律)</strong> ，即对于矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>v</mi></mstyle><mtext>、</mtext><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>w</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{v}、\pmb{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span class="mord cjk_fallback">、</span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span></eq>和矩阵<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle style="text-shadow: 0.02em 0.01em 0.04px"><mi>M</mi></mstyle></mrow><annotation encoding="application/x-tex">\pmb{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="text-shadow:0.02em 0.01em 0.04px;"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></span></eq>，有<br><section><eqn><span class="katex-error" title="ParseError: KaTeX parse error: Unexpected end of input in a macro argument, expected &#x27;}&#x27; at end of input: \pmb" style="color:#cc0000">\pmb</span></eqn></section></li><li>乘法的结果是矩阵的行或列的线性组合。例如，在式(4.5)中，<strong>当使用列矢量时，得到的列矢量可以被解释为矩阵的列的线性组合，其中的系数来自矢量操作数</strong>。这是一个关键事实，不仅对于学习3D数学有用，而且对于一般的线性代数来说也很重要，所以<strong>请记住它</strong>。</li></ul><h2 id="4.1.8-%E8%A1%8C%E4%B8%8E%E5%88%97%E7%9F%A2%E9%87%8F" tabindex="-1">4.1.8 行与列矢量</h2><p>本节将解释为什么行和列矢量之间的区别很重要，并给出选择行矢量的基本原理。</p><ol><li><p>在式(4.4)中，当将左侧的行矢量与右侧的矩阵相乘时，得到的是以下行矢量:<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><msub><mi>m</mi><mn>11</mn></msub><mo>+</mo><mi>y</mi><msub><mi>m</mi><mn>21</mn></msub><mo>+</mo><mi>z</mi><msub><mi>m</mi><mn>31</mn></msub><mspace width="1em"><mi>x</mi><msub><mi>m</mi><mn>12</mn></msub><mo>+</mo><mi>y</mi><msub><mi>m</mi><mn>22</mn></msub><mo>+</mo><mi>z</mi><msub><mi>m</mi><mn>32</mn></msub><mspace width="1em"><mi>x</mi><msub><mi>m</mi><mn>13</mn></msub><mo>+</mo><mi>y</mi><msub><mi>m</mi><mn>23</mn></msub><mo>+</mo><mi>z</mi><msub><mi>m</mi><mn>33</mn></msub><mo stretchy="false">]</mo></mspace></mspace></mrow><annotation encoding="application/x-tex">[xm_{11}+ym_{21}+zm_{31} \quad xm_{12}+ym_{22}+zm_{32}\quad xm_{13}+ym_{23}+zm_{33} ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">13</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">23</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">33</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></eqn></section></p></li><li><p>将其与式(4.5)的结果进行比较，当右侧的列矢量乘以左侧的矩阵时，得到的是以下列矢量结果:<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><msub><mi>m</mi><mn>11</mn></msub><mo>+</mo><mi>y</mi><msub><mi>m</mi><mn>12</mn></msub><mo>+</mo><mi>z</mi><msub><mi>m</mi><mn>13</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><msub><mi>m</mi><mn>21</mn></msub><mo>+</mo><mi>y</mi><msub><mi>m</mi><mn>22</mn></msub><mo>+</mo><mi>z</mi><msub><mi>m</mi><mn>23</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><msub><mi>m</mi><mn>31</mn></msub><mo>+</mo><mi>y</mi><msub><mi>m</mi><mn>32</mn></msub><mo>+</mo><mi>z</mi><msub><mi>m</mi><mn>33</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left[\begin{matrix}xm_{11}+ym_{12}+zm_{13} \\ xm_{21}+ym_{22}+zm_{23}\\ xm_{31}+ym_{32}+zm_{33}\end{matrix}\right] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">13</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">23</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">31</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">33</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><br>如果忽略<strong>它们一个是行矢量而另一个是列矢量的事实会发现，矢量分量的值是不一样的</strong>!这就是行和列矢量之间的区别如此重要的原因。</p></li><li><p>行矢量会导致非常“宽”的公式。<strong>将列矢量放在右侧肯定会使公式看起来更精简</strong>，特别是随着维度的增加，这种差别更加明显。<strong>列矢量几乎是所有其他学科中的通用标准</strong></p></li></ol><h1 id="4.2-%E7%9F%A9%E9%98%B5%E7%9A%84%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A" tabindex="-1">4.2 矩阵的几何解释</h1><ol><li>一般来说，方形矩阵可以描述任何线性变换(LinearTransformation)线性变换可以“拉伸”坐标空间，但它不会“弯曲”或“扭曲”它。这是一组非常有用的变换，包括:</li></ol><ul><li>旋转</li><li>比例缩放</li><li>正交投影</li><li>反射</li><li>错切</li></ul><ol start="2"><li><p>第5章将推导出所有执行这些操作的矩阵。先来看以下2x2矩阵:<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>M</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">M=\left[\begin{matrix}2 &amp; 1 \\-1 &amp; 2\end{matrix}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></eqn></section><br>这个矩阵代表什么样的变换呢?首先，从矩阵的行中提取基矢量<strong>p</strong>和<strong>q</strong>:<br><strong>p</strong>=[2 1];<br><strong>q</strong>=[-1 2]<br>在图 4.1 中，将+x基矢量变换为上面标记为<strong>p</strong>的矢量，并将+y基矢量变换为标记为<strong>q</strong>的矢量。因此，在二维中可视化矩阵的一种方法是可视化由行矢量形成的L形状。在本示例中可以很容易地看到，由矩阵<strong>M</strong>表示的变换的一部分是大约26.5°的逆时针旋转的。<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.2%20%E5%8F%AF%E8%A7%86%E5%8C%96%E4%BA%8C%E7%BB%B4%E7%9F%A9%E9%98%B5%E7%9A%84%E8%A1%8C%E7%9F%A2%E9%87%8F.png" alt><br>在图 4.2中形成的这个二维平行四边形也称为倾斜框(Skew Box)。在框内绘制个对象也有助于可视化变换，如图 4.3所示。<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.2%20%E6%A1%86%E5%86%85%E7%BB%98%E5%88%B6%E5%8F%AF%E8%A7%86%E5%8C%96%E5%8F%98%E6%8D%A2.png" alt></p></li><li><p>现在考虑三维变换矩阵<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>M</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.707</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>0.707</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.250</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1.250</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">M=\left[\begin{matrix}0.707 &amp; -0.707 &amp; 0 \\1.250 &amp; 1.250 &amp; 0 \\0 &amp; 0 &amp; 1\end{matrix}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.707</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1.250</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">0.707</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1.250</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><br>从该矩阵的行中提取基矢量，可以看到由该矩阵表示的变换。变换后的基矢量、立方体和茶壶如图 4.5 所示。<br><img src="/2024/11/24/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E7%9F%A9%E9%98%B5%E7%AE%80%E4%BB%8B/4.2%20%E6%A1%86%E5%86%85%E7%BB%98%E5%88%B6%E5%8F%AF%E8%A7%86%E5%8C%96%E5%8F%98%E6%8D%A2-%E4%B8%89%E7%BB%B4.png" alt><br>从图 4.5 中可以看到，变换包括围绕z轴顺时针旋转45°以及使茶壶比原来“更高的非均匀刻度。</p></li><li><p>本节内容回顾</p></li></ol><ul><li>方形矩阵的行可以解释为坐标空间的基矢量。</li><li>要将矢量从原始坐标空间变换到新坐标空间，可以将失量乘以矩阵。</li><li>从原始坐标空间到由这些基矢量定义的坐标空间的变换是线性变换。线性变换将保留直线，平行线也将保持平行。但是，角度、长度、面积和体积等可能在变换后发生改变。</li><li>将零矢量乘以任何方形矩阵，得到的是零矢量。因此，由方形矩阵表示的线性变换将具有与原始坐标空间相同的原点，这意味着变换不包含平移。</li><li>我们可以通过可视化变换后坐标空间的基失量来可视化矩阵。这些基矢量在二维中会形成L形，而在三维中形成的则是三脚架。使用倾斜框或辅助对象也有助于可视化。</li></ul><h1 id="4.3-%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E7%9A%84%E5%AE%8F%E5%A4%A7%E5%9B%BE%E6%99%AF" tabindex="-1">4.3 线性代数的宏大图景</h1><ol><li>线性代数被发明用于操纵和求解线性方程组。<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo>−</mo><mn>5</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mo>−</mo><mn>10</mn><mspace linebreak="newline"></mspace><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><mi>x</mi><mo>+</mo><mn>2</mn><mo>+</mo><mn>4</mn><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>12</mn><mspace linebreak="newline"></mspace><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>3</mn><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">-5x_1+x_2+x_3=-10 \\2x_1+2x+2+4x_3=12 \\x_1-3x_3 = 9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">−</span><span class="mord">5</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">10</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">12</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7944em;vertical-align:-0.15em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">9</span></span></span></span></span></eqn></section></li></ol><p>的解是<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>3</mn><mo separator="true">,</mo><mspace linebreak="newline"></mspace><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>7</mn><mo separator="true">,</mo><mspace linebreak="newline"></mspace><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">x_1=3, \\x_2=7, \\x_3=-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">3</span><span class="mpunct">,</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">7</span><span class="mpunct">,</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord">2</span></span></span></span></span></eqn></section></p><ol start="2"><li>上面的方程组和求解结果可以写为以下形式：<br><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>5</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>3</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>x</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>10</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>12</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>9</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\left[\begin{matrix}-5 &amp; 1 &amp; 1 \\2 &amp; 2 &amp; 4 \\1 &amp; 0 &amp; -3\end{matrix}\right]\left[\begin{matrix}x_1\\x_2\\x_3\end{matrix}\right]=\left[\begin{matrix}-10\\12\\9\end{matrix}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">5</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord">10</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">12</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewbox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section></li><li>在游戏中，也许必须求解大型方程组的最直接和最明显的地方是物理引擎。传统线性代数方法出现的另一个常见地方是最小二乘近似(Least Squares Approximation)和其他数据拟合应用。</li><li>要学习和理解线性代数和科学计算的宏大图景,推荐一个很好的资源,那就是Gilbert Strang 教授的系列讲座，你可以从ocw.mit.edu的MIT OpenCourseWare(麻省理工学院公<br>开课)免费下载。他提供本科阶段基础线性代数课程以及计算科学和工程专业的研究生课程。他为他的班级编写的教科书(详见本书参考文献[67，68])是针对工程师(而不是数学家)的并且让人心情愉快的读物，并且获得了推荐，但要注意他的写作风格是一种速记式的，所以，如果你没有听课，可能会遇到一些理解上的困难。</li></ol><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;矩阵在3D数学中具有根本意义上的重要性,它们主要用于描述两个坐标空间之间的关系。它们通过定义将矢量从一个坐标空间转换为另一个坐标空间来实现此目的。&lt;/p&gt;</summary>
    
    
    
    <category term="3D数学基础" scheme="http://example.com/categories/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="3D数学基础" scheme="http://example.com/tags/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>3D数学基础-图形和游戏开发-学习笔记 第三章 多个坐标空间</title>
    <link href="http://example.com/2024/10/04/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4/"/>
    <id>http://example.com/2024/10/04/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4/</id>
    <published>2024-10-04T06:31:30.000Z</published>
    <updated>2024-11-24T10:54:06.722Z</updated>
    
    <content type="html"><![CDATA[<p>开发人员会为特定的理由构建坐标空间（有经验的老手可能会告诉你说“在不同的情况下需要不同的空间”）。</p><span id="more"></span><ul><li><a href="#31-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4">3.1 为什么需要多个坐标空间</a></li><li><a href="#32-%E4%B8%80%E4%BA%9B%E6%9C%89%E7%94%A8%E7%9A%84%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4">3.2 一些有用的坐标空间</a><ul><li><a href="#321-%E4%B8%96%E7%95%8C%E7%A9%BA%E9%97%B4">3.2.1 世界空间</a></li><li><a href="#322-%E5%AF%B9%E8%B1%A1%E7%A9%BA%E9%97%B4%E6%A8%A1%E5%9E%8B%E7%A9%BA%E9%97%B4">3.2.2 对象空间（模型空间）</a></li><li><a href="#323-%E7%9B%B8%E6%9C%BA%E7%A9%BA%E9%97%B4%E8%A7%82%E5%AF%9F%E7%A9%BA%E9%97%B4">3.2.3 相机空间（观察空间）</a></li><li><a href="#324-%E7%9B%B4%E7%AB%8B%E7%A9%BA%E9%97%B4">3.2.4 直立空间</a></li></ul></li><li><a href="#33-%E5%9F%BA%E7%9F%A2%E9%87%8F%E5%92%8C%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4%E8%BD%AC%E6%8D%A2">3.3 基矢量和坐标空间转换</a><ul><li><a href="#331-%E5%8F%8C%E9%87%8D%E8%A7%86%E8%A7%92">3.3.1 双重视角</a></li><li><a href="#332-%E6%8C%87%E5%AE%9A%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4">3.3.2 指定坐标空间</a></li><li><a href="#333-%E5%9F%BA%E7%9F%A2%E9%87%8F">3.3.3 基矢量</a></li></ul></li><li><a href="#34-%E5%B5%8C%E5%A5%97%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4">3.4 嵌套坐标空间</a></li><li><a href="#35-%E9%92%88%E5%AF%B9%E7%9B%B4%E7%AB%8B%E7%A9%BA%E9%97%B4%E7%9A%84%E5%86%8D%E8%A7%A3%E9%87%8A">3.5 针对直立空间的再解释</a></li></ul><p>本章主要介绍多个坐标系的概念。它分为以下5个主要小节:- - 第3.1节将证明需要多个坐标系。</p><ul><li>第3.2节将介绍一些常见的坐标系。介绍的主要概念包括:<ul><li>世界空间。</li><li>对象空间。</li><li>相机空间。</li><li>垂直空间。</li></ul></li><li>第3.3节将描述坐标-空间转换。<ul><li>第3.3.1节将揭示两种坐标空间转换的思考方式之间的二元性。</li><li>第3.3.2节将描述如何根据一个坐标系来指定另一个坐标系。</li><li>第3.3.3节将讨论基矢量的非常重要的概念。</li></ul></li><li>第3.4节将讨论嵌套坐标空间,它常用于在三维空间中为分层分割对象设置动画。</li><li>第3.5节将是针对直立空间的强调说明。</li></ul><h1 id="3.1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4" tabindex="-1">3.1 为什么需要多个坐标空间</h1><p>在不同情况下使用不同的坐标空间会更方便</p><h1 id="3.2-%E4%B8%80%E4%BA%9B%E6%9C%89%E7%94%A8%E7%9A%84%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4" tabindex="-1">3.2 一些有用的坐标空间</h1><p>开发人员需要不同的坐标空间，因为某些信息是有意义的或仅在特定上下文环境中可用。</p><h2 id="3.2.1-%E4%B8%96%E7%95%8C%E7%A9%BA%E9%97%B4" tabindex="-1">3.2.1 世界空间</h2><p>（1）世界坐标系是一个特殊的坐标系，它为所有其他要指定的坐标系建立了一个“全局”参考系。换句话说，我们可以用世界坐标空间来表达其他坐标空间的位置，但是我们不能用任何更大的外部坐标空间来表示世界坐标空间。<br>（2）世界坐标空间也称为全局(Global）坐标空间或通用(Universal）坐标空间。</p><h2 id="3.2.2-%E5%AF%B9%E8%B1%A1%E7%A9%BA%E9%97%B4%EF%BC%88%E6%A8%A1%E5%9E%8B%E7%A9%BA%E9%97%B4%EF%BC%89" tabindex="-1">3.2.2 对象空间（模型空间）</h2><p>（1）对象空间（Object Space）是与特定对象关联的坐标空间。<br>（2）每个对象都有自己独立的对象空间。<br>（3）当一个对象移动或改变方向时，与该对象关联的对象坐标空间被随之携带，因此它也会移动或改变方向。<br>（4）可以在对象空间中指定位置和方向。<br>（5）在图形的上下文中，对象空间也称为模型(Model)空间，因为模型顶点的坐标以模型空间表示。对象空间也称为体（Body)空间，特别是在物理环境中。使用像“相对于体轴”这样的短语也是很常见的，这意味着“使用体空间坐标表示”。</p><h2 id="3.2.3-%E7%9B%B8%E6%9C%BA%E7%A9%BA%E9%97%B4%EF%BC%88%E8%A7%82%E5%AF%9F%E7%A9%BA%E9%97%B4%EF%BC%89" tabindex="-1">3.2.3 相机空间（观察空间）</h2><p>（1）对象空间的一个特别重要的示例是<strong>相机空间，其是与用于渲染的视点相关联的对象空间</strong>。<br>（2）在相机空间中，<strong>相机位于原点，+x指向右侧，+z指向前方（进入屏幕，相机朝向的方向)，+y指向“向上”</strong>（注意，这里不是相对于世界的“向上”，而是相对于相机顶部的“向上”）。图3.1显示了相机空间的示意图。<br><img src="/2024/10/04/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4/3.2.3%20%E7%9B%B8%E6%9C%BA%E7%A9%BA%E9%97%B4%E7%A4%BA%E6%84%8F%E5%9B%BE.jpg" alt><br>（3）这些是传统的左手坐标系统约定，其他的都很常见。<strong>特别要指出的是，OpenGL 传统上是右手坐标系统，-z指向屏幕，+z从屏幕出来朝向观众。</strong><br>（4）请仔细注意相机空间(三维空间）与屏幕空间（二维空间)之间的差异。<strong>从相机空间坐标到屏幕空间坐标的映射涉及的操作称为投影</strong>。将在第十章中讨论。</p><h2 id="3.2.4-%E7%9B%B4%E7%AB%8B%E7%A9%BA%E9%97%B4" tabindex="-1">3.2.4 直立空间</h2><p>（1）当要理解坐标空间转换这个主题时，可以通过文字或通过代码与计算机进行通信，<strong>将每个对象与一个新的坐标空间关联在一起，这个新坐标空间我们将其称为对象的直立坐标空间</strong>。<br>（2）在某种意义上，<strong>对象的直立空间是世界空间与其对象空间之间的“中间过渡”</strong>，因为<strong>直立空间的轴线与世界空间的轴线平行，而直立空间的原点则与对象空间的原点重合</strong>。下图在二维中说明了这个原理（请注意，我们已经做出了任意选择，<strong>将原点放在机器人的脚之间，而不是放在她的质心中</strong>）。<br><img src="/2024/10/04/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4/3.2.3%20%E7%9B%B8%E6%9C%BA%E7%A9%BA%E9%97%B4%E7%A4%BA%E6%84%8F%E5%9B%BE.jpg" alt></p><p>（3）在<strong>对象空间和直立空间</strong>之间<strong>转换点</strong>只需要<strong>旋转</strong>；在<strong>直立空间和世界空间</strong>之间<strong>转换点</strong>则只需要更改位置，通常称为<strong>平移</strong>。</p><p>（4）下图演示了坐标空间之间的转换。<strong>世界空间</strong>（图左侧的示意图）可通<strong>过平移原点的方式转换为直立空间</strong>（图中间的示意图）﹔而为了将<strong>直立空间转换为对象空间</strong>，可以<strong>旋转直立空间的轴直到它们与对象空间的轴对齐</strong>。在本示例中，机器人认为她的y轴是从她的脚指向她的头部，并且她的x轴指向她的左边。”我们将在第3.3节中再次讨论这个概念。<br><img src="/2024/10/04/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4/3.2.4%20%E7%9B%B4%E7%AB%8B%E7%A9%BA%E9%97%B4%E7%A4%BA%E6%84%8F%E5%9B%BE.jpg" alt></p><p>（5）在物理学中，质心坐标一般用来描述直立空间中所表示的坐标。</p><h1 id="3.3-%E5%9F%BA%E7%9F%A2%E9%87%8F%E5%92%8C%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4%E8%BD%AC%E6%8D%A2" tabindex="-1">3.3 基矢量和坐标空间转换</h1><p>有时某些问题只能在特定的坐标空间中得到解答。</p><ul><li>3.3.1 将讨论初级视频游戏程序员进场会遇到的转换：图形</li><li>3.3.2 确保我们清楚根据一个坐标空间指定另一个坐标空间意味着什么。</li><li>3.3.3 将介绍基矢量(Basis Vector)的主要思想</li></ul><h2 id="3.3.1-%E5%8F%8C%E9%87%8D%E8%A7%86%E8%A7%92" tabindex="-1">3.3.1 双重视角</h2><p>（1）前面的机器人示例，我们只是<strong>改变了参考框架并且能够使用不同的坐标空间来描述该点，改变了坐标空间！</strong></p><p>如下图所示，将机器人在世界空间的原点进行创建。目前，由于模型处于其原始位置，因此对象空间和世界空间(以及直立空间)根据定义都是相同的。世界空间和对象空间是一致的。<br><img src="/2024/10/04/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4/3.3.1%20%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%A8%A1%E5%9E%8B.png" alt="机器人"></p><p>我们的目标是根据在某一时刻可以执行其想法的机器人所期望的位置和方向，将模型的顶点从其原始位置转换到某个新位置(在我们的示例中，就是要进入一间虚构的厨房)，如下图所示<br><img src="/2024/10/04/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4/3.3.1%20%E6%A8%A1%E5%9E%8B%E7%A7%BB%E5%8A%A8%E7%A4%BA%E6%84%8F.png" alt><br>通过旋转和平移的方式最终将机器人从对象空间变换到世界空间。<strong>（必须是先旋转，再平移）</strong><br><img src="/2024/10/04/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4/3.3.1%20%E5%B0%86%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%BB%8E%E5%AF%B9%E8%B1%A1%E7%A9%BA%E9%97%B4%E5%8F%98%E6%8D%A2%E5%88%B0%E4%B8%96%E7%95%8C%E7%A9%BA%E9%97%B4.png" alt></p><p>（2）<strong>围绕原点的旋转是线性变换，而围绕任何其他点的旋转则是仿射变换</strong>（在第六章中将对仿射变换进行详细说明）</p><h2 id="3.3.2-%E6%8C%87%E5%AE%9A%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4" tabindex="-1">3.3.2 指定坐标空间</h2><ul><li>指定坐标空间的位置，即描述原点的位置</li><li>指定坐标空间的方向，即通过告知<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo><mi>x</mi><mo separator="true">,</mo><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">+x,+y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord">+</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">+</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq>的方向来描述.(在二维中还可以通过角度进行方向的描述-极坐标)</li></ul><h2 id="3.3.3-%E5%9F%BA%E7%9F%A2%E9%87%8F" tabindex="-1">3.3.3 基矢量</h2><ol><li>任意矢量可以扩展为基矢量的线性组合：<br>在这里，<strong>p、q和r</strong>是三维空间的基矢量(Basis Vector)，大多数时候<strong>p</strong>=[1,0,0],<strong>q</strong>=[0,1,0],<strong>r</strong>=[0,0,1]<br><img src="/2024/10/04/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%A4%9A%E4%B8%AA%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4/3.3.2%20%E5%9F%BA%E7%9F%A2%E9%87%8F-%E7%BA%BF%E6%80%A7%E7%BB%84%E5%90%88.png" alt></li><li>有很多书籍通过用世界基矢量定义所有矢量，“世界基矢量”通常表示为i、j、k，并且被解释为不能进一步分解的元素实体。</li><li>当我们说正在使用标准基时，这相当于说，我们只涉及一个单一的坐标空间。这与我们所称的坐标空间没有区别，因为我们无法在不引入基矢量的情况下引用任何其他坐标空间。<strong>当我们考虑任何替代基时，则隐式地引入了另一个坐标空间:用于测量基矢量的坐标空间!</strong></li><li>基矢量的坐标是根据参考帧测量的，该参考帧与基所在的坐标空间不同。因此，基矢量与坐标空间变换密切相关。</li><li>基矢量有可能会选的“很糟糕”，一般会假设他们具有相同的长度且相互垂直(<strong>一组相互垂直的基矢量称为正交基，如果长度也相同，那么称为标准正交基</strong>)，但有时情况并非如此。</li><li>可以表示为基矢量的线性组合的矢量集称为基矢量的跨度。</li><li>一组线性相关的矢量对于基来说是一个糟糕的选择。</li><li>矢量相对于给定基的数值坐标是该矢量作为基失量的线性组合的扩展中的系数，例<br>如，<strong>a</strong>=<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">a_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq><strong>p</strong>+<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">a_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq><strong>q</strong>。</li><li><strong>当基矢量正交时，坐标是解耦的</strong>。矢量<strong>v</strong>的任何给定坐标可以仅由<strong>v</strong>和相应的基矢<br>量确定。例如，如果其他基矢量垂直于P，那么可以计算仅知道p的<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">v_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>。</li><li>在标准正交基中，矢量<strong>v</strong>的每个坐标是在对应的基矢量的方向上测量的有符号的位<br>移<strong>v</strong>。这可以通过直接计算<strong>v</strong>与该基矢量的<strong>点积</strong>来获得。<br>因此，在标准正交基的特殊情况下，有一种简单的方法来<strong>确定体空间坐标，只知道<br>体轴的世界坐标</strong>。因此，假设<strong>p</strong>、<strong>q</strong>和<strong>r</strong>构成标准正交基，<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">b_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>=<strong>u·P</strong>，<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">b_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></eq>=<strong>u·q</strong>，<br><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>z</mi></msub></mrow><annotation encoding="application/x-tex">b_z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>=<strong>u·r</strong></li></ol><h1 id="3.4-%E5%B5%8C%E5%A5%97%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4" tabindex="-1">3.4 嵌套坐标空间</h1><ol><li>三维虚拟世界中的每个对象都有自己的坐标空间——它自己的原点和轴。例如，它的原点可以位于其质心处。它的轴将指定它认为相对于其原点的“向上”“向右”“向<br>前”的方向。由美术设计师为虚拟世界创建的三维模型将由该设计师决定其原点和轴，并且构成多边形网格的点将相对于由该原点和轴定义的对象空间。例如，绵羊的中心可以<br>放置在(0.0.0)，其鼻尖位于(0,0,1.5)，尾部尖端位于(0,0,-1.2)，右耳尖位于(0.5,0.2,1.2)。这些坐标是绵羊的对象空间中这些部分的位置。<br>绵羊的各个部分可以利用世界空间的相对位置计算出来。</li><li>可以将世界空间视为“父”空间，将对象空间视为“子”空间。还可很方便地将对象分解为子对象并单独为其设置动画。<br>分解为这样的层次结构的模型有时被称为关节模型(Articulated Model)。</li></ol><h1 id="3.5-%E9%92%88%E5%AF%B9%E7%9B%B4%E7%AB%8B%E7%A9%BA%E9%97%B4%E7%9A%84%E5%86%8D%E8%A7%A3%E9%87%8A" tabindex="-1">3.5 针对直立空间的再解释</h1><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;开发人员会为特定的理由构建坐标空间（有经验的老手可能会告诉你说“在不同的情况下需要不同的空间”）。&lt;/p&gt;</summary>
    
    
    
    <category term="3D数学基础" scheme="http://example.com/categories/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="3D数学基础" scheme="http://example.com/tags/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>3D数学基础-图形和游戏开发-学习笔记 第二章 矢量</title>
    <link href="http://example.com/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/"/>
    <id>http://example.com/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/</id>
    <published>2024-09-21T14:35:36.000Z</published>
    <updated>2024-11-20T14:27:12.808Z</updated>
    
    <content type="html"><![CDATA[<p>矢量(Vector)是用于构建2D和3D数学的正式数学单元</p><span id="more"></span><h1 id="%E7%9B%AE%E5%BD%95" tabindex="-1">目录</h1><ul><li><a href="#%E7%9B%AE%E5%BD%95">目录</a></li><li><a href="#21-%E5%90%91%E9%87%8F%E5%92%8C%E5%85%B6%E4%BB%96%E7%9A%84%E6%95%B0%E5%AD%A6%E7%9A%84%E5%AE%9A%E4%B9%89">2.1 向量和其他的数学的定义</a></li><li><a href="#22-%E7%9F%A2%E9%87%8F%E7%9A%84%E5%87%A0%E4%BD%95%E5%AE%9A%E4%B9%89">2.2 矢量的几何定义</a></li><li><a href="#23-%E4%BD%BF%E7%94%A8%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E6%8C%87%E5%AE%9A%E7%9F%A2%E9%87%8F">2.3 使用笛卡尔坐标指定矢量</a><ul><li><a href="#231-%E4%BD%9C%E4%B8%BA%E4%BD%8D%E7%A7%BB%E5%BA%8F%E5%88%97%E7%9A%84%E7%9F%A2%E9%87%8F">2.3.1 作为位移序列的矢量</a></li><li><a href="#232-%E9%9B%B6%E7%9F%A2%E9%87%8F">2.3.2 零矢量</a></li></ul></li><li><a href="#24-%E7%9F%A2%E9%87%8F%E4%B8%8E%E7%82%B9">2.4 矢量与点</a><ul><li><a href="#241-%E7%9B%B8%E5%AF%B9%E4%BD%8D%E7%BD%AE">2.4.1 相对位置</a></li><li><a href="#242-%E7%82%B9%E4%B8%8E%E7%9F%A2%E9%87%8F%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB">2.4.2 点与矢量之间的关系</a></li></ul></li><li><a href="#25-%E8%B4%9F%E7%9F%A2%E9%87%8F">2.5 负矢量</a><ul><li><a href="#251-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99">2.5.1 正式线性代数规则</a></li><li><a href="#252-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A">2.5.2 几何解释</a></li></ul></li><li><a href="#26-%E6%A0%87%E9%87%8F%E5%92%8C%E7%9F%A2%E9%87%8F%E7%9A%84%E4%B9%98%E6%B3%95">2.6 标量和矢量的乘法</a><ul><li><a href="#261-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99">2.6.1 正式线性代数规则</a></li><li><a href="#262-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A">2.6.2 几何解释</a></li></ul></li><li><a href="#27-%E7%9F%A2%E9%87%8F%E7%9A%84%E5%8A%A0%E6%B3%95%E5%92%8C%E5%87%8F%E6%B3%95">2.7 矢量的加法和减法</a><ul><li><a href="#271-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99">2.7.1 正式线性代数规则</a></li><li><a href="#272-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A">2.7.2 几何解释</a></li><li><a href="#273-%E4%BB%8E%E4%B8%80%E7%82%B9%E5%88%B0%E5%8F%A6%E4%B8%80%E7%82%B9%E7%9A%84%E4%BD%8D%E7%A7%BB%E7%9F%A2%E9%87%8F">2.7.3 从一点到另一点的位移矢量</a></li></ul></li><li><a href="#28-%E7%9F%A2%E9%87%8F%E5%A4%A7%E5%B0%8F">2.8 矢量大小</a><ul><li><a href="#281-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99">2.8.1 正式线性代数规则</a></li><li><a href="#282-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A">2.8.2 几何解释</a></li></ul></li><li><a href="#29-%E5%8D%95%E4%BD%8D%E7%9F%A2%E9%87%8F">2.9 单位矢量</a><ul><li><a href="#291-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99">2.9.1 正式线性代数规则</a></li><li><a href="#292-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A">2.9.2 几何解释</a></li></ul></li><li><a href="#210-%E8%B7%9D%E7%A6%BB%E5%85%AC%E5%BC%8F">2.10 距离公式</a></li><li><a href="#211-%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF">2.11 矢量点积</a><ul><li><a href="#2111-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99">2.11.1 正式线性代数规则</a></li><li><a href="#2112-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A">2.11.2 几何解释</a></li></ul></li><li><a href="#212-%E7%9F%A2%E9%87%8F%E5%8F%89%E7%A7%AF">2.12 矢量叉积</a><ul><li><a href="#2121-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99">2.12.1 正式线性代数规则</a><ul><li><a href="#2122-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A">2.12.2 几何解释</a></li></ul></li><li><a href="#213-%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F">2.13 线性代数恒等式</a></li></ul></li></ul><h1 id="2.1-%E5%90%91%E9%87%8F%E5%92%8C%E5%85%B6%E4%BB%96%E7%9A%84%E6%95%B0%E5%AD%A6%E7%9A%84%E5%AE%9A%E4%B9%89" tabindex="-1">2.1 向量和其他的数学的定义</h1><p>（1）对于数学家来说，向量是一个数字列表（数组）。数学家会区分向量和标量。标量其实就是普通数字的技术术语。当希望强调特定的数量而不是向量数量时，就会特意使用这个术语。例如，速度（Velocity）和位移（Displacement）都是向量，而速率（Speed）和距离（Distance）则是标量。<br>向量的维度（Dimension）表示包含的向量的数量。<br>（2）在书写向量时，会列出由方括号包围的数字，例如[1,2,3]。。当我们用公式写出来时，通常会省略逗号。在任何一种情况下，水平写入的向量称为行向量(Row Vector)。垂直写入的向量称为列向量(Column Vector)。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.1%20%E5%88%97%E5%90%91%E9%87%8F.jpg" alt></p><p>（3）向量中的各个分量，使用下标表示法，常用x,y,z,w表示一、二、三、四维度中的向量。例如使用x和y来指代二维向量中的元素;使用x、y和z表示三维向量中的元素;使用x、y、z和w表示四维向量中的元素。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.1%20%E5%90%91%E9%87%8F%E8%A1%A8%E7%A4%BA%E6%B3%95.jpg" alt></p><p>（4）书中向量的书写规定。</p><ul><li>标量变量由斜体字的小写罗马字母或希腊字母表示，如<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mtext>、</mtext><mi>b</mi><mtext>、</mtext><mi>x</mi><mtext>、</mtext><mi>y</mi><mtext>、</mtext><mi>z</mi><mtext>、</mtext><mi>θ</mi><mtext>、</mtext><mi>α</mi><mtext>、</mtext><mi>ω</mi><mtext>和</mtext><mi>γ</mi></mrow><annotation encoding="application/x-tex">a、b、x、y、z、\theta、\alpha、\omega和\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal">b</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal">x</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mord cjk_fallback">和</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span></eq>等。</li><li>任何维度的向量变量由粗体小写字母表示，如 <strong>a</strong>、<strong>b</strong>、 <strong>u</strong>、 <strong>v</strong>、<strong>q</strong>和<strong>r</strong>等。</li><li>矩阵变量使用粗体大写字母表示，如<strong>A</strong>、<strong>B</strong>、<strong>M</strong>和<strong>R</strong>等。</li></ul><p>（5）主要处理向量和矩阵的数学分支称为线性代数（Linear Algebra）</p><h1 id="2.2-%E7%9F%A2%E9%87%8F%E7%9A%84%E5%87%A0%E4%BD%95%E5%AE%9A%E4%B9%89" tabindex="-1">2.2 矢量的几何定义</h1><p>（1）向量（矢量） 是具有大小和方向的有向线段</p><ul><li>矢量的大小（Magnitude）是指矢量的长度。矢量可以具有任何非负长度。</li><li>矢量的方向（Direction）描述矢量在空间中指向的方向。</li></ul><p>（2）矢量的示意图</p><ul><li>示意图能够体现矢量的大小和方向<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.2%20%E7%9F%A2%E9%87%8F%E7%9A%84%E5%87%A0%E4%BD%95%E5%AE%9A%E4%B9%89.jpg" alt></li></ul><h1 id="2.3-%E4%BD%BF%E7%94%A8%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E6%8C%87%E5%AE%9A%E7%9F%A2%E9%87%8F" tabindex="-1">2.3 使用笛卡尔坐标指定矢量</h1><p>（1）当使用笛卡儿坐标来描述矢量时，每个坐标将度量相应维度中的有符号位移。二维矢量表示示意图如下：<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.3%20%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB%E7%9F%A2%E9%87%8F%E8%A1%A8%E7%A4%BA.jpg" alt><br>三维矢量是二维矢量的简单扩展。三维矢量包含3个数字，它们可以度量x、y和z方向上的有符号位移。</p><h2 id="2.3.1-%E4%BD%9C%E4%B8%BA%E4%BD%8D%E7%A7%BB%E5%BA%8F%E5%88%97%E7%9A%84%E7%9F%A2%E9%87%8F" tabindex="-1">2.3.1 作为位移序列的矢量</h2><p>考虑通过矢量描述位移的一种有用方法是将矢量分解为其按轴向对齐的分量。</p><p>例如，三维矢量[1,-3,4]表示单个位移，但可以将这个位移可视化如下:①向右移动1个单位;②向下移动3个单位;③向前移动4个单位（这里假设+x、+y和+z分别指向右、向上和向前。</p><h2 id="2.3.2-%E9%9B%B6%E7%9F%A2%E9%87%8F" tabindex="-1">2.3.2 零矢量</h2><p>（1）零矢量没有方向或长度<br>（2）任何矢量+零矢量=任何矢量</p><h1 id="2.4-%E7%9F%A2%E9%87%8F%E4%B8%8E%E7%82%B9" tabindex="-1">2.4 矢量与点</h1><p>点是位置，而矢量指定的是位移</p><h2 id="2.4.1-%E7%9B%B8%E5%AF%B9%E4%BD%8D%E7%BD%AE" tabindex="-1">2.4.1 相对位置</h2><p>（1）因为矢量可以描述位移，所以它们可以描述相对位置。相对位置:某物体的位置通过描述它与其他物体的已知位置之间的关系来指定。</p><h2 id="2.4.2-%E7%82%B9%E4%B8%8E%E7%9F%A2%E9%87%8F%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB" tabindex="-1">2.4.2 点与矢量之间的关系</h2><p>如果从原点开始并按矢量[x,y]指定的量移动，那么将最终到达点(x,y)所描述的位置。另一种说法是，矢量[x,y]给出了从原点到点(x,y)的位移。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.4.2%20%E7%82%B9%E4%B8%8E%E7%9F%A2%E9%87%8F%E7%9A%84%E5%85%B3%E7%B3%BB.jpg" alt></p><h1 id="2.5-%E8%B4%9F%E7%9F%A2%E9%87%8F" tabindex="-1">2.5 负矢量</h1><p>负运算可以应用于矢量。每个矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>v</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>具有与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>v</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>相同维度的加法逆元<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mover accent="true"><mi>v</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">-\vec{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7973em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>，使得<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mo>+</mo><mo stretchy="false">(</mo><mo>−</mo><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mover accent="true"><mn>0</mn><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{v}+(-\vec{v})=\vec{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7973em;vertical-align:-0.0833em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9274em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9274em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord">0</span></span><span style="top:-3.2134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq></p><h2 id="2.5.1-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99" tabindex="-1">2.5.1 正式线性代数规则</h2><p>为了让任何维度的矢量变负，可以简单地让矢量的每个分量变负<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.5.1%20%E8%AE%A9%E7%9F%A2%E9%87%8F%E5%8F%98%E8%B4%9F.jpg" alt></p><h2 id="2.5.2-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A" tabindex="-1">2.5.2 几何解释</h2><p>使矢量变负会产生大小相同但方向相反的矢量<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.5.2%20%E8%B4%9F%E7%9F%A2%E9%87%8F%E7%9A%84%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A.jpg" alt></p><h1 id="2.6-%E6%A0%87%E9%87%8F%E5%92%8C%E7%9F%A2%E9%87%8F%E7%9A%84%E4%B9%98%E6%B3%95" tabindex="-1">2.6 标量和矢量的乘法</h1><p>矢量不可以和标量相加，但可以相乘。结果是一个与原始矢量平行的矢量,但具有不同的长度和可能相反的方向。</p><h2 id="2.6.1-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99" tabindex="-1">2.6.1 正式线性代数规则</h2><p>表述如下：<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.6.1%20%E6%A0%87%E9%87%8F%E4%B9%98%E4%BB%A5%E7%9F%A2%E9%87%8F.jpg" alt><br>大多数人都会选择将标量放在左边</p><h2 id="2.6.2-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A" tabindex="-1">2.6.2 几何解释</h2><p>在几何上，将矢量乘以标量k具有将长度缩放<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>k</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|k |</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">∣</span></span></span></span></eq>因子的效果。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.6.2%20%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A.jpg" alt></p><h1 id="2.7-%E7%9F%A2%E9%87%8F%E7%9A%84%E5%8A%A0%E6%B3%95%E5%92%8C%E5%87%8F%E6%B3%95" tabindex="-1">2.7 矢量的加法和减法</h1><p>如果两个矢量的维度相同，则可以让他们相加。</p><h2 id="2.7.1-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99" tabindex="-1">2.7.1 正式线性代数规则</h2><p>矢量相加，使用它们相应的分量相加即可。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.7.1%20%E7%9F%A2%E9%87%8F%E5%8A%A0%E5%87%8F%E6%B3%95%E8%A7%84%E5%88%99.jpg" alt></p><h2 id="2.7.2-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A" tabindex="-1">2.7.2 几何解释</h2><p>向量a与b相加，按几何形式实际上就是使得a的头部接触b的尾部，然后绘制一个从a的尾部到b的头部的矢量。换句话说，如果从一个点开始应用由a指定的位移，然后再应用由b指定的位移，那就像应用了单个位移a+ b一样。这被称为矢量加法的三角形法则。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.7.1%20%E7%9F%A2%E9%87%8F%E5%8A%A0%E5%87%8F%E6%B3%95%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A.jpg" alt></p><h2 id="2.7.3-%E4%BB%8E%E4%B8%80%E7%82%B9%E5%88%B0%E5%8F%A6%E4%B8%80%E7%82%B9%E7%9A%84%E4%BD%8D%E7%A7%BB%E7%9F%A2%E9%87%8F" tabindex="-1">2.7.3 从一点到另一点的位移矢量</h2><p>通过矢量加减法即可</p><h1 id="2.8-%E7%9F%A2%E9%87%8F%E5%A4%A7%E5%B0%8F" tabindex="-1">2.8 矢量大小</h1><h2 id="2.8.1-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99" tabindex="-1">2.8.1 正式线性代数规则</h2><p>矢量的大小是矢量分量的平方和的平方根。计算方法：<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.8.1%20%E7%9F%A2%E9%87%8F%E5%A4%A7%E5%B0%8F%E8%AE%A1%E7%AE%97.jpg" alt></p><p><strong>有些图书使用单垂直线符号来表示矢量的大小，即<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>v</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|v|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">∣</span></span></span></span></eq>。</strong></p><h2 id="2.8.2-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A" tabindex="-1">2.8.2 几何解释</h2><p>对于二维中的任何矢量v，可以形成一个直角三角形,其中v作为斜边，毕达哥拉斯定理指出，对于任何直角三角形，斜边长度的平方等于另外两边长度的平方和。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.8.2%20%E7%9F%A2%E9%87%8F%E7%9A%84%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A.jpg" alt></p><h1 id="2.9-%E5%8D%95%E4%BD%8D%E7%9F%A2%E9%87%8F" tabindex="-1">2.9 单位矢量</h1><p>单位矢量是大小为1的矢量，单位矢量有时也被称为归一化矢量或者法线。</p><h2 id="2.9.1-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99" tabindex="-1">2.9.1 正式线性代数规则</h2><p>对于任何非零矢量v，可以计算指向与v相同方向的单位矢量，此过程称为矢量的归一化。为了归一化矢量，可以将矢量除以其大小，具体如下:<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.9.1%20%E7%9F%A2%E9%87%8F%E5%BD%92%E4%B8%80%E5%8C%96.jpg" alt></p><h2 id="2.9.2-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A" tabindex="-1">2.9.2 几何解释</h2><p>在二维中，如果将单位矢量的尾部绘制在原点处，则矢量的头部将接触到以原点为中心的单位圆(单位圆的半径为1)。在三维中，单位矢量接触到的是单位球面。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.9.2%20%E5%8D%95%E4%BD%8D%E7%9F%A2%E9%87%8F%E5%BD%92%E4%B8%80%E5%8C%96%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A.jpg" alt></p><h1 id="2.10-%E8%B7%9D%E7%A6%BB%E5%85%AC%E5%BC%8F" tabindex="-1">2.10 距离公式</h1><p>距离定义为两点之间的线段长度，先计算两点之间的矢量，然后使用2.8中提到的矢量大小求法，求矢量的长度，即为两点之间的距离。</p><h1 id="2.11-%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF" tabindex="-1">2.11 矢量点积</h1><p>点积在较多地方都有使用，例如矩阵乘法、信号卷积、统计相关和傅立叶变换等。</p><h2 id="2.11.1-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99" tabindex="-1">2.11.1 正式线性代数规则</h2><p>“点积”的名称来自矢量乘积表示法中使用的点符号:<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">⋅</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a·b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span></eq>。两个矢量的点积是相应分量的乘积之和,得到的是一个标量。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.1%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF%E8%A1%A8%E8%BE%BE%E5%BC%8F.jpg" alt></p><h2 id="2.11.2-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A" tabindex="-1">2.11.2 几何解释</h2><ol><li>两个非零矢量<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>a</mi><mo>⃗</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>b</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{a},\vec{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1719em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>点积运算，<strong>实际上就是一个矢量在另一个矢量上的投影长度</strong>。</li></ol><ul><li>当<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>a</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>b</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>方向相同，结果为正</li><li>当<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>a</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>b</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span></eq>方向相反，结果为负<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.2%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A.jpg" alt></li></ul><ol start="2"><li><p>点积结合律<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.2%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF%E7%BB%93%E5%90%88%E5%BE%8B.jpg" alt></p></li><li><p>点积交换律<br>当两个矢量<strong>a</strong>和<strong>b</strong>都是单位矢量时，可以很容易地得出一个几何论证，即<strong>a</strong>在<strong>b</strong>上的投影与<strong>b</strong>在<strong>a</strong>上的投影具有相同的长度。考虑下图，两个三角形具有相等的内角，因此它们是相似的。由于<strong>a</strong>和<strong>b</strong>是对应的边并且具有相同的长度，因此两个三角形是彼此的反射。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.2%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF%E4%BA%A4%E6%8D%A2%E5%BE%8B.jpg" alt></p></li><li><p>点积分配律<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.2%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF%E5%88%86%E9%85%8D%E5%BE%8B.jpg" alt><br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.2%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF%E5%8A%A0%E6%B3%95%E5%88%86%E5%B8%83.jpg" alt></p></li><li><p>自身的点积<br>矢量投影到自身上，则该投影的长度就是矢量的大小。但要记住，<strong>a·b</strong>等于<strong>b</strong>投影到<strong>a</strong>上的长度，并且按||<strong>a</strong>||缩放。如果用矢量自身计算矢量点积，例如<strong>v·v</strong>，则得到的是投影的长度（即|||<strong>v</strong>||）乘以投射到的矢量的长度。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.2%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF%E8%87%AA%E8%BA%AB%E7%9A%84%E7%82%B9%E7%A7%AF.jpg" alt></p></li><li><p>点积与截取角度的关系<br>(1) 根据点积求截取角度<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.2%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF-%E7%82%B9%E7%A7%AF%E4%B8%8E%E6%88%AA%E5%8F%96%E8%A7%92%E5%BA%A6.jpg" alt><br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.2%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF-%E7%82%B9%E7%A7%AF%E4%B8%8E%E6%88%AA%E5%8F%96%E8%A7%92%E5%BA%A6-1.jpg" alt><br>(2) 根据点积结果，得到向量的方向关系<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.11.2%20%E7%9F%A2%E9%87%8F%E7%82%B9%E7%A7%AF-%E7%82%B9%E7%A7%AF%E7%BB%93%E6%9E%9C%E6%B1%82%E5%90%91%E9%87%8F%E6%96%B9%E5%90%91%E5%85%B3%E7%B3%BB.jpg" alt></p></li><li><p>总结</p></li></ol><ul><li>点积<strong>a·b</strong>将测量<strong>b</strong>投影到<strong>a</strong>上的长度，乘以<strong>a</strong>的长度。</li><li>点积可用于测量特定方向的位移。<br>投影运算与余弦函数密切相关。点积<strong>a·b</strong>也等于||<strong>a</strong>||||<strong>b</strong>||<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">cos\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">cos</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq>，其中，<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq>是矢量之间的角度。</li></ul><h1 id="2.12-%E7%9F%A2%E9%87%8F%E5%8F%89%E7%A7%AF" tabindex="-1">2.12 矢量叉积</h1><h2 id="2.12.1-%E6%AD%A3%E5%BC%8F%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E8%A7%84%E5%88%99" tabindex="-1">2.12.1 正式线性代数规则</h2><ol><li>叉积的表示为 <strong>a</strong>x<strong>b</strong> ,其中的“×”不能像标量一样省略。</li><li>叉积的公式：</li></ol><section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.25em" columnalign="right" columnspacing><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext> </mtext><msub><mi>x</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>y</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>z</mi><mn>1</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>×</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.25em" columnalign="right" columnspacing><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext> </mtext><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>y</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>z</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.25em" columnalign="right" columnspacing><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext> </mtext><msub><mi>y</mi><mn>1</mn></msub><msub><mi>z</mi><mn>2</mn></msub><mo>−</mo><msub><mi>z</mi><mn>1</mn></msub><msub><mi>y</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>z</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>z</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>x</mi><mn>1</mn></msub><msub><mi>y</mi><mn>2</mn></msub><mo>−</mo><msub><mi>y</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\left[\begin{aligned}\x_1\\y_1\\z_1\\\end{aligned}\right]\times\left[\begin{aligned}\x_2\\y_2\\z_2\\\end{aligned}\right]=\left[\begin{aligned}\y_1z_2-z_1y_2\\z_1x_2-x_1z_2\\x_1y_2-y_1x_2\\\end{aligned}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:6.2em;"></span><span style="width:0.667em;height:4.200em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.200em" viewbox="0 0 667 4200"><path d="M403 1759 V84 H666 V0 H319 V1759 v600 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v600 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:6.2em;"></span><span style="width:0.667em;height:4.200em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.200em" viewbox="0 0 667 4200"><path d="M347 1759 V0 H0 V84 H263 V1759 v600 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v600 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:6.2em;"></span><span style="width:0.667em;height:4.200em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.200em" viewbox="0 0 667 4200"><path d="M403 1759 V84 H666 V0 H319 V1759 v600 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v600 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:6.2em;"></span><span style="width:0.667em;height:4.200em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.200em" viewbox="0 0 667 4200"><path d="M347 1759 V0 H0 V84 H263 V1759 v600 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v600 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:6.2em;"></span><span style="width:0.667em;height:4.200em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.200em" viewbox="0 0 667 4200"><path d="M403 1759 V84 H666 V0 H319 V1759 v600 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v600 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-4.35em;"><span class="pstrut" style="height:6.2em;"></span><span style="width:0.667em;height:4.200em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.200em" viewbox="0 0 667 4200"><path d="M347 1759 V0 H0 V84 H263 V1759 v600 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v600 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><ol><li>叉积和点积具有相同的运算符优先级：乘法正在加减法之前。<strong>当点积和叉积一起使用时，叉积优先</strong>：<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>a</mi><mo>⃗</mo></mover><mo separator="true">⋅</mo><mover accent="true"><mi>b</mi><mo>⃗</mo></mover><mo>×</mo><mover accent="true"><mi>c</mi><mo>⃗</mo></mover><mo>=</mo><mover accent="true"><mi>a</mi><mo>⃗</mo></mover><mo separator="true">⋅</mo><mo stretchy="false">(</mo><mover accent="true"><mi>b</mi><mo>⃗</mo></mover><mo>×</mo><mover accent="true"><mi>c</mi><mo>⃗</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\vec{a}·\vec{b}\times\vec{c}=\vec{a}·(\vec{b}\times\vec{c})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0608em;vertical-align:-0.0833em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">c</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1799em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2274em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">c</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1799em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></eqn></section>，因为如果先算了点积的话，不能采用标量和矢量的叉积。</li><li>叉积的反交换：<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>a</mi><mo>⃗</mo></mover><mo>×</mo><mover accent="true"><mi>b</mi><mo>⃗</mo></mover><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><mover accent="true"><mi>b</mi><mo>⃗</mo></mover><mo>×</mo><mover accent="true"><mi>a</mi><mo>⃗</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\vec{a}\times\vec{b}=-(\vec{b}\times\vec{a})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7973em;vertical-align:-0.0833em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2274em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></eqn></section></li></ol><h3 id="2.12.2-%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A" tabindex="-1">2.12.2 几何解释</h3><ol><li><p>叉积将产生一个矢量，垂直于原始的两个矢量。<strong>a×b</strong>的长度等于<strong>a</strong>和<strong>b</strong>的大小的乘积再乘以<strong>a</strong>和<strong>b</strong>之间角度的正弦值。<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.12.2%20%E5%8F%89%E7%A7%AF%E5%85%AC%E5%BC%8F.jpg" alt><br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.12.2%20%E5%8F%89%E7%A7%AF%E5%87%A0%E4%BD%95%E8%A7%A3%E9%87%8A.jpg" alt></p></li><li><p>基本轴的叉积<br>可以使用1.3.3节中使用手的方法来求叉积的基本轴<br><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.12.2%20%E5%9F%BA%E6%9C%AC%E8%BD%B4%E7%9A%84%E5%8F%89%E7%A7%AF.jpg" alt></p></li></ol><h2 id="2.13-%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F" tabindex="-1">2.13 线性代数恒等式</h2><p><img src="/2024/09/21/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%9F%A2%E9%87%8F/2.13%20%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F.jpg" alt></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;矢量(Vector)是用于构建2D和3D数学的正式数学单元&lt;/p&gt;</summary>
    
    
    
    <category term="3D数学基础" scheme="http://example.com/categories/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="3D数学基础" scheme="http://example.com/tags/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>3D数学基础-图形和游戏开发-学习笔记 第一章 笛卡尔坐标系</title>
    <link href="http://example.com/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/"/>
    <id>http://example.com/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/</id>
    <published>2024-09-20T14:39:26.000Z</published>
    <updated>2024-10-23T14:58:24.190Z</updated>
    
    <content type="html"><![CDATA[<p>选择性的记录内容，学习笔记</p><span id="more"></span><h1 id="%E7%9B%AE%E5%BD%95" tabindex="-1">目录</h1><ul><li><a href="#%E7%9B%AE%E5%BD%95">目录</a></li><li><a href="#11-%E4%B8%80%E7%BB%B4%E6%95%B0%E5%AD%A6">1.1 一维数学</a></li><li><a href="#12-%E4%BA%8C%E7%BB%B4%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4">1.2 二维笛卡尔空间</a><ul><li><a href="#122-%E4%BB%BB%E6%84%8F%E4%BA%8C%E7%BB%B4%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4">1.2.2 任意二维坐标空间</a></li><li><a href="#123-%E4%BD%BF%E7%94%A8%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E6%8C%87%E5%AE%9A%E4%BA%8C%E7%BB%B4%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AE">1.2.3 使用笛卡尔坐标指定二维中的位置</a></li></ul></li><li><a href="#13-%E4%B8%89%E7%BB%B4%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4">1.3 三维笛卡尔空间</a><ul><li><a href="#131-%E6%96%B0%E5%A2%9E%E7%BB%B4%E5%BA%A6%E5%92%8C%E8%BD%B4">1.3.1 新增维度和轴</a></li><li><a href="#132-%E5%9C%A8%E4%B8%89%E7%BB%B4%E4%B8%AD%E5%88%B6%E5%8A%A8%E4%BD%8D%E7%BD%AE">1.3.2 在三维中制动位置</a></li><li><a href="#133-%E5%B7%A6%E6%89%8B%E4%B8%8E%E5%8F%B3%E6%89%8B%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4">1.3.3 左手与右手坐标空间</a></li><li><a href="#134-%E4%B8%80%E4%BA%9B%E4%BD%BF%E7%94%A8%E7%9A%84%E9%87%8D%E8%A6%81%E7%BA%A6%E5%AE%9A">1.3.4 一些使用的重要约定</a></li></ul></li><li><a href="#14-%E4%B8%80%E4%BA%9B%E9%9B%B6%E6%95%A3%E7%9A%84%E7%9F%A5%E8%AF%86">1.4 一些零散的知识</a><ul><li><a href="#141-%E6%B1%82%E5%92%8C%E4%B8%8E%E6%B1%82%E7%A7%AF%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%B3%95">1.4.1 求和与求积的表示法</a></li><li><a href="#142-%E5%8C%BA%E9%97%B4%E7%AC%A6%E5%8F%B7">1.4.2 区间符号</a></li><li><a href="#143-%E8%A7%92%E5%BA%A6%E5%BA%A6%E6%95%B0%E5%92%8C%E5%BC%A7%E5%BA%A6">1.4.3 角度、度数和弧度</a></li><li><a href="#144-%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0">1.4.4 三角函数</a></li><li><a href="#145-%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F-">1.4.5 三角函数恒等式 ⭐</a></li></ul></li></ul><h1 id="1.1-%E4%B8%80%E7%BB%B4%E6%95%B0%E5%AD%A6" tabindex="-1">1.1 一维数学</h1><h1 id="1.2-%E4%BA%8C%E7%BB%B4%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4" tabindex="-1">1.2 二维笛卡尔空间</h1><h2 id="1.2.2-%E4%BB%BB%E6%84%8F%E4%BA%8C%E7%BB%B4%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4" tabindex="-1">1.2.2 任意二维坐标空间</h2><p>原点、x轴、y轴</p><h2 id="1.2.3-%E4%BD%BF%E7%94%A8%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E6%8C%87%E5%AE%9A%E4%BA%8C%E7%BB%B4%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AE" tabindex="-1">1.2.3 使用笛卡尔坐标指定二维中的位置</h2><p>坐标点表示为(x,y)</p><h1 id="1.3-%E4%B8%89%E7%BB%B4%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A9%BA%E9%97%B4" tabindex="-1">1.3 三维笛卡尔空间</h1><h2 id="1.3.1-%E6%96%B0%E5%A2%9E%E7%BB%B4%E5%BA%A6%E5%92%8C%E8%BD%B4" tabindex="-1">1.3.1 新增维度和轴</h2><p>新增z轴</p><h2 id="1.3.2-%E5%9C%A8%E4%B8%89%E7%BB%B4%E4%B8%AD%E5%88%B6%E5%8A%A8%E4%BD%8D%E7%BD%AE" tabindex="-1">1.3.2 在三维中制动位置</h2><p>坐标点表示为(x,y,z)</p><h2 id="1.3.3-%E5%B7%A6%E6%89%8B%E4%B8%8E%E5%8F%B3%E6%89%8B%E5%9D%90%E6%A0%87%E7%A9%BA%E9%97%B4" tabindex="-1">1.3.3 左手与右手坐标空间</h2><p><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.3.3%E5%B7%A6%E6%89%8B%E4%B8%8E%E5%8F%B3%E6%89%8B%E5%9D%90%E6%A0%87%E7%B3%BB.jpg" alt></p><p><strong>1. 左手坐标系</strong></p><ul><li>伸出左手，用拇指和食指做出一个L形</li><li>拇指指向你的右边，食指朝上</li><li>现在伸展你的第三根手指（中指），使它直接指向前方</li></ul><p>这样你就形成了一个<strong>左手坐标系</strong>。你的拇指、食指和第三根（中指）手指分别指向+x、+y和+z方向。</p><p><strong>2. 右手坐标系</strong></p><ul><li>伸出有手，用拇指和食指做出一个L形</li><li>拇指指向你的左边，食指朝上</li><li>现在伸展你的第三根手指（中指），使它直接指向前方<br>这样你就形成了一个<strong>右手坐标系</strong>。你的拇指、食指和第三根（中指）手指分别指向+x、+y和+z方向。</li></ul><p><strong>3. 左旋、右旋坐标系</strong><br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.3.3%E5%B7%A6%E6%97%8B%E3%80%81%E5%8F%B3%E6%97%8B%E5%9D%90%E6%A0%87%E7%B3%BB.jpg" alt><br>左旋和右旋坐标系在“正旋转”的定义上也有所不同。假设在空间中有一条直线，需要围绕这条直线旋转指定的角度。我们将此线称为旋转轴(Axis of Rotation)。<br>（1） 左（右）手规则。在左（右）手坐标系中，告知哪一个方向是旋转正方向的，哪一个方向是旋转负方向的标准方法称为<strong>左（右）手规则</strong>。</p><ul><li>将左（右）手摆出一个“竖起大拇指”的位置，拇指指向旋转轴的正值端</li><li>此时，围绕旋转轴的正向旋转方向就是手指卷曲的方向。</li></ul><p><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.3.3%E5%B7%A6%E6%97%8B%E3%80%81%E5%8F%B3%E6%97%8B%E5%9D%90%E6%A0%87%E7%B3%BB%E4%B8%BB%E8%BD%B4%E6%97%8B%E8%BD%AC.jpg" alt><br>（2）从图中可以看出，在<strong>左手坐标系</strong>中，<strong>正向旋转</strong>从轴的正端看时是<strong>顺时针</strong>旋转的;而在<strong>右手坐标系中，正向旋转是逆时针旋转</strong>的。</p><p><strong>4. 左右手坐标系转换</strong></p><p>交换一个轴的正负端</p><p><strong>5. 左右手坐标系的应用</strong><br>一些较新的计算机图形文献使用左手坐标系，而传统的图形文献和更多面向数学的线性代数的研究人员则倾向于使用右手坐标系</p><h2 id="1.3.4-%E4%B8%80%E4%BA%9B%E4%BD%BF%E7%94%A8%E7%9A%84%E9%87%8D%E8%A6%81%E7%BA%A6%E5%AE%9A" tabindex="-1">1.3.4 一些使用的重要约定</h2><ol><li>在设计三维虚拟世界时，必须事先做出几种设计决策，例如左手或右手坐标系、哪个方向是+y等。</li><li><strong><font color="red">这本书后续将使用左手坐标系(+x、+y和+z方向分别指向右、上和前)作为例子讲解，当出现差异时会特别加以指出</font></strong></li></ol><h1 id="1.4-%E4%B8%80%E4%BA%9B%E9%9B%B6%E6%95%A3%E7%9A%84%E7%9F%A5%E8%AF%86" tabindex="-1">1.4 一些零散的知识</h1><h3 id="1.4.1-%E6%B1%82%E5%92%8C%E4%B8%8E%E6%B1%82%E7%A7%AF%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%B3%95" tabindex="-1">1.4.1 求和与求积的表示法</h3><p><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.1%E6%B1%82%E5%92%8C%E8%A1%A8%E7%A4%BA%E6%B3%95.jpg" alt><br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.1%E6%B1%82%E7%A7%AF%E8%A1%A8%E7%A4%BA%E6%B3%95.jpg" alt></p><h2 id="1.4.2-%E5%8C%BA%E9%97%B4%E7%AC%A6%E5%8F%B7" tabindex="-1">1.4.2 区间符号</h2><ul><li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[a,b]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">]</span></span></span></span></eq> 表示 “所有满足<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a≤x≤b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></eq>的数字<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq>” ,是一个闭区间，包含a,b</li><li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a,b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></eq> 表示 “所有满足<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&lt;</mo><mi>x</mi><mo>&lt;</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a&lt;x&lt;b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span></eq>的数字<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq>” ,是一个开区间，不包含a,b</li><li><eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">(a,b]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">]</span></span></span></span></eq> 与<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[a,b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></eq> 表示半开区间</li></ul><h2 id="1.4.3-%E8%A7%92%E5%BA%A6%E3%80%81%E5%BA%A6%E6%95%B0%E5%92%8C%E5%BC%A7%E5%BA%A6" tabindex="-1">1.4.3 角度、度数和弧度</h2><p>（1）角度可以测量平面中的旋转量。表示角度的变量通常被赋予希腊字母<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq>。用于指定角度的最重要的度量单位是<strong>度( °）和弧度（rad）</strong>。</p><p>（2）人类通常使用度（Degree）数来测量角度。<strong>一度表示旋转1/360，因此360°代表旋转完整的一圈</strong>。然而，数学家更喜欢以弧度为单位测量角度，<strong>弧度是基于圆的属性的度量单位</strong>。当以弧度指定两条线之间的角度时，<strong>实际上是测量单位圆(以半径为1的原点为中心的圆）的截取弧的长度</strong></p><p>（3）弧度和度数的转换<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.1%E5%BC%A7%E5%BA%A6%E5%92%8C%E8%A7%92%E5%BA%A6%E7%9A%84%E8%BD%AC%E6%8D%A2.jpg" alt></p><h2 id="1.4.4-%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0" tabindex="-1">1.4.4 三角函数</h2><p>（1） 正弦<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">cos\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">cos</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq>、余弦<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">sin\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq></p><ul><li>在坐标中也有特殊的意义， <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">cos\theta = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">cos</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq> ,<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mi>θ</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">sin\theta = y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq></li></ul><p>（2）割线(secant)、余割（cosecant）、切线（tangent）和余切（cotangent）也是有用的三角函数。<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.4%20%E5%89%B2%E7%BA%BF%E3%80%81%E4%BD%99%E5%89%B2%E3%80%81%E5%88%87%E7%BA%BF%E5%92%8C%E4%BD%99%E5%88%87.jpg" alt></p><p>（3） 勾股与三角函数的对应关系<br>在术语中，勾被称为邻边(Adjacent)，长度为x;股被称为对边(Opposite),长度为y。它们都是相对于角度0进行解释的。同样，在这里字母顺序也是一个有用的记忆辅助手段——Adjacent和 Opposite 的顺序与相应的cosine和 sine 的顺序是相同的。弦则被称为斜边（Hypotenuse)，而缩写词 <strong>hyp、adj和 opp则分别指的是斜边、邻边和对边的长度</strong>，如图所示。<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.4%20%E5%8B%BE%E8%82%A1%E4%B8%8E%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0.jpg" alt></p><ul><li>当<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq>为钝角时，上述等式不太适用，因为不能形成具有钝角内角的直角三角形。但是，通过在标准位置显示角度并允许旋转的线条为任何长度r，可以使用x、y和r表示以下对比关系。<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.4%20%E5%8B%BE%E8%82%A1%E4%B8%8E%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0_%E8%A7%92%E5%BA%A6%E4%B8%BA%E9%92%9D%E8%A7%92%E7%A4%BA%E6%84%8F%E5%9B%BE.jpg" alt><br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.4%20%E5%8B%BE%E8%82%A1%E4%B8%8E%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0_%E8%A7%92%E5%BA%A6%E4%B8%BA%E9%92%9D%E8%A7%92.jpg" alt></li></ul><p><strong>（4）常见角度的度数和弧度值，以及相应的三角函数的值</strong>⭐<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.4%20%E5%B8%B8%E8%A7%81%E8%A7%92%E5%BA%A6%E7%9A%84%E5%BA%A6%E6%95%B0%E5%92%8C%E5%BC%A7%E5%BA%A6%E5%80%BC%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%BA%94%E7%9A%84%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E7%9A%84%E5%80%BC.jpg" alt><br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.4%20%E5%B8%B8%E8%A7%81%E8%A7%92%E5%BA%A6%E7%9A%84%E5%BA%A6%E6%95%B0%E5%92%8C%E5%BC%A7%E5%BA%A6%E5%80%BC%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%BA%94%E7%9A%84%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E7%9A%84%E5%80%BC1.jpg" alt></p><h2 id="1.4.5-%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F-%E2%AD%90" tabindex="-1">1.4.5 三角函数恒等式 ⭐</h2><p>（1）基本恒等式（可基于单位圆的对称性推导出）<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.5%20%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F.jpg" alt></p><p>（2）毕达哥拉斯恒等式<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.5%20%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F_%E6%AF%95%E8%BE%BE%E5%93%A5%E6%8B%89%E6%96%AF%E6%81%92%E7%AD%89%E5%BC%8F.jpg" alt></p><p>（3）和差公式<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.5%20%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F_%E5%92%8C%E5%B7%AE%E5%85%AC%E5%BC%8F.jpg" alt></p><p>（4）等腰三角形恒等式（和差公式的特殊情况）<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.5%20%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F_%E7%AD%89%E8%85%B0%E4%B8%89%E8%A7%92%E5%BD%A2%E6%81%92%E7%AD%89%E5%BC%8F.jpg" alt></p><p>（5）正弦定理与余弦定理<br><img src="/2024/09/20/3D%E6%B8%B8%E6%88%8F%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80-%E5%9B%BE%E5%BD%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%AC%9B%E5%8D%A1%E5%B0%94%E5%9D%90%E6%A0%87%E7%B3%BB/1.4.5%20%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E6%81%92%E7%AD%89%E5%BC%8F_%E6%AD%A3%E5%BC%A6%E5%AE%9A%E7%90%86%E4%B8%8E%E4%BD%99%E5%BC%A6%E5%AE%9A%E7%90%86.jpg" alt></p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;选择性的记录内容，学习笔记&lt;/p&gt;</summary>
    
    
    
    <category term="3D数学基础" scheme="http://example.com/categories/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="3D数学基础" scheme="http://example.com/tags/3D%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>AssetBundle-AB包</title>
    <link href="http://example.com/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/"/>
    <id>http://example.com/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/</id>
    <published>2024-09-19T15:31:32.000Z</published>
    <updated>2024-10-06T14:51:19.207Z</updated>
    
    <content type="html"><![CDATA[<p>热更新解决方案学习-AssetBundle-AB包</p><span id="more"></span><h1 id="%E4%B8%80%E3%80%81ab%E5%8C%85%E7%9A%84%E5%AE%9A%E4%B9%89" tabindex="-1">一、AB包的定义</h1><ul><li>特定于平台的资产压缩包，类似压缩文件</li><li>资产包括：模型、贴图、预制体、音效、材质球等</li></ul><h1 id="%E4%BA%8C%E3%80%81ab%E5%8C%85%E7%9A%84%E4%BD%9C%E7%94%A8" tabindex="-1">二、AB包的作用</h1><ul><li><p>相对于Resources下的资源，AB包更好管理资源</p><ul><li>Resources打包时定死、制度、无法修改。只能通过Load加载</li><li>存储位置、压缩方式（打包哪些、压多少）自定义，后期可以动态更新。可以从网络或本地加载。<br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/Resource%E5%92%8CAB%E5%8C%85%E7%9A%84%E5%8C%BA%E5%88%AB.png" alt></li></ul></li><li><p>减少包体大小</p><ul><li>压缩资源</li><li>减少初始包大小。（先安装一个小安装包，在进入游戏时再下载安装）</li></ul></li><li><p>热更新使用</p><ul><li>资源热更新（美术类）</li><li>脚本热更新（更新lua脚本）-unity3d中的C#代码是没法打包成AB包的，只能打包物体关联了哪些代码脚本的信息（一堆数据）</li><li>热更新的基本规则<br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/%E7%83%AD%E6%9B%B4%E6%96%B0%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%A7%84%E5%88%99.png" alt></li></ul></li></ul><h1 id="%E4%B8%89%E3%80%81%E7%94%9F%E6%88%90ab%E5%8C%85%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6" tabindex="-1">三、生成AB包资源文件</h1><ul><li><p>Unity编辑器开发，通过U3D提供的API自定义打包工具（一般公司已经做好了）。</p></li><li><p>官方提供好的打包工具：Asset Bundle Browser（主要学习）</p></li><li><p>AssetBundleBrowser参数相关</p></li><li><p>点击中文件夹中的物体，在Inspector面板最下方有个AssetBundle的第一个空格进行命名<br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/AssetBundle%E5%91%BD%E5%90%8D.png" alt></p></li><li><p>在window-AssetBundle Browser内可以看到刚刚命名的一些内容。（资源关联到包名）</p></li><li><p>另一方面，可以发现cube（预制体）上有很多组件（碰撞体、网格等）看起来都是脚本，其实会利用反射机制，使得预制体记录的只是一些数据。所以打包到ab时不是打包的脚本（代码）本身，而是预制体关联了哪些代码<br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/AB%E5%AE%9E%E9%99%85%E6%89%93%E5%8C%85%E7%9A%84%E4%B8%9C%E8%A5%BF.png" alt><br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/%E9%A2%84%E5%88%B6%E4%BD%93%E7%9A%84%E6%96%87%E6%9C%AC%E4%BF%A1%E6%81%AF.png" alt></p></li><li><p>最终打包-Build：目标平台-输出路径-（是否清空文件夹，包过大时会影响打包速度，因为每次都要打包全部）-（是否把打包到输出路径的AB复制一份到StreamingAssets，<strong>该文件夹内的文件在PC上是可读可写的，在移动端是可读的）</strong></p></li><li><p>压缩方式：不压缩包很大解压快；LZMA: 压缩包最小，使用某一个资源时需要解压整个包，速度满；LZ4: 大小次之，需要什么资源解压什么资源，速度适中）<br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/AB%E5%8C%85%E7%9A%84%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0.png" alt><br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/AB%E5%8C%85%E7%9A%84%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0%E6%A0%91%E7%8A%B6%E5%9B%BE.png" alt></p></li><li><p>AB包生成的文件</p><ul><li>AB包文件-资源文件<ul><li>manifest文件</li></ul></li></ul></li><li><p>AB包文件信息</p><ul><li>当加载时，提供了关键信息：资源信息、依赖关系、版本信息等</li></ul></li><li><p>关键AB包（和目录名一样的包）</p><ul><li>主包</li><li>AB包依赖关系</li></ul></li><li><p>实例</p><ul><li>StandaloneWindowsAB指的是打包出去的主包</li><li>不带后缀名的（ui、cude）指的是资源文件</li><li>后缀manifest文件是表示的对应的资源文件的配置信息<br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/AB%E5%8C%85%E6%89%93%E5%8C%85%E5%90%8E%E7%9A%84%E6%96%87%E4%BB%B6.png" alt><br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/AB%E5%8C%85%E6%89%93%E5%8C%85%E5%90%8E%E7%9A%84manifest%E6%96%87%E4%BB%B6%E4%BF%A1%E6%81%AF.png" alt></li></ul></li><li><p>Inspect页面 （检查页面）</p><ul><li>可以把打包好的AB包添加进来，查看相关的信息<br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/AB%E5%8C%85%E6%A3%80%E6%9F%A5%E7%95%8C%E9%9D%A2-Inspect%E9%A1%B5%E9%9D%A2.png" alt></li></ul></li></ul><h1 id="%E5%9B%9B%E3%80%81ab%E5%8C%85%E7%9A%84%E4%BD%BF%E7%94%A8" tabindex="-1">四、AB包的使用</h1><p>1、加载AB包，由于在打包时复制到了StreamingAssets中，通过AB加载其中的AB包<br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/%E5%8A%A0%E8%BD%BDAB%E5%8C%85%E8%B5%84%E6%BA%90.png" alt><br>2、异步加载AB包<br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BDAB%E5%8C%85%E8%B5%84%E6%BA%90.png" alt><br>3、卸载AB包</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AssetBundle.UnloadAllAssetBundles(<span class="literal">true</span>);<span class="comment">//卸载所有AB包以及其场景上已经加载的资源</span></span><br><span class="line">AssetBundle.UnloadAllAssetBundles(<span class="literal">false</span>);<span class="comment">//只卸载所有AB包，其场景上已经加载的资源不受影响（常用）</span></span><br><span class="line">ab.Unload(<span class="literal">true</span>);<span class="comment">//卸载单个ab包及其场景上已经加载的资源（同步）-ab包自己卸载自己</span></span><br><span class="line">ab.Unload(<span class="literal">false</span>);<span class="comment">//只卸载单个ab包，其场景上已经加载的资源不受影响（同步）</span></span><br><span class="line">ab.UnloadAsync(<span class="literal">true</span>);<span class="comment">//卸载单个ab包及其场景上已经加载的资源（异步）</span></span><br><span class="line">ab.UnloadAsync(<span class="literal">false</span>);<span class="comment">//只卸载单个ab包，其场景上已经加载的资源不受影响（异步)</span></span><br></pre></td></tr></table></figure><h1 id="%E4%BA%94%E3%80%81ab%E5%8C%85%E7%9A%84%E4%BE%9D%E8%B5%96" tabindex="-1">五、AB包的依赖</h1><ul><li>给球添加材质后，并没有给材质添加到AB打包，但AB自动添加了材质</li><li><strong>即在包中的资源如果使用了另一个资源，那么另一个资源会被默认打在同一个包中（脚本不算）</strong></li><li><strong>如果另一个资源自己选择不打包在同一个包，当只加载自己的包,通过它创建对象,会出现资源丢失的情况，那么此时需要加载另一个资源所在的包（称依赖包），才能修复丢失。</strong><br><img src="/2024/09/19/%E7%83%AD%E6%9B%B4%E6%96%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E5%AD%A6%E4%B9%A0-AssetBundle-AB%E5%8C%85/AB%E5%8C%85%E4%BE%9D%E8%B5%96.png" alt></li></ul><p>（1）当我们并<strong>不知道依赖的包</strong>是哪一个时，如何判断——依赖- 包的关键知识点： <strong>利用主包 获取依赖信息</strong></p><ul><li>加载主包</li><li>加载主包中的固定文件</li><li>从固定文件中得到依赖信息</li><li>得到依赖包的名字</li><li>依据依赖包名字加载依赖包</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//依赖包的关键知识点—利用主包 获取依赖信息</span></span><br><span class="line">        <span class="comment">//加载主包</span></span><br><span class="line">        AssetBundle abMain = AssetBundle.LoadFromFile(Application.streamingAssetsPath +  <span class="string">&quot;/&quot;</span> + <span class="string">&quot;StandaloneWindowsAB&quot;</span>);</span><br><span class="line">        <span class="comment">//加载主包中的固定文件</span></span><br><span class="line">        AssetBundleManifest abMainfest =  abMain.LoadAsset&lt;AssetBundleManifest&gt;(<span class="string">&quot;AssetBundleManifest&quot;</span>);</span><br><span class="line">        <span class="comment">//从固定文件中 得到依赖信息(得到uicube包的所有依赖信息）</span></span><br><span class="line">        <span class="built_in">string</span>[] strs = abMainfest.GetAllDependencies(<span class="string">&quot;uicube&quot;</span>);</span><br><span class="line">        <span class="comment">//得到了 依赖包的名字</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; strs.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(strs[i]);</span><br><span class="line">            <span class="comment">//依据依赖包名字加载依赖包</span></span><br><span class="line">            AssetBundle.LoadFromFile(Application.streamingAssetsPath + <span class="string">&quot;/&quot;</span> + strs[i]);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h1 id="%E5%85%AD%E3%80%81ab%E5%8C%85%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E7%AE%A1%E7%90%86%E5%99%A8" tabindex="-1">六、AB包资源加载管理器</h1><ul><li>字典-保存已经加载的ab包</li><li>协程-异步加载ab包中的资源</li><li>单例模式-提供加载资源的接口</li><li>AB包相关API-AssetBundle的一些接口</li><li>委托（lambda表达式）-异步加载完后返回响应的操作</li></ul><h1 id="%E5%85%B6%E4%BB%96" tabindex="-1">其他</h1><h2 id="unityaction%E5%92%8Csystem.action%E7%9A%84%E5%8C%BA%E5%88%AB" tabindex="-1">UnityAction和System.Action的区别</h2><ol><li>首先，unity内置的.AddListener只能注册UnityAction来添加非持久监听器</li><li>如果希望在inspector面板访问委托，只能使用UnityAction，否则无法序列化。</li><li>注意，有人说UnityAction参数最多四个，System.Action参数远远多于UnityAction。但那是.Net环境的System.Action，这在unity环境下是不对的，因为unity用的是Mone，所以System.Action参数也最多是四个。当然如果环境变了，或许会有所不同。</li></ol><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;热更新解决方案学习-AssetBundle-AB包&lt;/p&gt;</summary>
    
    
    
    <category term="热更新相关" scheme="http://example.com/categories/%E7%83%AD%E6%9B%B4%E6%96%B0%E7%9B%B8%E5%85%B3/"/>
    
    
    <category term="热更新相关" scheme="http://example.com/tags/%E7%83%AD%E6%9B%B4%E6%96%B0%E7%9B%B8%E5%85%B3/"/>
    
  </entry>
  
  <entry>
    <title>lua学习笔记1</title>
    <link href="http://example.com/2024/08/20/lua-lua%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://example.com/2024/08/20/lua-lua%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2024-08-20T13:46:11.000Z</published>
    <updated>2024-10-06T14:52:49.233Z</updated>
    
    <content type="html"><![CDATA[<p>lua学习笔记</p><span id="more"></span><ul><li><a href="#%E9%9B%B6-%E5%BC%95%E7%94%A8">零 引用</a></li><li><a href="#%E4%B8%80-%E6%A6%82%E8%BF%B0">一 概述</a></li><li><a href="#%E4%BA%8C-%E5%AE%89%E8%A3%85">二 安装</a></li><li><a href="#%E4%B8%89-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95">三 基本语法</a><ul><li><a href="#31-%E4%BA%A4%E4%BA%92%E5%BC%8F%E7%BC%96%E7%A8%8B">3.1 交互式编程</a></li><li><a href="#32-%E8%84%9A%E6%9C%AC%E5%BC%8F%E7%BC%96%E7%A8%8B">3.2 脚本式编程</a></li><li><a href="#33-%E6%B3%A8%E9%87%8A">3.3 注释</a></li><li><a href="#34-%E6%A0%87%E8%AF%86%E7%AC%A6">3.4 标识符</a></li></ul></li><li><a href="#%E5%9B%9B-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">四 数据类型</a><ul><li><a href="#41-nil%E7%A9%BA">4.1 nil(空)</a></li><li><a href="#42-boolean%E5%B8%83%E5%B0%94">4.2 boolean（布尔）</a></li><li><a href="#43-number%E6%95%B0%E5%AD%97">4.3 number（数字）</a></li><li><a href="#44-string%E5%AD%97%E7%AC%A6%E4%B8%B2">4.4 string（字符串）</a></li><li><a href="#45-%E8%A1%A8">4.5 表</a></li><li><a href="#46-function%E5%87%BD%E6%95%B0">4.6 function（函数）</a></li><li><a href="#47-thread%E7%BA%BF%E7%A8%8B">4.7 thread（线程）</a></li><li><a href="#48-userdata%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B">4.8 userdata（自定义类型）</a></li></ul></li><li><a href="#%E4%BA%94-%E5%8F%98%E9%87%8F">五 变量</a><ul><li><a href="#51-%E5%8F%98%E9%87%8F">5.1 变量</a></li><li><a href="#52-%E8%B5%8B%E5%80%BC%E8%AF%AD%E5%8F%A5">5.2 赋值语句</a></li><li><a href="#53-%E7%B4%A2%E5%BC%95">5.3 索引</a></li></ul></li><li><a href="#%E5%85%AD-%E5%BE%AA%E7%8E%AF">六 循环</a><ul><li><a href="#61-%E5%BE%AA%E7%8E%AF%E6%96%B9%E5%BC%8F">6.1 循环方式</a></li><li><a href="#62-%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5">6.2 循环控制语句</a></li><li><a href="#63-%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF">6.3 无限循环</a></li></ul></li><li><a href="#%E4%B8%83-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6-if-else">七 流程控制 （if else）</a></li><li><a href="#%E5%85%AB-%E5%87%BD%E6%95%B0">八 函数</a><ul><li><a href="#81-%E6%A6%82%E8%BF%B0">8.1 概述</a></li><li><a href="#82-%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89">8.2 函数的定义</a></li><li><a href="#83-%E5%A4%9A%E8%BF%94%E5%9B%9E%E5%80%BC">8.3 多返回值</a></li><li><a href="#84-%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0">8.4 可变参数</a></li></ul></li><li><a href="#%E4%B9%9D-%E8%BF%90%E7%AE%97%E7%AC%A6">九 运算符</a><ul><li><a href="#91-%E8%BF%90%E7%AE%97%E7%AC%A6%E7%B1%BB%E5%9E%8B">9.1 运算符类型</a></li><li><a href="#92-%E7%AE%97%E6%95%B0%E8%BF%90%E7%AE%97%E7%AC%A6">9.2 算数运算符</a></li><li><a href="#93-%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6">9.3 关系运算符</a></li><li><a href="#94-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6">9.4 逻辑运算符</a></li><li><a href="#95-%E5%85%B6%E4%BB%96%E8%BF%90%E7%AE%97%E7%AC%A6">9.5 其他运算符</a></li><li><a href="#96-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7">9.6 运算符优先级</a></li></ul></li><li><a href="#%E5%8D%81-%E5%AD%97%E7%AC%A6%E4%B8%B2">十 字符串</a><ul><li><a href="#101-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E8%A1%A8%E7%A4%BA">10.1 字符串的表示</a></li><li><a href="#102-%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6%E8%AE%A1%E7%AE%97">10.2 字符串长度计算</a></li><li><a href="#103-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%93%8D%E4%BD%9C%E5%87%BD%E6%95%B0">10.3 字符串的操作（函数）</a></li><li><a href="#104-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%AA%E5%8F%96">10.4 字符串截取</a></li><li><a href="#105-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%A7%E5%B0%8F%E5%86%99%E8%BD%AC%E6%8D%A2">10.5 字符串大小写转换</a></li><li><a href="#106-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9F%A5%E6%89%BE%E4%B8%8E%E5%8F%8D%E8%BD%AC">10.6 字符串查找与反转</a></li><li><a href="#107-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%8C%96">10.7 字符串格式化</a></li><li><a href="#108-%E5%AD%97%E7%AC%A6%E4%B8%8E%E6%95%B4%E6%95%B0%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2">10.8 字符与整数相互转换</a></li><li><a href="#109-%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%9E%E6%8E%A5%E4%B8%8E%E5%A4%8D%E5%88%B6">10.9 字符串连接与复制</a></li><li><a href="#1010-%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F">10.10 匹配模式</a></li></ul></li><li><a href="#%E5%8D%81%E4%B8%80-lua%E6%95%B0%E7%BB%84">十一 Lua数组</a><ul><li><a href="#111-%E6%A6%82%E8%BF%B0">11.1 概述</a></li><li><a href="#112-%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84">11.2 一维数组</a></li><li><a href="#113-%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84">11.3 多维数组</a></li></ul></li><li><a href="#%E5%8D%81%E4%BA%8C-%E8%BF%AD%E4%BB%A3%E5%99%A8">十二 迭代器（⭐）</a><ul><li><a href="#121-%E6%A6%82%E8%BF%B0">12.1 概述</a></li><li><a href="#122-%E6%B3%9B%E5%9E%8Bfor%E8%BF%AD%E4%BB%A3%E5%99%A8">12.2 泛型for迭代器</a></li><li><a href="#122-%E6%97%A0%E7%8A%B6%E6%80%81%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8">12.2 无状态的迭代器</a></li><li><a href="#123-%E5%A4%9A%E7%8A%B6%E6%80%81%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8">12.3 多状态的迭代器</a></li></ul></li><li><a href="#%E5%8D%81%E4%B8%89-table%E8%A1%A8">十三 table（表）（⭐）</a><ul><li><a href="#131-%E6%A6%82%E8%BF%B0">13.1 概述</a></li><li><a href="#132-%E8%A1%A8table%E7%9A%84%E6%9E%84%E9%80%A0">13.2 表（Table）的构造</a></li><li><a href="#133-table%E6%93%8D%E4%BD%9C">13.3 Table操作</a></li></ul></li><li><a href="#%E5%8D%81%E5%9B%9B-%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%8C%85">十四 模块与包（⭐）</a><ul><li><a href="#141-%E6%A6%82%E8%BF%B0%E5%8F%8A%E5%AE%9A%E4%B9%89">14.1 概述及定义</a></li><li><a href="#142-%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97require%E5%87%BD%E6%95%B0">14.2 加载模块（require函数）</a></li><li><a href="#143-c%E5%8C%85">14.3 C包</a></li></ul></li><li><a href="#%E5%8D%81%E4%BA%94-%E5%85%83%E8%A1%A8metatable">十五 元表(Metatable)（⭐）</a><ul><li><a href="#151-%E6%A6%82%E8%BF%B0">15.1 概述</a></li><li><a href="#152-__index-%E5%85%83%E6%96%B9%E6%B3%95">15.2 __index 元方法（⭐⭐⭐）</a></li><li><a href="#153-__newindex-%E5%85%83%E6%96%B9%E6%B3%95">15.3 __newindex 元方法（⭐）</a></li><li><a href="#154-rawget%E5%92%8Crawset">15.4 rawget和rawset</a></li><li><a href="#155-%E8%BF%90%E7%AE%97%E5%85%83%E6%96%B9%E6%B3%95-%E4%B8%BA%E8%A1%A8%E6%B7%BB%E5%8A%A0%E6%93%8D%E4%BD%9C%E7%AC%A6">15.5 运算元方法-为表添加操作符</a></li><li><a href="#156-__call%E5%85%83%E6%96%B9%E6%B3%95">15.6 __call元方法</a></li><li><a href="#157-__tostring-%E5%85%83%E6%96%B9%E6%B3%95">15.7 __tostring 元方法</a></li></ul></li><li><a href="#%E5%8D%81%E5%85%AD-%E5%8D%8F%E5%90%8C%E7%A8%8B%E5%BA%8Fcoroutine">十六 协同程序（coroutine）（⭐⭐⭐）</a><ul><li><a href="#161-%E4%BB%80%E4%B9%88%E6%98%AF%E5%8D%8F%E5%90%8Ccoroutine">16.1 什么是协同（coroutine）</a></li><li><a href="#162-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95">16.2 基本语法</a></li><li><a href="#163-%E5%90%84%E4%B8%AA%E8%AF%AD%E6%B3%95%E7%9A%84%E7%94%A8%E6%B3%95%E5%AE%9E%E4%BE%8B">16.3 各个语法的用法实例</a></li><li><a href="#164-%E7%94%9F%E4%BA%A7%E8%80%85-%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98">16.4 生产者-消费者问题</a></li><li><a href="#165-%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%8D%8F%E5%90%8C%E7%A8%8B%E5%BA%8F%E5%8C%BA%E5%88%AB">16.5 线程和协同程序区别</a></li></ul></li><li><a href="#%E5%8D%81%E4%B8%83-%E6%96%87%E4%BB%B6io">十七 文件I/O</a><ul><li><a href="#171-%E6%A6%82%E8%BF%B0%E5%8F%8A%E7%94%A8%E6%B3%95">17.1 概述及用法</a></li><li><a href="#172-%E7%AE%80%E5%8D%95%E6%A8%A1%E5%BC%8Fio%E8%B0%83%E7%94%A8">17.2 简单模式（io.调用）</a></li><li><a href="#173-%E5%AE%8C%E5%85%A8%E6%A8%A1%E5%BC%8Ffile%E8%B0%83%E7%94%A8">17.3 完全模式（file:调用）</a></li></ul></li><li><a href="#%E5%8D%81%E5%85%AB-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">十八 错误处理</a><ul><li><a href="#181-%E6%A6%82%E8%BF%B0">18.1 概述</a></li><li><a href="#182-%E8%AF%AD%E6%B3%95%E9%94%99%E8%AF%AF">18.2 语法错误</a></li><li><a href="#183-%E8%BF%90%E8%A1%8C%E9%94%99%E8%AF%AF">18.3 运行错误</a></li><li><a href="#184-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">18.4 错误处理</a></li><li><a href="#185-pcall-%E5%92%8C-xpcalldebug">18.5 pcall 和 xpcall、debug</a></li></ul></li><li><a href="#%E5%8D%81%E4%B9%9D-%E8%B0%83%E8%AF%95debug">十九 调试(Debug)</a><ul><li><a href="#191-%E6%A6%82%E8%BF%B0%E5%8F%8Adebug%E7%9A%84%E6%96%B9%E6%B3%95">19.1 概述及Debug的方法</a></li><li><a href="#192-%E8%B0%83%E8%AF%95%E7%B1%BB%E5%9E%8B">19.2 调试类型</a></li></ul></li><li><a href="#%E4%BA%8C%E5%8D%81-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6">二十 垃圾回收</a><ul><li><a href="#201-%E6%A6%82%E8%BF%B0">20.1 概述</a></li><li><a href="#202-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8%E5%87%BD%E6%95%B0">20.2 垃圾回收器函数</a></li></ul></li><li><a href="#%E4%BA%8C%E5%8D%81%E4%B8%80-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1">二十一 面向对象（⭐）</a><ul><li><a href="#211-%E6%A6%82%E8%BF%B0">21.1 概述</a></li><li><a href="#212-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%89%B9%E5%BE%81">21.2 面向对象特征</a></li><li><a href="#213-lua-%E4%B8%AD%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1">21.3 Lua 中面向对象</a></li><li><a href="#214-%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8B">21.4 简单实例（⭐）</a></li><li><a href="#215-%E7%82%B9%E8%B0%83%E7%94%A8%E5%92%8C%E5%86%92%E5%8F%B7%E8%B0%83%E7%94%A8%E7%9A%84%E5%8C%BA%E5%88%AB">21.5 点调用和冒号调用的区别（⭐⭐⭐）</a></li><li><a href="#216-lua-%E7%BB%A7%E6%89%BF">21.6 Lua 继承(⭐⭐⭐)</a></li><li><a href="#217-lua%E5%A4%9A%E6%80%81%E5%87%BD%E6%95%B0%E9%87%8D%E5%86%99">21.7 Lua多态（函数重写）</a></li></ul></li><li><a href="#%E4%BA%8C%E5%8D%81%E4%BA%8C-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BF%E9%97%AEluasql">二十二 数据库访问（LuaSQL）</a><ul><li><a href="#221-%E6%A6%82%E8%BF%B0">22.1 概述</a></li><li><a href="#222-%E5%AE%89%E8%A3%85">22.2 安装</a></li><li><a href="#223-%E5%AE%9E%E4%BE%8B">22.3 实例</a></li></ul></li></ul><h1 id="%E9%9B%B6-%E5%BC%95%E7%94%A8" tabindex="-1">零 引用</h1><p>本文件内容来自以下网址：</p><ol><li><a href="https://www.runoob.com/lua/lua-tutorial.html">Lua 教程 | 菜鸟教程 (runoob.com)</a></li><li><a href="https://www.runoob.com/manual/lua53doc/contents.html">Lua 5.3 中文参考手册(菜鸟教程翻译)</a></li><li><a href="https://blog.csdn.net/duanxuyun/article/details/4751118">lua 的io操作，非常详细。</a></li></ol><h1 id="%E4%B8%80-%E6%A6%82%E8%BF%B0" tabindex="-1">一 概述</h1><ol><li>Lua 是一种轻量小巧的脚本语言，用标准C语言编写并以源代码形式开放， 其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定制功能。<br>Lua 是巴西里约热内卢天主教大学（Pontifical Catholic University of Rio de Janeiro）里的一个研究小组于 1993 年开发的，该小组成员有：Roberto Ierusalimschy、Waldemar Celes 和 Luiz Henrique de Figueiredo。</li><li>设计目的<br>其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定制功能。</li><li>特性</li></ol><ul><li>轻量级: 它用标准C语言编写并以源代码形式开放，编译后仅仅一百余K，可以很方便的嵌入别的程序里。</li><li>可扩展: Lua提供了非常易于使用的扩展接口和机制：由宿主语言(通常是C或C++)提供这些功能，Lua可以使用它们，就像是本来就内置的功能一样。</li><li>其它特性:</li><li><ul><li>支持面向过程(procedure-oriented)编程和函数式编程(functional programming)；</li><li>自动内存管理；只提供了一种通用类型的表（table），用它可以实现数组，哈希表，集合，对象；</li><li>语言内置模式匹配；闭包(closure)；函数也可以看做一个值；提供多线程（协同进程，并非操作系统所支持的线程）支持；</li><li>通过闭包和table可以很方便地支持面向对象编程所需要的一些关键机制，比如数据抽象，虚函数，继承和重载等。</li></ul></li></ul><ol start="4"><li>应用场景<ul><li>游戏开发</li><li>独立应用脚本</li><li>Web 应用脚本</li><li>扩展和数据库插件如：MySQL Proxy 和 MySQL WorkBench安全系统，如入侵检测系统</li></ul></li></ol><h1 id="%E4%BA%8C-%E5%AE%89%E8%A3%85" tabindex="-1">二 安装</h1><p>首先安装Lua for Windows(exe包)： <a href="https://github.com/rjpcomputing/luaforwindows/releases">Releases · rjpcomputing/luaforwindows (github.com)</a><br><img src="/2024/08/20/lua-lua%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%89%E8%A3%85%E6%88%AA%E5%9B%BE.jpg" alt><br>使用IDE：VSCode、IDEA、LuaStudio。这里我使用VSCode进行开发配置，相关配置内容（该内容我们忽略 4. Lua 编译环境配置中的1-6，因为我们下载的exe安装直接帮我们配置好了环境变量了）： <a href="https://blog.csdn.net/yanwennian/article/details/103480938">(3条消息) Visual Studio Code -&gt; VSCode 开发环境搭建 ---- Lua 开发环境搭建 及 代码运行（code runner 插件）_vscode安装lua_YanWennian的博客-CSDN博客</a></p><h1 id="%E4%B8%89-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95" tabindex="-1">三 基本语法</h1><h3 id="3.1-%E4%BA%A4%E4%BA%92%E5%BC%8F%E7%BC%96%E7%A8%8B" tabindex="-1">3.1 交互式编程</h3><p>直接在命令行中输入程序并立即查看效果，通过lua -i或lua来启用</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ lua -i </span><br><span class="line">$ Lua <span class="number">5.3</span><span class="number">.0</span>  Copyright (C) <span class="number">1994</span><span class="number">-2015</span> Lua.org, PUC-Rio</span><br><span class="line">&gt; </span><br><span class="line"><span class="comment">-- 执行命令</span></span><br><span class="line">&gt; <span class="built_in">print</span>(<span class="string">&quot;Hello World！&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="3.2-%E8%84%9A%E6%9C%AC%E5%BC%8F%E7%BC%96%E7%A8%8B" tabindex="-1">3.2 脚本式编程</h3><ol><li>将代码存储在本地以.lua为扩展名的文件中（ hello.lua ），其中内容为：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;www.runoob.com&quot;</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>在文件所在目录的终端(或cmd)执行脚本</li></ol><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ lua hello.lua</span><br><span class="line">Hello World！</span><br><span class="line">www.runoob.com</span><br></pre></td></tr></table></figure><ol start="3"><li>我们也可以将代码修改为如下形式来执行脚本（在开头添加：#!/usr/local/bin/lua）：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/<span class="keyword">local</span>/bin/lua</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;www.runoob.com&quot;</span>)</span><br></pre></td></tr></table></figure><p>以上代码中，我们指定了 Lua 的解释器 /usr/local/bin 就是指你本地lua的位置。window安装后的lua可能不太需要，但在linux下需要在头部添加#!/usr/local/bin/lua。</p><h3 id="3.3-%E6%B3%A8%E9%87%8A" tabindex="-1">3.3 注释</h3><ol><li>单行注释<br>两个减号</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--</span></span><br></pre></td></tr></table></figure><ol start="2"><li>多行注释</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment"> 多行注释</span></span><br><span class="line"><span class="comment"> 多行注释</span></span><br><span class="line"><span class="comment"> --]]</span></span><br></pre></td></tr></table></figure><h3 id="3.4-%E6%A0%87%E8%AF%86%E7%AC%A6" tabindex="-1">3.4 标识符</h3><ol><li>以字母或下划线开头 + 0个或者多个字母、下划线、数字</li><li>最好不要使用下划线加大写字母的标示符，因为Lua的保留字也是这样的。</li><li>Lua 不允许使用特殊字符如 @, $, 和 % 来定义标示符</li><li>Lua 区分大小写。</li><li>一些正确的定义</li></ol><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mohd         zara      abc     move<span class="emphasis">_name    a_</span>123</span><br><span class="line">myname50     <span class="emphasis">_temp     j       a23b9        retVal</span></span><br></pre></td></tr></table></figure><ol start="6"><li>关键字</li></ol><p><img src="/2024/08/20/lua-lua%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%85%B3%E9%94%AE%E5%AD%97.png" alt="关键字"><br>一般约定，以下划线开头连接一串大写字母的名字（比如 _VERSION）被保留用于 Lua 内部全局变量。</p><h1 id="%E5%9B%9B-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B" tabindex="-1">四 数据类型</h1><table><thead><tr><th>数据类型</th><th>描述</th></tr></thead><tbody><tr><td>nil</td><td>这个最简单，只有值nil属于该类，<strong>表示一个无效值</strong>（在条件表达式中相当于false）。</td></tr><tr><td>boolean</td><td>包含两个值：false和true。</td></tr><tr><td>number</td><td>表示双精度类型的<strong>实浮点数</strong></td></tr><tr><td>string</td><td>字符串由一对<strong>双引号或单引号</strong>来表示</td></tr><tr><td>function</td><td>由 C 或 Lua 编写的<strong>函数</strong></td></tr><tr><td>userdata</td><td>表示任意存储在变量中的<strong>C数据结构</strong></td></tr><tr><td>thread</td><td>表示执行的<strong>独立线路</strong>，用于执行<strong>协同程序</strong></td></tr><tr><td>table</td><td>Lua 中的表（table）其实是一个&quot;<strong>关联数组</strong>&quot;（associative arrays），数组的<strong>索引</strong>可以是数字、字符串或表类型。在 Lua 里，table 的创建是通过&quot;<strong>构造表达式</strong>&quot;来完成，<strong>最简单构造表达式是{}</strong>，用来创建一个<strong>空表</strong>。</td></tr></tbody></table><h3 id="4.1-nil(%E7%A9%BA)" tabindex="-1">4.1 nil(空)</h3><ol><li>给<strong>全局</strong>变量或者 <strong>table 表</strong>里的变量<strong>赋一个 nil</strong> 值，等同于把它们<strong>删掉</strong></li><li>nil 作比较时应该加上双引号 &quot;：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">type</span>(X)</span><br><span class="line"><span class="literal">nil</span></span><br><span class="line">&gt; <span class="built_in">type</span>(X)==<span class="literal">nil</span></span><br><span class="line"><span class="literal">false</span></span><br><span class="line">&gt; <span class="built_in">type</span>(X)==<span class="string">&quot;nil&quot;</span></span><br><span class="line"><span class="literal">true</span></span><br><span class="line"><span class="comment">--- 因是 type(X) 实质是返回的 &quot;nil&quot; 字符串，是一个 string 类型：</span></span><br><span class="line"><span class="comment">--- type(type(X))==string</span></span><br></pre></td></tr></table></figure><h3 id="4.2-boolean%EF%BC%88%E5%B8%83%E5%B0%94%EF%BC%89" tabindex="-1">4.2 boolean（布尔）</h3><p>boolean 类型只有两个可选值：true（真） 和 false（假），<strong>Lua 把 false 和 nil 看作是 false，其他的都为 true，<font color="red">数字 0 也是 true</font></strong></p><h3 id="4.3-number%EF%BC%88%E6%95%B0%E5%AD%97%EF%BC%89" tabindex="-1">4.3 number（数字）</h3><p>Lua 默认只有一种 number 类型 – double（双精度）类型 <strong>（默认类型可以修改 luaconf.h 里的定义）</strong></p><h3 id="4.4-string%EF%BC%88%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%89" tabindex="-1">4.4 string（字符串）</h3><ol><li>字符串由一对双引号或单引号来表示</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">string1 = <span class="string">&quot;this is string1&quot;</span></span><br><span class="line">string2 = <span class="string">&#x27;this is string2&#x27;</span></span><br><span class="line"></span><br><span class="line">html = <span class="string">[[</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;a href=&quot;http://www.runoob.com/&quot;&gt;菜鸟教程&lt;/a&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">]]</span></span><br><span class="line"><span class="built_in">print</span>(html)</span><br></pre></td></tr></table></figure><ol><li>在对一个数字字符串上进行算术操作时，Lua 会尝试将这个数字字符串转成一个数字:</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">print</span>(<span class="string">&quot;2&quot;</span> + <span class="number">6</span>)</span><br><span class="line"><span class="number">8.0</span></span><br><span class="line">&gt; <span class="built_in">print</span>(<span class="string">&quot;2&quot;</span> + <span class="string">&quot;6&quot;</span>)</span><br><span class="line"><span class="number">8.0</span></span><br><span class="line">&gt; <span class="built_in">print</span>(<span class="string">&quot;2 + 6&quot;</span>)</span><br><span class="line"><span class="number">2</span> + <span class="number">6</span></span><br><span class="line">&gt; <span class="built_in">print</span>(<span class="string">&quot;-2e2&quot;</span> * <span class="string">&quot;6&quot;</span>)</span><br><span class="line"><span class="number">-1200.0</span></span><br><span class="line">&gt; <span class="built_in">print</span>(<span class="string">&quot;error&quot;</span> + <span class="number">1</span>)</span><br><span class="line"><span class="built_in">stdin</span>:<span class="number">1</span>: attempt to perform arithmetic on a <span class="built_in">string</span> value</span><br><span class="line">stack <span class="built_in">traceback</span>:</span><br><span class="line">        <span class="built_in">stdin</span>:<span class="number">1</span>: <span class="keyword">in</span> main chunk</span><br><span class="line">        [C]: <span class="keyword">in</span> ?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><ol><li>连接字符串使用 …</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">print</span>(<span class="string">&quot;a&quot;</span> .. <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">ab</span><br><span class="line">&gt; <span class="built_in">print</span>(<span class="number">157</span> .. <span class="number">428</span>)</span><br><span class="line"><span class="number">157428</span></span><br><span class="line">&gt; </span><br></pre></td></tr></table></figure><ol><li>使用#来计算字符串长度</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">len</span> = <span class="string">&quot;www.runoob.com&quot;</span></span><br><span class="line">&gt; <span class="built_in">print</span>(#<span class="built_in">len</span>)</span><br><span class="line"><span class="number">14</span></span><br><span class="line">&gt; <span class="built_in">print</span>(#<span class="string">&quot;www.runoob.com&quot;</span>)</span><br><span class="line"><span class="number">14</span></span><br></pre></td></tr></table></figure><h3 id="4.5-%E8%A1%A8" tabindex="-1">4.5 表</h3><p>在 Lua 里，table 的创建是通过&quot;构造表达式&quot;来完成，最简单构造表达式是{}，用来创建一个空表。</p><ol><li>直接初始化表:</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个空的 table</span></span><br><span class="line"><span class="keyword">local</span> tbl1 = &#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">-- 直接初始表</span></span><br><span class="line"><span class="keyword">local</span> tbl2 = &#123;<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;pear&quot;</span>, <span class="string">&quot;orange&quot;</span>, <span class="string">&quot;grape&quot;</span>&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>Lua 中的表（table）其实是一个&quot;关联数组&quot;（associative arrays），数组的索引可以是数字或者是字符串</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- table_test.lua 脚本文件</span></span><br><span class="line">a = &#123;&#125;</span><br><span class="line">a[<span class="string">&quot;key&quot;</span>] = <span class="string">&quot;value&quot;</span></span><br><span class="line">key = <span class="number">10</span></span><br><span class="line">a[key] = <span class="number">22</span></span><br><span class="line">a[key] = a[key] + <span class="number">11</span></span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(a) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(k .. <span class="string">&quot; : &quot;</span> .. v)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ol start="3"><li>不同于其他语言的数组把 0 作为数组的初始索引，<strong>在 Lua 里表的默认初始索引一般以 1 开始</strong>。</li><li>table <strong>不会固定长度大小</strong>，有<strong>新数据添加</strong>时 table 长度会<strong>自动增长</strong>，没<strong>初始的 table 都是 nil</strong></li></ol><h3 id="4.6-function%EF%BC%88%E5%87%BD%E6%95%B0%EF%BC%89" tabindex="-1">4.6 function（函数）</h3><ol><li>在 Lua 中，函数是被看作是&quot;第一类值（First-Class Value）&quot;，函数可以存在变量里:</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- function_test.lua 脚本文件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial1</span><span class="params">(n)</span></span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> n * factorial1(n - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(factorial1(<span class="number">5</span>))</span><br><span class="line">factorial2 = factorial1</span><br><span class="line"><span class="built_in">print</span>(factorial2(<span class="number">5</span>))</span><br></pre></td></tr></table></figure><ol start="2"><li>function 可以以匿名函数（anonymous function）的方式通过参数传递:</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- function_test2.lua 脚本文件</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testFun</span><span class="params">(tab,fun)</span></span></span><br><span class="line">        <span class="keyword">for</span> k ,v <span class="keyword">in</span> <span class="built_in">pairs</span>(tab) <span class="keyword">do</span></span><br><span class="line">                <span class="built_in">print</span>(fun(k,v));</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">tab=&#123;key1=<span class="string">&quot;val1&quot;</span>,key2=<span class="string">&quot;val2&quot;</span>&#125;;</span><br><span class="line">testFun(tab,</span><br><span class="line"><span class="function"><span class="keyword">function</span><span class="params">(key,val)</span></span><span class="comment">--匿名函数</span></span><br><span class="line">        <span class="keyword">return</span> key..<span class="string">&quot;=&quot;</span>..val;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="4.7-thread%EF%BC%88%E7%BA%BF%E7%A8%8B%EF%BC%89" tabindex="-1">4.7 thread（线程）</h3><p>在 Lua 里，最主要的线程是协同程序（coroutine）。它跟线程（thread）差不多，<strong>拥有自己独立的栈、局部变量和指令指针，可以跟其他协同程序共享全局变量和其他大部分东西</strong>。</p><p>线程跟协程的区别：<strong>线程可以同时多个运行，而协程任意时刻只能运行一个</strong>，并且处于<strong>运行状态的协程只有被挂起（suspend）时才会暂停</strong>。</p><h3 id="4.8-userdata%EF%BC%88%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%EF%BC%89" tabindex="-1">4.8 userdata（自定义类型）</h3><p>userdata 是一种<strong>用户自定义数据</strong>，用于表示一种<strong>由应用程序或 C/C++ 语言库所创建的类型</strong>，可以将任意 C/C++ 的任意数据类型的数据（通常是 struct 和 指针）<strong>存储到 Lua 变量中调用</strong>。</p><h1 id="%E4%BA%94-%E5%8F%98%E9%87%8F" tabindex="-1">五 变量</h1><h3 id="5.1-%E5%8F%98%E9%87%8F" tabindex="-1">5.1 变量</h3><ol><li>变量在使用前，需要在代码中进行声明，即创建该变量。</li><li>Lua 变量有三种类型：全局变量、局部变量、表中的域。<ul><li>Lua 中的<strong>变量全是全局变量</strong>，哪怕是语句块或是函数里，除非<strong>用 local 显式声明为局部变量</strong>。</li><li><strong>局部变量的作用域</strong>为从声明位置开始到所在语句块结束。</li></ul></li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- test.lua 文件脚本</span></span><br><span class="line">a = <span class="number">5</span>               <span class="comment">-- 全局变量</span></span><br><span class="line"><span class="keyword">local</span> b = <span class="number">5</span>         <span class="comment">-- 局部变量</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">joke</span><span class="params">()</span></span></span><br><span class="line">    c = <span class="number">5</span>           <span class="comment">-- 全局变量</span></span><br><span class="line">    <span class="keyword">local</span> d = <span class="number">6</span>     <span class="comment">-- 局部变量</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">joke()</span><br><span class="line"><span class="built_in">print</span>(c,d)          <span class="comment">--&gt; 5 nil</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">    <span class="keyword">local</span> a = <span class="number">6</span>     <span class="comment">-- 局部变量</span></span><br><span class="line">    b = <span class="number">6</span>           <span class="comment">-- 对局部变量重新赋值</span></span><br><span class="line">    <span class="built_in">print</span>(a,b);     <span class="comment">--&gt; 6 6</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a,b)      <span class="comment">--&gt; 5 6</span></span><br></pre></td></tr></table></figure><ol start="3"><li>变量的默认值均为 nil</li></ol><h3 id="5.2-%E8%B5%8B%E5%80%BC%E8%AF%AD%E5%8F%A5" tabindex="-1">5.2 赋值语句</h3><ol><li>赋值是改变一个变量的值和改变表域的最基本的方法。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;hello&quot;</span> .. <span class="string">&quot;world&quot;</span></span><br><span class="line">t.n = t.n + <span class="number">1</span></span><br></pre></td></tr></table></figure><ol start="2"><li>Lua 可以对<strong>多个变量同时赋值</strong>，变量列表和值列表的各个元素用逗号分开，<strong>赋值语句右边的值会依次赋给左边的变量</strong>。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a, b = <span class="number">10</span>, <span class="number">2</span>*x       &lt;<span class="comment">--&gt;       a=10; b=2*x</span></span><br></pre></td></tr></table></figure><ol start="3"><li>遇到赋值语句<strong>Lua会先计算右边所有的值然后再执行赋值操作</strong>，所以我们可以<strong>这样进行交换变量的值：</strong>(⭐)</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x, y = y, x                     <span class="comment">-- swap &#x27;x&#x27; for &#x27;y&#x27;</span></span><br><span class="line">a[i], a[j] = a[j], a[i]         <span class="comment">-- swap &#x27;a[i]&#x27; for &#x27;a[j]&#x27;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>当变量个数和值的个数不一致时，Lua会一直以变量个数为基础采取以下策略：<ul><li>a. 变量个数 &gt; 值的个数             按变量个数补足nil</li><li>b. 变量个数 &lt; 值的个数             多余的值会被忽略</li></ul></li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a, b, c = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(a,b,c)             <span class="comment">--&gt; 0   1   nil</span></span><br><span class="line"> </span><br><span class="line">a, b = a+<span class="number">1</span>, b+<span class="number">1</span>, b+<span class="number">2</span>     <span class="comment">-- value of b+2 is ignored</span></span><br><span class="line"><span class="built_in">print</span>(a,b)               <span class="comment">--&gt; 1   2</span></span><br><span class="line"> </span><br><span class="line">a, b, c = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(a,b,c)             <span class="comment">--&gt; 0   nil   nil</span></span><br></pre></td></tr></table></figure><ol start="5"><li><strong>应该尽可能的使用局部变量，有两个好处：</strong><ul><li><strong>避免命名冲突</strong>。</li><li>访问局部变量的<strong>速度</strong>比全局变量<strong>更快</strong>。</li></ul></li></ol><h3 id="5.3-%E7%B4%A2%E5%BC%95" tabindex="-1">5.3 索引</h3><ol><li>对 table 的索引使用方括号 []。Lua 也提供了 <strong>. 操作</strong>。</li></ol><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">t[i]</span><br><span class="line">t.i                 -- 当索引为字符串类型时的一种简化写法</span><br><span class="line">gettable<span class="emphasis">_event(t,i) -- 采用索引访问本质上是一个类似这样的函数调用</span></span><br></pre></td></tr></table></figure><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; site = &#123;&#125;</span><br><span class="line">&gt; site[<span class="string">&quot;key&quot;</span>] = <span class="string">&quot;www.runoob.com&quot;</span></span><br><span class="line">&gt; <span class="built_in">print</span>(site[<span class="string">&quot;key&quot;</span>])</span><br><span class="line">www.runoob.com</span><br><span class="line">&gt; <span class="built_in">print</span>(site.key)</span><br><span class="line">www.runoob.com</span><br></pre></td></tr></table></figure><h1 id="%E5%85%AD-%E5%BE%AA%E7%8E%AF" tabindex="-1">六 循环</h1><h3 id="6.1-%E5%BE%AA%E7%8E%AF%E6%96%B9%E5%BC%8F" tabindex="-1">6.1 循环方式</h3><ol><li>Lua 语言提供了以下几种循环处理方式：</li></ol><table><thead><tr><th>循环类型</th><th>描述</th></tr></thead><tbody><tr><td>while 循环</td><td>在条件为 true 时，让程序重复地执行某些语句。执行语句前会先检查条件是否为 true。</td></tr><tr><td>for 循环</td><td>重复执行指定语句，重复次数可在 for 语句中控制。</td></tr><tr><td>repeat…until</td><td>重复执行循环，直到 指定的条件为真时为止</td></tr><tr><td>循环嵌套</td><td>可以在循环内嵌套一个或多个循环语句（while do … end;for … do … end;repeat … until;）</td></tr></tbody></table><h3 id="6.2-%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5" tabindex="-1">6.2 循环控制语句</h3><ol><li>Lua 支持以下循环控制语句：</li></ol><table><thead><tr><th>控制语句</th><th>描述</th></tr></thead><tbody><tr><td>break 语句</td><td>退出当前循环或语句，并开始脚本执行紧接着的语句。</td></tr><tr><td>goto 语句</td><td>将程序的控制点转移到一个标签处。</td></tr></tbody></table><ol start="2"><li><p>Lua不支持continue，但可以用以下方式实现continue功能：</p><ul><li>使用repeat until实现</li></ul> <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i = <span class="number">10</span>, <span class="number">1</span>, <span class="number">-1</span> <span class="keyword">do</span></span><br><span class="line"><span class="keyword">repeat</span></span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">5</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;continue code here&quot;</span>)</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">print</span>(i, <span class="string">&quot;loop code here&quot;</span>)</span><br><span class="line"><span class="keyword">until</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ul><li>使用goto实现</li></ul> <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>, <span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> i &lt;= <span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">print</span>(i, <span class="string">&quot;yes continue&quot;</span>)</span><br><span class="line">        <span class="keyword">goto</span> continue</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="built_in">print</span>(i, <span class="string">&quot; no continue&quot;</span>)</span><br><span class="line">    ::continue::</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">[[i&#x27;m end]]</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ul><li>使用if else实现</li></ul> <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>, <span class="number">3</span> <span class="keyword">do</span> </span><br><span class="line">    <span class="built_in">print</span>(i)   </span><br><span class="line">    <span class="keyword">if</span> i &lt;= <span class="number">2</span> <span class="keyword">then</span>     </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;continue the loop&quot;</span>)  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; loop area&quot;</span>)   </span><br><span class="line"><span class="keyword">end</span>   </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;end of loop&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="6.3-%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF" tabindex="-1">6.3 无限循环</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>( <span class="literal">true</span> )</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;循环将永远执行下去&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h1 id="%E4%B8%83-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6-%EF%BC%88if-else%EF%BC%89" tabindex="-1">七 流程控制 （if else）</h1><table><thead><tr><th>语句</th><th>描述</th></tr></thead><tbody><tr><td>if 语句</td><td>if 语句 由一个布尔表达式作为条件判断，其后紧跟其他语句组成。</td></tr><tr><td>if…else</td><td>语句if 语句 可以与 else 语句搭配使用, 在 if 条件表达式为 false 时执行 else 语句代码。</td></tr><tr><td>if 嵌套语句</td><td>你可以在if 或 else if中使用一个或多个 if 或 else if 语句 。</td></tr></tbody></table><p>控制结构的条件表达式结果可以是任何值，Lua认为false和nil为假，true和非nil为真。</p><p><strong>要注意的是Lua中 0 为 true：</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[ 0 为 true ]</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;0 为 true&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h1 id="%E5%85%AB-%E5%87%BD%E6%95%B0" tabindex="-1">八 函数</h1><h3 id="8.1-%E6%A6%82%E8%BF%B0" tabindex="-1">8.1 概述</h3><ol><li><p>在Lua中，函数是对语句和表达式进行抽象的主要方法。既可以用来处理一些特殊的工作，也可以用来计算一些值。</p></li><li><p>Lua 提供了<strong>许多的内建函数</strong>，你可以很方便的在程序中调用它们，<strong>如print()函数</strong>可以将传入的参数打印在控制台上。</p></li><li><p>Lua 函数主要有两种用途：</p><ul><li>完成指定的任务，这种情况下函数作为调用语句使用；</li><li>计算并返回值，这种情况下函数作为赋值语句的表达式使用。</li></ul></li></ol><h3 id="8.2-%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89" tabindex="-1">8.2 函数的定义</h3><ol><li><p>Lua 编程语言函数定义格式如下：</p><p><font color="red">optional_function_scope</font> function <font color="green">function_name</font> ( <font color="blue">argument1, argument2, argument3…, argumentn</font>)<br><font color="pink">function_body</font><br>return <font color="orange">result_params_comma_separated</font><br>end</p></li><li><p>解析</p></li></ol><ul><li><p><font color="red">optional_function_scope</font>: 该参数是可选的指定函数是全局函数还是局部函数，未设置该参数默认为全局函数，如果你需要设置函数为局部函数需要使用关键字 local。</p></li><li><p><font color="green">function_name</font>: 指定函数名称。</p></li><li><p><font color="blue">argument1, argument2, argument3…, argumentn</font>: 函数参数，多个参数以逗号隔开，函数也可以不带参数。</p></li><li><p><font color="pink">function_body</font>: 函数体，函数中需要执行的代码语句块。</p></li><li><p><font color="orange">result_params_comma_separated</font>: 函数返回值，Lua语言函数可以返回多个值，每个值以逗号隔开。</p></li></ul><ol start="3"><li><p>实例</p><ul><li>定义函数 max()，参数为 num1, num2，用于比较两值的大小，并返回最大值</li></ul> <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[ 函数返回两个值的最大值 --]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">max</span><span class="params">(num1, num2)</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (num1 &gt; num2) <span class="keyword">then</span></span><br><span class="line">    result = num1;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    result = num2;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> result; </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 调用函数</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;两值比较最大值为 &quot;</span>,<span class="built_in">max</span>(<span class="number">10</span>,<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;两值比较最大值为 &quot;</span>,<span class="built_in">max</span>(<span class="number">5</span>,<span class="number">6</span>))</span><br></pre></td></tr></table></figure><ul><li>Lua 中我们可以将<strong>函数作为参数</strong>传递给函数</li></ul> <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">myprint = <span class="function"><span class="keyword">function</span><span class="params">(param)</span></span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;这是打印函数 -   ##&quot;</span>,param,<span class="string">&quot;##&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(num1,num2,functionPrint)</span></span></span><br><span class="line">result = num1 + num2</span><br><span class="line"><span class="comment">-- 调用传递的函数参数</span></span><br><span class="line">functionPrint(result)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">myprint(<span class="number">10</span>)</span><br><span class="line"><span class="comment">-- myprint 函数作为参数传递</span></span><br><span class="line">add(<span class="number">2</span>,<span class="number">5</span>,myprint)</span><br></pre></td></tr></table></figure></li></ol><h3 id="8.3-%E5%A4%9A%E8%BF%94%E5%9B%9E%E5%80%BC" tabindex="-1">8.3 多返回值</h3><ol><li>Lua函数可以返回多个结果值，比如string.find，其返回匹配串&quot;开始和结束的下标&quot;（如果不存在匹配串返回nil）。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; s, e = <span class="built_in">string</span>.<span class="built_in">find</span>(<span class="string">&quot;www.runoob.com&quot;</span>, <span class="string">&quot;runoob&quot;</span>) </span><br><span class="line">&gt; <span class="built_in">print</span>(s, e)</span><br><span class="line"><span class="number">5</span>    <span class="number">10</span></span><br></pre></td></tr></table></figure><ol start="2"><li>Lua函数中，在<strong>return后列出要返回的值</strong>的列表即可返回多值（比如用，隔开）</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">maximum</span> <span class="params">(a)</span></span></span><br><span class="line">    <span class="keyword">local</span> mi = <span class="number">1</span>             <span class="comment">-- 最大值索引</span></span><br><span class="line">    <span class="keyword">local</span> m = a[mi]          <span class="comment">-- 最大值</span></span><br><span class="line">    <span class="keyword">for</span> i,val <span class="keyword">in</span> <span class="built_in">ipairs</span>(a) <span class="keyword">do</span></span><br><span class="line">       <span class="keyword">if</span> val &gt; m <span class="keyword">then</span></span><br><span class="line">           mi = i</span><br><span class="line">           m = val</span><br><span class="line">       <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> m, mi <span class="comment">--多返回值</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(maximum(&#123;<span class="number">8</span>,<span class="number">10</span>,<span class="number">23</span>,<span class="number">12</span>,<span class="number">5</span>&#125;))</span><br></pre></td></tr></table></figure><ol start="2"><li>注意一下多返回值的函数在赋值时的情况，<strong>仅仅只有放在所有逗号之后的那个函数会把返回值展开</strong>。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>,<span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> b,c,d,e = add(),add()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment">-- 1</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">-- 1</span></span><br><span class="line"><span class="built_in">print</span>(d) <span class="comment">-- 0</span></span><br><span class="line"><span class="built_in">print</span>(e) <span class="comment">-- nil</span></span><br></pre></td></tr></table></figure><h3 id="8.4-%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0" tabindex="-1">8.4 可变参数</h3><ol><li>Lua 函数可以接受可变数目的参数，和 C 语言类似，在<strong>函数参数列表中使用三点 … 表示</strong>函数有可变的参数。 (<strong>可变参数通过循环遍历…进行读取</strong>)</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(...)</span></span>  </span><br><span class="line"><span class="keyword">local</span> s = <span class="number">0</span>  </span><br><span class="line">  <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">ipairs</span>&#123;...&#125; <span class="keyword">do</span>   <span class="comment">--&gt; &#123;...&#125; 表示一个由所有变长参数构成的数组  </span></span><br><span class="line">    s = s + v  </span><br><span class="line">  <span class="keyword">end</span>  </span><br><span class="line">  <span class="keyword">return</span> s  </span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>))  <span class="comment">---&gt;25</span></span><br></pre></td></tr></table></figure><ol start="2"><li>通过<strong>select(“#”,…)</strong> 来获取可变参数的数量，<strong>避免</strong>参数中存在 <strong>nil的元素</strong>导致长度计算出错</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">average</span><span class="params">(...)</span></span></span><br><span class="line">   result = <span class="number">0</span></span><br><span class="line">   <span class="keyword">local</span> <span class="built_in">arg</span>=&#123;...&#125;</span><br><span class="line">   <span class="keyword">for</span> i,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(<span class="built_in">arg</span>) <span class="keyword">do</span></span><br><span class="line">      result = result + v</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;总共传入 &quot;</span> .. <span class="built_in">select</span>(<span class="string">&quot;#&quot;</span>,...) .. <span class="string">&quot; 个数&quot;</span>)</span><br><span class="line">   <span class="keyword">return</span> result/<span class="built_in">select</span>(<span class="string">&quot;#&quot;</span>,...)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;平均值为&quot;</span>,average(<span class="number">10</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>))</span><br></pre></td></tr></table></figure><ol start="3"><li>有时候我们可能需要<strong>几个固定参数加上可变参数</strong>，<strong>固定参数必须放在变长参数之前</strong>:</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fwrite</span><span class="params">(fmt, ...)</span></span>  <span class="comment">---&gt; 固定的参数fmt</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">io</span>.<span class="built_in">write</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(fmt, ...))     </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">fwrite(<span class="string">&quot;runoob\n&quot;</span>)       <span class="comment">---&gt;fmt = &quot;runoob&quot;, 没有变长参数。  </span></span><br><span class="line">fwrite(<span class="string">&quot;%d%d\n&quot;</span>, <span class="number">1</span>, <span class="number">2</span>)   <span class="comment">---&gt;fmt = &quot;%d%d&quot;, 变长参数为 1 和 2</span></span><br></pre></td></tr></table></figure><ol start="4"><li><p>通常在遍历变长参数的时候只需要使用 {…}，然而<strong>变长参数可能会包含一些 nil</strong>，那么就<strong>可以用 select 函数来访问变长参数</strong>了：select(‘#’, …) 或者 select(n, …)</p><ul><li><strong>select(‘#’, …) 返回可变参数的长度</strong>。</li><li><strong>select(n, …) 用于返回从起点 n 开始到结束位置的所有参数列表，返回的是多个参数，而不是一个table</strong>。</li></ul></li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span><span class="params">(...)</span></span></span><br><span class="line">    a = <span class="built_in">select</span>(<span class="number">3</span>,...)  <span class="comment">--&gt;从第三个位置开始，变量 a 对应右边变量列表的第一个参数</span></span><br><span class="line">    <span class="built_in">print</span> (a)</span><br><span class="line">    <span class="built_in">print</span> (<span class="built_in">select</span>(<span class="number">3</span>,...)) <span class="comment">--&gt;打印所有列表参数</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">f(<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment">--输出</span></span><br><span class="line"><span class="comment">--2</span></span><br><span class="line"><span class="comment">--2       3       4       5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(...)</span></span>  </span><br><span class="line">        <span class="keyword">for</span> i = <span class="number">1</span>, <span class="built_in">select</span>(<span class="string">&#x27;#&#x27;</span>, ...) <span class="keyword">do</span>  <span class="comment">--&gt;获取参数总数</span></span><br><span class="line">            <span class="keyword">local</span> <span class="built_in">arg</span> = <span class="built_in">select</span>(i, ...); <span class="comment">--&gt;读取参数，arg 对应的是右边变量列表的第一个参数</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;arg&quot;</span>, <span class="built_in">arg</span>);  </span><br><span class="line">        <span class="keyword">end</span>  </span><br><span class="line">    <span class="keyword">end</span>  </span><br><span class="line">  </span><br><span class="line">    foo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);  </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">输出</span></span><br><span class="line"><span class="comment">arg    1</span></span><br><span class="line"><span class="comment">arg    2</span></span><br><span class="line"><span class="comment">arg    3</span></span><br><span class="line"><span class="comment">arg    4</span></span><br><span class="line"><span class="comment">]]</span><span class="comment">--</span></span><br></pre></td></tr></table></figure><h1 id="%E4%B9%9D-%E8%BF%90%E7%AE%97%E7%AC%A6" tabindex="-1">九 运算符</h1><h3 id="9.1-%E8%BF%90%E7%AE%97%E7%AC%A6%E7%B1%BB%E5%9E%8B" tabindex="-1">9.1 运算符类型</h3><ul><li>算术运算符</li><li>关系运算符</li><li>逻辑运算符</li><li>其他运算符</li></ul><h3 id="9.2-%E7%AE%97%E6%95%B0%E8%BF%90%E7%AE%97%E7%AC%A6" tabindex="-1">9.2 算数运算符</h3><ol><li>下表列出了 Lua 语言中的常用算术运算符，设定 A 的值为10，B 的值为 20：</li></ol><table><thead><tr><th>操作符</th><th>描述</th><th>实例</th></tr></thead><tbody><tr><td>+</td><td>加法</td><td>A + B 输出结果 30</td></tr><tr><td>-</td><td>减法</td><td>A - B 输出结果 -10</td></tr><tr><td>*</td><td>乘法</td><td>A * B 输出结果 200</td></tr><tr><td>/</td><td>除法</td><td>B / A 输出结果 2</td></tr><tr><td>%</td><td>取余</td><td>B % A 输出结果 0</td></tr><tr><td>^</td><td>乘幂</td><td>A^2 输出结果 100</td></tr><tr><td>-</td><td>负号</td><td>-A 输出结果 -10</td></tr><tr><td>//</td><td>整除运算符(&gt;=lua5.3)</td><td>5//2 输出结果 2</td></tr></tbody></table><ol start="2"><li>在 lua 中，/ 用作除法运算，计算结果包含小数部分，<strong>// 用作整除运算，计算结果不包含小数部分</strong></li></ol><h3 id="9.3-%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6" tabindex="-1">9.3 关系运算符</h3><p>下表列出了 Lua 语言中的常用关系运算符，设定 A 的值为10，B 的值为 20：</p><table><thead><tr><th>操作符</th><th>描述</th><th>实例</th></tr></thead><tbody><tr><td>==</td><td>等于，检测两个值是否相等，相等返回 true，否则返回 false</td><td>(A == B) 为 false。</td></tr><tr><td>~=</td><td>不等于，检测两个值是否相等，不相等返回 true，否则返回 false</td><td>(A ~= B) 为 true。</td></tr><tr><td>&gt;</td><td>大于，如果左边的值大于右边的值，返回 true，否则返回 false</td><td>(A &gt; B) 为 false。</td></tr><tr><td>&lt;</td><td>小于，如果左边的值大于右边的值，返回 false，否则返回 true</td><td>(A &lt; B) 为 true。</td></tr><tr><td>&gt;=</td><td>大于等于，如果左边的值大于等于右边的值，返回 true，否则返回 false</td><td>(A &gt;= B) 返回 false。</td></tr><tr><td>&lt;=</td><td>小于等于， 如果左边的值小于等于右边的值，返回 true，否则返回 false</td><td>(A &lt;= B) 返回 true。</td></tr></tbody></table><h3 id="9.4-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6" tabindex="-1">9.4 逻辑运算符</h3><p>下表列出了 Lua 语言中的常用逻辑运算符，设定 A 的值为 true，B 的值为 false： (<strong>lua逻辑运算符也具有短路的功能</strong>)</p><table><thead><tr><th>操作符</th><th>描述</th><th>实例</th></tr></thead><tbody><tr><td>and</td><td>逻辑与操作符。 若 A 为 false，则返回 A，否则返回 B。</td><td>(A and B) 为 false。</td></tr><tr><td>or</td><td>逻辑或操作符。 若 A 为 true，则返回 A，否则返回 B。</td><td>(A or B) 为 true。</td></tr><tr><td>not</td><td>逻辑非操作符。与逻辑运算结果相反，如果条件为 true，逻辑非为 false。</td><td>not(A and B) 为 true。</td></tr></tbody></table><h3 id="9.5-%E5%85%B6%E4%BB%96%E8%BF%90%E7%AE%97%E7%AC%A6" tabindex="-1">9.5 其他运算符</h3><p>下表列出了 Lua 语言中的连接运算符与计算表或字符串长度的运算符：</p><table><thead><tr><th>操作符</th><th>描述</th><th>实例</th></tr></thead><tbody><tr><td>…</td><td>连接两个字符串</td><td>a…b ，其中 a 为 &quot;Hello &quot; ， b 为 “World”, 输出结果为 “Hello World”。</td></tr><tr><td>#</td><td>一元运算符，返回字符串或表的长度。</td><td>#“Hello” 返回 5</td></tr></tbody></table><h3 id="9.6-%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7" tabindex="-1">9.6 运算符优先级</h3><ol><li>从高到低的顺序</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">^</span><br><span class="line"><span class="keyword">not</span>    - (unary)</span><br><span class="line">*      /       %</span><br><span class="line">+      -</span><br><span class="line">..</span><br><span class="line">&lt;      &gt;      &lt;=     &gt;=     ~=     ==</span><br><span class="line"><span class="keyword">and</span></span><br><span class="line"><span class="keyword">or</span></span><br></pre></td></tr></table></figure><ol start="2"><li>除了 ^ 和 … 外所有的二元运算符都是<strong>左连接</strong>的。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a+i &lt; b/<span class="number">2</span>+<span class="number">1</span>          &lt;<span class="comment">--&gt;       (a+i) &lt; ((b/2)+1)</span></span><br><span class="line"><span class="number">5</span>+x^<span class="number">2</span>*<span class="number">8</span>              &lt;<span class="comment">--&gt;       5+((x^2)*8)</span></span><br><span class="line">a &lt; y <span class="keyword">and</span> y &lt;= z     &lt;<span class="comment">--&gt;       (a &lt; y) and (y &lt;= z)</span></span><br><span class="line">-x^<span class="number">2</span>                 &lt;<span class="comment">--&gt;       -(x^2)</span></span><br><span class="line">x^y^z                &lt;<span class="comment">--&gt;       x^(y^z)</span></span><br></pre></td></tr></table></figure><h1 id="%E5%8D%81-%E5%AD%97%E7%AC%A6%E4%B8%B2" tabindex="-1">十 字符串</h1><h3 id="10.1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E8%A1%A8%E7%A4%BA" tabindex="-1">10.1 字符串的表示</h3><ol><li><p>字符串或串(String)是由数字、字母、下划线组成的一串字符。</p></li><li><p>在 Lua 中，字符串是一种基本的数据类型，用于存储文本数据。</p></li><li><p>Lua 中的字符串可以包含任意字符，包括字母、数字、符号、空格以及其他特殊字符。</p></li><li><p>Lua 语言中字符串可以使用以下三种方式来表示：</p><ul><li>单引号间的一串字符。</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> str1 = <span class="string">&#x27;This is a string.&#x27;</span></span><br><span class="line"><span class="keyword">local</span> str2 = <span class="string">&quot;This is also a string.&quot;</span></span><br></pre></td></tr></table></figure><ul><li>双引号间的一串字符。</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> str = <span class="string">&quot;Hello, &quot;</span></span><br><span class="line"> str = str .. <span class="string">&quot;World!&quot;</span>  <span class="comment">-- 创建一个新的字符串并将其赋值给str</span></span><br><span class="line"> <span class="built_in">print</span>(str)  <span class="comment">-- 输出 &quot;Hello, World!&quot;</span></span><br></pre></td></tr></table></figure><ul><li><strong>[[ 与 ]] 间的一串字符</strong>。</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> multilineString = <span class="string">[[</span></span><br><span class="line"><span class="string"> This is a multiline string.</span></span><br><span class="line"><span class="string"> It can contain multiple lines of text.</span></span><br><span class="line"><span class="string"> No need for escape characters.</span></span><br><span class="line"><span class="string"> ]]</span></span><br><span class="line"></span><br><span class="line"> <span class="built_in">print</span>(multilineString)</span><br></pre></td></tr></table></figure></li></ol><h3 id="10.2-%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6%E8%AE%A1%E7%AE%97" tabindex="-1">10.2 字符串长度计算</h3><ol><li>使用 string.len函数或 utf8.len 函数，包含<strong>中文的一般用 utf8.len</strong>，string.len 函数用于计算<strong>只包含 ASCII 字符串的长度</strong>。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> myString = <span class="string">&quot;Hello, 世界!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算字符串的长度（字符个数）</span></span><br><span class="line"><span class="keyword">local</span> length1 = utf8.<span class="built_in">len</span>(myString)</span><br><span class="line"><span class="built_in">print</span>(length1) <span class="comment">-- 输出 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- string.len 函数会导致结果不准确</span></span><br><span class="line"><span class="keyword">local</span> length2 = <span class="built_in">string</span>.<span class="built_in">len</span>(myString)</span><br><span class="line"><span class="built_in">print</span>(length2) <span class="comment">-- 输出 14</span></span><br></pre></td></tr></table></figure><ol start="2"><li><strong>转义字符用于表示不能直接显示的字符</strong>，比如后退键，回车键等，如在字符串转换双引号可以使用 \</li><li>所有的转义字符和所对应的意义：<br><img src="/2024/08/20/lua-lua%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6%E7%9A%84%E6%84%8F%E4%B9%89.png" alt="转义字符的意义"></li></ol><h3 id="10.3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%93%8D%E4%BD%9C%EF%BC%88%E5%87%BD%E6%95%B0%EF%BC%89" tabindex="-1">10.3 字符串的操作（函数）</h3><p>Lua 提供了很多的方法来支持字符串的操作：</p><table><thead><tr><th>序号</th><th>方法 &amp; 用途</th></tr></thead><tbody><tr><td>1</td><td>string.upper(argument)<br><strong>字符串全部转为大写字母</strong>。</td></tr><tr><td>2</td><td>string.lower(argument)<br><strong>字符串全部转为小写字母</strong>。</td></tr><tr><td>3</td><td>string.gsub(mainString,findString,replaceString,num)<br><strong>在字符串中替换</strong>。 <br>mainString 为要操作的字符串， findString 为被替换的字符，replaceString 要替换的字符，num 替换次数（可以忽略，则全部替换），如：<br> &gt; string.gsub(“aaaa”,“a”,“z”,3);<br> zzza    3</td></tr><tr><td>4</td><td>string.find (str, substr, [init, [plain]])<br><strong>在一个指定的目标字符串 str 中搜索指定的内容 substr</strong>，<strong>如果找到了一个匹配的子串，就会返回这个子串的起始索引和结束索引，不存在则返回 nil</strong>。<br>init 指定了搜索的起始位置，默认为 1，可以一个负数，表示从后往前数的字符个数。<br>plain 表示是否使用简单模式，默认为 false，true 只做简单的查找子串的操作，false 表示使用使用正则模式匹配。<br>以下实例查找字符串 “Lua” 的起始索引和结束索引位置：<br> &gt; string.find(“Hello Lua user”, “Lua”, 1) <br>7    9</td></tr><tr><td>5</td><td>string.reverse(arg)<br><strong>字符串反转</strong><br> &gt; string.reverse(“Lua”)<br>auL</td></tr><tr><td>6</td><td>string.format(…)<br>返回一个<strong>类似printf的格式化字符串</strong><br>&gt; string.format(“the value is:%d”,4)<br>the value is:4</td></tr><tr><td>7</td><td>string.char(arg) 和 string.byte(arg[,int])<br>char <strong>将整型数字转成字符并连接</strong>， <strong>byte 转换字符为整数值(可以指定某个字符，默认第一个字符)</strong>。<br>&gt; string.char(97,98,99,100)<br>abcd<br>&gt; string.byte(“ABCD”,4)<br>68<br>&gt; string.byte(“ABCD”)<br>65<br>&gt;</td></tr><tr><td>8</td><td>string.len(arg)<br><strong>计算字符串长度</strong>。<br>string.len(“abc”)<br>3</td></tr><tr><td>9</td><td>string.rep(string, n)<br><strong>返回字符串string的n个拷贝</strong><br>&gt; string.rep(“abcd”,2)<br>abcdabcd</td></tr><tr><td>10</td><td>…<br><strong>链接两个字符串</strong><br>&gt; print(“www.runoob.”…“com”)<br><a href="http://www.runoob.com">www.runoob.com</a></td></tr><tr><td>11</td><td>string.gmatch(str, pattern)<br><strong>返回一个迭代器函数，每一次调用这个函数，返回一个在字符串 str 找到的下一个符合 pattern 描述的子串</strong>。如果参数 pattern 描述的字符串没有找到，迭代函数返回nil。<br>&gt; for word in string.gmatch(“Hello Lua user”, “%a+”) do print(word) end<br>Hello<br>Lua<br>user<br></td></tr><tr><td>12</td><td>string.match(str, pattern, init)<br>string.match()<strong>只寻找源字串str中的第一个配对. 参数init可选, 指定搜寻过程的起点, 默认为1</strong>。<br>在成功配对时, 函数将返回配对表达式中的所有捕获结果; 如果没有设置捕获标记, 则返回整个配对字符串. 当没有成功的配对时, 返回nil。<br>&gt; = string.match(“I have 2 questions for you.”, “%d+ %a+”)<br>2 questions<br>&gt; = string.format(“%d, %q”, string.match(“I have 2 questions for you.”, “(%d+) (%a+)”))<br>2, “questions”</td></tr></tbody></table><h3 id="10.4-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%AA%E5%8F%96" tabindex="-1">10.4 字符串截取</h3><ol><li>字符串截取使用 sub() 方法。<strong>string.sub() 用于截取字符串</strong>，原型为：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span>.<span class="built_in">sub</span>(s, i [, j])</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li>s：要截取的字符串。</li><li>i：截取开始位置。</li><li>j：截取结束位置，默认为 -1，最后一个字符。</li><li></li></ul><ol start="2"><li>实例</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 字符串</span></span><br><span class="line"><span class="keyword">local</span> sourcestr = <span class="string">&quot;prefix--runoobgoogletaobao--suffix&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n原始字符串&quot;</span>, <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%q&quot;</span>, sourcestr))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 截取部分，第4个到第15个</span></span><br><span class="line"><span class="keyword">local</span> first_sub = <span class="built_in">string</span>.<span class="built_in">sub</span>(sourcestr, <span class="number">4</span>, <span class="number">15</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n第一次截取&quot;</span>, <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%q&quot;</span>, first_sub))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 取字符串前缀，第1个到第8个</span></span><br><span class="line"><span class="keyword">local</span> second_sub = <span class="built_in">string</span>.<span class="built_in">sub</span>(sourcestr, <span class="number">1</span>, <span class="number">8</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n第二次截取&quot;</span>, <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%q&quot;</span>, second_sub))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 截取最后10个</span></span><br><span class="line"><span class="keyword">local</span> third_sub = <span class="built_in">string</span>.<span class="built_in">sub</span>(sourcestr, <span class="number">-10</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n第三次截取&quot;</span>, <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%q&quot;</span>, third_sub))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 索引越界，输出原始字符串</span></span><br><span class="line"><span class="keyword">local</span> fourth_sub = <span class="built_in">string</span>.<span class="built_in">sub</span>(sourcestr, <span class="number">-100</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n第四次截取&quot;</span>, <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%q&quot;</span>, fourth_sub))</span><br></pre></td></tr></table></figure><h3 id="10.5-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%A7%E5%B0%8F%E5%86%99%E8%BD%AC%E6%8D%A2" tabindex="-1">10.5 字符串大小写转换</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string1 = <span class="string">&quot;Lua&quot;</span>;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">upper</span>(string1))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">lower</span>(string1))</span><br></pre></td></tr></table></figure><h3 id="10.6-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9F%A5%E6%89%BE%E4%B8%8E%E5%8F%8D%E8%BD%AC" tabindex="-1">10.6 字符串查找与反转</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> = <span class="string">&quot;Lua Tutorial&quot;</span></span><br><span class="line"><span class="comment">-- 查找字符串</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">find</span>(<span class="built_in">string</span>,<span class="string">&quot;Tutorial&quot;</span>))</span><br><span class="line">reversedString = <span class="built_in">string</span>.<span class="built_in">reverse</span>(<span class="built_in">string</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;新字符串为&quot;</span>,reversedString)</span><br></pre></td></tr></table></figure><h3 id="10.7-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%8C%96" tabindex="-1">10.7 字符串格式化</h3><ol><li>格式字符串可能包含以下的转义码:<ul><li>%c - 接受一个数字, 并将其<strong>转化为ASCII码表中对应的字符</strong></li><li>%d, %i - 接受一个数字并将<strong>其转化为有符号的整数格式</strong></li><li>%o - 接受一个数字并将其转化为<strong>八进制数格式</strong></li><li>%u - 接受一个数字并将其转化为<strong>无符号整数格式</strong></li><li>%x - 接受一个数字并将其转化为<strong>十六进制数格式, 使用小写字母</strong></li><li>%X - 接受一个数字并将其转化为<strong>十六进制数格式, 使用大写字母</strong></li><li>%e - 接受一个数字并将其转化为<strong>科学记数法格式, 使用小写字母e</strong></li><li>%E - 接受一个数字并将其转化为<strong>科学记数法格式, 使用大写字母E</strong></li><li>%f - 接受一个数字并将其转化为<strong>浮点数格式</strong></li><li>%g(%G) - 接受一个数字并将其转化<strong>为%e(%E, 对应%G)及%f中较短的一种格式</strong></li><li>%q - 接受一个字符串并将其转化为<strong>可安全被Lua编译器读入的格式</strong></li><li>%s - 接受一个字符串并<strong>按照给定的参数格式化该字符串</strong></li></ul></li><li>为进一步细化格式, 可以在 <strong>%号后添加参数. 参数将以如下的顺序读入</strong> :<br>(1) <strong>符号</strong>: 一个+号表示其后的数字转义符将让正数显示正号. 默认情况下只有负数显示符号.<br>(2) <strong>占位符</strong>: 一个0, 在后面指定了字串宽度时占位用. 不填时的默认占位符是空格.<br>(3) <strong>对齐标识</strong>: 在指定了字串宽度时, 默认为右对齐, 增加-号可以改为左对齐.<br>(4) <strong>宽度数值</strong><br>(5) <strong>小数位数/字串裁切</strong>: 在宽度数值后增加的小数部分n, 若后接f(浮点数转义符, 如%6.3f)则设定该浮点数的小数只保留n位, 若后接s(字符串转义符, 如%5.3s)则设定该字符串只显示前n位.<strong>%5.3s表示宽度为5，且保留3位小数</strong></li><li>实例</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">string1 = <span class="string">&quot;Lua&quot;</span></span><br><span class="line">string2 = <span class="string">&quot;Tutorial&quot;</span></span><br><span class="line">number1 = <span class="number">10</span></span><br><span class="line">number2 = <span class="number">20</span></span><br><span class="line"><span class="comment">-- 基本字符串格式化</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;基本格式化 %s %s&quot;</span>,string1,string2))</span><br><span class="line"><span class="comment">-- 日期格式化</span></span><br><span class="line"><span class="built_in">date</span> = <span class="number">2</span>; month = <span class="number">1</span>; year = <span class="number">2014</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;日期格式化 %02d/%02d/%04d&quot;</span>, <span class="built_in">date</span>, month, year))</span><br><span class="line"><span class="comment">-- 十进制格式化</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%.4f&quot;</span>,<span class="number">1</span>/<span class="number">3</span>))</span><br></pre></td></tr></table></figure><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%c&quot;</span>, <span class="number">83</span>)                 <span class="comment">-- 输出S</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%+d&quot;</span>, <span class="number">17.0</span>)              <span class="comment">-- 输出+17</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%05d&quot;</span>, <span class="number">17</span>)               <span class="comment">-- 输出00017</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%o&quot;</span>, <span class="number">17</span>)                 <span class="comment">-- 输出21</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%u&quot;</span>, <span class="number">3.14</span>)               <span class="comment">-- 输出3</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%x&quot;</span>, <span class="number">13</span>)                 <span class="comment">-- 输出d</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%X&quot;</span>, <span class="number">13</span>)                 <span class="comment">-- 输出D</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%e&quot;</span>, <span class="number">1000</span>)               <span class="comment">-- 输出1.000000e+03</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%E&quot;</span>, <span class="number">1000</span>)               <span class="comment">-- 输出1.000000E+03</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%6.3f&quot;</span>, <span class="number">13</span>)              <span class="comment">-- 输出13.000</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%q&quot;</span>, <span class="string">&quot;One\nTwo&quot;</span>)         <span class="comment">-- 输出&quot;One\</span></span><br><span class="line">                                        <span class="comment">-- 　　Two&quot;</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;monkey&quot;</span>)           <span class="comment">-- 输出monkey</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%10s&quot;</span>, <span class="string">&quot;monkey&quot;</span>)         <span class="comment">-- 输出    monkey</span></span><br><span class="line"><span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%5.3s&quot;</span>, <span class="string">&quot;monkey&quot;</span>)        <span class="comment">-- 输出  mon</span></span><br></pre></td></tr></table></figure><h3 id="10.8-%E5%AD%97%E7%AC%A6%E4%B8%8E%E6%95%B4%E6%95%B0%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2" tabindex="-1">10.8 字符与整数相互转换</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 字符转换</span></span><br><span class="line"><span class="comment">-- 转换第一个字符</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">byte</span>(<span class="string">&quot;Lua&quot;</span>))</span><br><span class="line"><span class="comment">-- 转换第三个字符</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">byte</span>(<span class="string">&quot;Lua&quot;</span>,<span class="number">3</span>))</span><br><span class="line"><span class="comment">-- 转换末尾第一个字符</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">byte</span>(<span class="string">&quot;Lua&quot;</span>,<span class="number">-1</span>))</span><br><span class="line"><span class="comment">-- 第二个字符</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">byte</span>(<span class="string">&quot;Lua&quot;</span>,<span class="number">2</span>))</span><br><span class="line"><span class="comment">-- 转换末尾第二个字符</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">byte</span>(<span class="string">&quot;Lua&quot;</span>,<span class="number">-2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 整数 ASCII 码转换为字符</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">char</span>(<span class="number">97</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">76</span></span><br><span class="line"><span class="comment">97</span></span><br><span class="line"><span class="comment">97</span></span><br><span class="line"><span class="comment">117</span></span><br><span class="line"><span class="comment">117</span></span><br><span class="line"><span class="comment">a</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure><h3 id="10.9-%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%9E%E6%8E%A5%E4%B8%8E%E5%A4%8D%E5%88%B6" tabindex="-1">10.9 字符串连接与复制</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">string1 = <span class="string">&quot;www.&quot;</span></span><br><span class="line">string2 = <span class="string">&quot;runoob&quot;</span></span><br><span class="line">string3 = <span class="string">&quot;.com&quot;</span></span><br><span class="line"><span class="comment">-- 使用 .. 进行字符串连接</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;连接字符串&quot;</span>,string1..string2..string3)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 字符串长度</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;字符串长度 &quot;</span>,<span class="built_in">string</span>.<span class="built_in">len</span>(string2))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 字符串复制 2 次</span></span><br><span class="line">repeatedString = <span class="built_in">string</span>.<span class="built_in">rep</span>(string2,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(repeatedString)</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">连接字符串    www.runoob.com</span></span><br><span class="line"><span class="comment">字符串长度     6</span></span><br><span class="line"><span class="comment">runoobrunoob    </span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure><h3 id="10.10-%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F" tabindex="-1">10.10 匹配模式</h3><ol><li><p>Lua 中的匹配模式直接用常规的字符串来描述。 它用于模式匹配函数 string.find, string.gmatch, string.gsub, string.match。你<strong>还可以在模式串中使用字符类</strong>。</p></li><li><p>字符类<strong>指可以匹配一个特定字符集合内任何字符的模式项</strong>。比如，<strong>字符类 %d 匹配任意数字</strong>。所以你可以<strong>使用模式串 %d%d/%d%d/%d%d%d%d 搜索 dd/mm/yyyy 格式的日期</strong>：</p></li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;Deadline is 30/05/1999, firm&quot;</span></span><br><span class="line"><span class="built_in">date</span> = <span class="string">&quot;%d%d/%d%d/%d%d%d%d&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">sub</span>(s, <span class="built_in">string</span>.<span class="built_in">find</span>(s, <span class="built_in">date</span>)))    <span class="comment">--&gt; 30/05/1999</span></span><br></pre></td></tr></table></figure><ol start="3"><li>下面的表列出了Lua支持的所有字符类：<br>单个字符 <strong>(除 ^$()%.[]*±? 外)</strong>: 与该字符自身配对</li></ol><ul><li>.(点): 与任何字符配对</li><li>%a: 与任何字母配对</li><li>%c: 与任何控制符配对(例如\n)</li><li>%d: 与任何数字配对</li><li>%l: 与任何小写字母配对</li><li>%p: 与任何标点(punctuation)配对</li><li>%s: 与空白字符配对</li><li>%u: 与任何大写字母配对</li><li>%w: 与任何字母/数字配对</li><li>%x: 与任何十六进制数配对</li><li>%z: 与任何代表0的字符配对</li><li>%x(此处x是非字母非数字字符): 与字符x配对. 主要用来处理表达式中有功能的字符(^$()%.[]*±?)的配对问题, 例如%%与%配对</li><li>[数个字符类]: 与任何[]中包含的字符类配对. 例如[%w_]与任何字母/数字, 或下划线符号(_)配对</li><li>[^数个字符类]: 与任何不包含在[]中的字符类配对. 例如[^%s]与任何非空白字符配对</li></ul><p><strong>当上述的字符类用大写书写时, 表示与非此字符类的任何字符配对. 例如, %S表示与任何非空白字符配对.例如，'%A’非字母的字符:</strong></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">gsub</span>(<span class="string">&quot;hello, up-down!&quot;</span>, <span class="string">&quot;%A&quot;</span>, <span class="string">&quot;.&quot;</span>))</span><br><span class="line">hello..up.down.    <span class="number">4</span></span><br></pre></td></tr></table></figure><p><strong>数字4不是字符串结果的一部分，他是gsub返回的第二个结果，代表发生替换的次数。</strong><br>在<strong>模式匹配中有一些特殊字符</strong>，他们有特殊的意义，Lua中的特殊字符如下：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">( ) . % + - * ? [ ^ $</span><br></pre></td></tr></table></figure><p><strong>‘%’ 用作特殊字符的转义字符，因此 ‘%.’ 匹配点；‘%%’ 匹配字符 ‘%’。转义字符 '%'不仅可以用来转义特殊字符，还可以用于所有的非字母的字符。</strong></p><ol start="4"><li>模式条目可以是：</li></ol><ul><li>单个字符类匹配该类别中任意单个字符；</li><li>单个字符类跟一个 ‘*’， 将匹配<strong>零或多个该类的字</strong>符。 这个条目<strong>总是匹配尽可能长的串</strong>；</li><li>单个字符类跟一个 ‘+’， 将匹配<strong>一或更多个该类的字符</strong>。 这个条目总是匹配<strong>尽可能长</strong>的串；</li><li>单个字符类跟一个 ‘-’， 将匹配<strong>零或更多个该类的字符</strong>。 和 ‘*’ 不同， 这个条目总是匹配<strong>尽可能短</strong>的串；</li><li>单个字符类跟一个 ‘?’， 将匹配<strong>零或一个该类的字符</strong>。 只要有可能，它会匹配一个；</li><li>%n， 这里的 n 可以从 1 到 9； 这个条目匹配<strong>一个等于 n 号捕获物（后面有描述）的子串</strong>。</li><li>%bxy， 这里的 x 和 y 是两个明确的字符； 这个条目匹配以 x 开始 y 结束， 且其中 x 和 y 保持 平衡 的字符串。 意思是，如果从左到右读这个字符串，对每次读到一个 x 就 +1 ，读到一个 y 就 -1， 最终结束处的那个 y 是第一个记数到 0 的 y。 举个例子，条目 %b() 可以匹配到括号平衡的表达式。</li><li>%f[set]， 指 边境模式； 这个条目会匹配到一个位于 set 内某个字符之前的一个空串， 且这个位置的前一个字符不属于 set 。 集合 set 的含义如前面所述。 匹配出的那个空串之开始和结束点的计算就看成该处有个字符 ‘\0’ 一样。</li></ul><ol start="5"><li>模式：</li></ol><p>模式 指一个模式条目的序列。 <strong>在模式最前面加上符号 ‘^’ 将锚定从字符串的开始处做匹配</strong>。 在模式最后面加上<strong>符号’$'<strong>将使匹配过程锚定到</strong>字符串的结尾</strong>。<br>如果 <strong>‘^’ 和 ‘$’ 出现在其它位置</strong>，它们均没有特殊含义，<strong>只表示自身</strong>。</p><ol start="6"><li>捕获：</li></ol><p><strong>模式可以在内部用小括号括起一个子模式</strong>； 这些子模式被<strong>称为 捕获物</strong>。 当匹配成功时，由 捕获物 匹配到的字符串中的子串被保存起来用于未来的用途。 捕获物以它们左括号的次序来编号。 例如，对于模式 “(a*(.)%w(%s*))” ， 字符串中匹配到 “a*(.)%w(%s*)” 的部分保存在第一个捕获物中 （因此是编号 1 ）； 由 “.” 匹配到的字符是 2 号捕获物， 匹配到 “%s*” 的那部分是 3 号。</p><p>作为一个特例，<strong>空的捕获 () 将捕获到当前字符串的位置（它是一个数字）</strong>。 例如，如果将模式 “()aa()” 作用到字符串 “flaaap” 上，将产生两个捕获物： 3 和 5 。</p><h1 id="%E5%8D%81%E4%B8%80-lua%E6%95%B0%E7%BB%84" tabindex="-1">十一 Lua数组</h1><h3 id="11.1-%E6%A6%82%E8%BF%B0" tabindex="-1">11.1 概述</h3><ol><li><p>数组，就是相<strong>同数据类型的元素按一定顺序排列的集合</strong>，可以是<strong>一维</strong>数组和<strong>多维</strong>数组。</p></li><li><p>在Lua中，数组<strong>不是一种特定的数据类型</strong>，而是一种用来<strong>存储一组值的数据结构</strong>。</p></li><li><p>实际上，<strong>Lua 中并没有专门的数组类型</strong>，而是使用一种被称为 <strong>“table” 的数据结构来实现数组</strong>的功能。</p></li><li><p>Lua 数组的索引键值可以使用整数表示，数组的大小不是固定的。</p></li><li><p>在 <strong>Lua 索引值是以 1 为起始，但你也可以指定 0 开始</strong>。</p></li></ol><h3 id="11.2-%E4%B8%80%E7%BB%B4%E6%95%B0%E7%BB%84" tabindex="-1">11.2 一维数组</h3><ol><li>索引访问</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个数组</span></span><br><span class="line"><span class="keyword">local</span> myArray = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 访问数组元素</span></span><br><span class="line"><span class="built_in">print</span>(myArray[<span class="number">1</span>])  <span class="comment">-- 输出 10</span></span><br><span class="line"><span class="built_in">print</span>(myArray[<span class="number">3</span>])  <span class="comment">-- 输出 30</span></span><br></pre></td></tr></table></figure><ol start="2"><li>要计算数组的长度（即数组中元素的个数），你可以使用 # 操作符：(但注意 如果存在连续两个nil夹在数组中间，#只会计算前半截的长度)</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> myArray = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算数组长度</span></span><br><span class="line"><span class="keyword">local</span> length = #myArray</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(length) <span class="comment">-- 输出 5</span></span><br></pre></td></tr></table></figure><ol start="3"><li>一维数组可以用 for 循环出数组中的元素</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个数组</span></span><br><span class="line"><span class="keyword">local</span> myArray = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 循环遍历数组</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, #myArray <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(myArray[i])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ol start="4"><li>lua索引默认从1开始</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">array = &#123;<span class="string">&quot;Lua&quot;</span>, <span class="string">&quot;Tutorial&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i= <span class="number">0</span>, <span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">   <span class="built_in">print</span>(array[i])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ol start="5"><li>添加元素</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个数组</span></span><br><span class="line"><span class="keyword">local</span> myArray = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加新元素到数组末尾</span></span><br><span class="line">myArray[#myArray + <span class="number">1</span>] = <span class="number">60</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 循环遍历数组</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, #myArray <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(myArray[i])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ol start="6"><li>删除元素</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建一个数组</span></span><br><span class="line"><span class="keyword">local</span> myArray = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除第三个元素</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">remove</span>(myArray, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 循环遍历数组</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>, #myArray <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(myArray[i])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h3 id="11.3-%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84" tabindex="-1">11.3 多维数组</h3><ol><li>以下是一个三行三列的阵列多维数组：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 初始化数组</span></span><br><span class="line">array = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>,<span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">   array[i] = &#123;&#125;</span><br><span class="line">      <span class="keyword">for</span> j=<span class="number">1</span>,<span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">         array[i][j] = i*j</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 访问数组</span></span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span>,<span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">   <span class="keyword">for</span> j=<span class="number">1</span>,<span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">      <span class="built_in">print</span>(array[i][j])</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ol start="2"><li>不同索引键的三行三列阵列多维数组：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 初始化数组</span></span><br><span class="line">array = &#123;&#125;</span><br><span class="line">maxRows = <span class="number">3</span></span><br><span class="line">maxColumns = <span class="number">3</span></span><br><span class="line"><span class="keyword">for</span> row=<span class="number">1</span>,maxRows <span class="keyword">do</span></span><br><span class="line">   <span class="keyword">for</span> col=<span class="number">1</span>,maxColumns <span class="keyword">do</span></span><br><span class="line">      array[row*maxColumns +col] = row*col</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 访问数组</span></span><br><span class="line"><span class="keyword">for</span> row=<span class="number">1</span>,maxRows <span class="keyword">do</span></span><br><span class="line">   <span class="keyword">for</span> col=<span class="number">1</span>,maxColumns <span class="keyword">do</span></span><br><span class="line">      <span class="built_in">print</span>(array[row*maxColumns +col])</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>正如你所看到的，以上的实例中，<strong>数组设定了指定的索引值，这样可以避免出现 nil 值，有利于节省内存空间</strong>。</p><h1 id="%E5%8D%81%E4%BA%8C-%E8%BF%AD%E4%BB%A3%E5%99%A8%EF%BC%88%E2%AD%90%EF%BC%89" tabindex="-1">十二 迭代器（⭐）</h1><h3 id="12.1-%E6%A6%82%E8%BF%B0" tabindex="-1">12.1 概述</h3><p>迭代器（iterator）是一种对象，它能够<strong>用来遍历标准模板库容器中的部分或全部元素</strong>，每个迭代器对象代表容器中的确定的地址。</p><p>在 Lua 中迭代器是一种支<strong>持指针类型的结构</strong>，它可以遍历集合的每一个元素。</p><h3 id="12.2-%E6%B3%9B%E5%9E%8Bfor%E8%BF%AD%E4%BB%A3%E5%99%A8" tabindex="-1">12.2 泛型for迭代器</h3><ol><li><strong>泛型 for</strong> 在自己内部保存迭代函数，实际上它保存三个值： <strong>迭代函数、状态常量、控制变量</strong>。泛型 for 迭代器<strong>提供了集合的 key/value</strong> 对，语法格式如下：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(t) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(k, v)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>上面代码中，k, v为变量列表；pairs(t)为表达式列表。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">array = &#123;<span class="string">&quot;Google&quot;</span>, <span class="string">&quot;Runoob&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key,value <span class="keyword">in</span> <span class="built_in">ipairs</span>(array) </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">   <span class="built_in">print</span>(key, value)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>以上实例中我们使用了 Lua 默认提供的迭代函数 ipairs。(<strong>建议最好都用pairs</strong>，因为ipairs不能找到0和0以下的自定义索引内容,如果从1开始 索引顺序断了 后面的内容也找不到)。</p><ol start="2"><li>下面我们看看<strong>泛型 for 的执行过程</strong>：</li></ol><ul><li>首先，初始化，<strong>计算 in 后面表达式的值，表达式应该返回泛型 for 需要的三个值：迭代函数、状态常量、控制变量</strong>；与多值赋值一样，如果表达式返回的结果个数不足三个会自动用 nil 补足，多出部分会被忽略。</li><li>第二，将<strong>状态常量和控制变量</strong>作为<strong>参数调用迭代函数</strong>（注意：对于 for 结构来说，<strong>状态常量</strong>没有用处，仅仅<strong>在初始化时获取他的值并传递给迭代函数</strong>）。</li><li>第三，将迭<strong>代函数返回的值赋给变量列表</strong>。</li><li>第四，如果<strong>返回的第一个值为nil循环结束</strong>，否则执行循环体。</li><li>第五，回到<strong>第二步再次调用迭代函数</strong></li></ul><ol start="3"><li>在Lua中我们常常<strong>使用函数来描述迭代器</strong>，<strong>每次调用该函数就返回集合的下一个元素</strong>。Lua 的迭代器包含以下两种类型：<ul><li>无状态的迭代器</li><li>多状态的迭代器</li></ul></li></ol><h3 id="12.2-%E6%97%A0%E7%8A%B6%E6%80%81%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8" tabindex="-1">12.2 无状态的迭代器</h3><ol><li>无状态的迭代器是<strong>指不保留任何状态的迭代器</strong>，因此在循环中我们可以<strong>利用无状态迭代器避免创建闭包花费额外的代价</strong>。</li><li>每一次迭代，<strong>迭代函数都是用两个变量（状态常量和控制变量）的值作为参数被调用</strong>，一个<strong>无状态的迭代器只利用这两个值</strong>可以<strong>获取下一个元素</strong>。</li><li>这种<strong>无状态迭代器的典型的简单的例子是 ipairs</strong>，它<strong>遍历数组的每一个元素，元素的索引需要是数值</strong>。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">square</span><span class="params">(iteratorMaxCount,currentNumber)</span></span></span><br><span class="line">   <span class="keyword">if</span> currentNumber&lt;iteratorMaxCount</span><br><span class="line">   <span class="keyword">then</span></span><br><span class="line">      currentNumber = currentNumber+<span class="number">1</span></span><br><span class="line">   <span class="keyword">return</span> currentNumber, currentNumber*currentNumber</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- square,3,0 迭代函数、状态常量、控制变量 currentNumber==currentNumber时 函数square就没有返回值了</span></span><br><span class="line"><span class="keyword">for</span> i,n <span class="keyword">in</span> square,<span class="number">3</span>,<span class="number">0</span> </span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">   <span class="built_in">print</span>(i,n)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ol start="4"><li><strong>ipairs的实现（⭐）</strong><br><strong>迭代的状态包括被遍历的表（循环过程中不会改变的状态常量）和当前的索引下标（控制变量）</strong>，ipairs 和迭代函数都很简单，我们在 Lua 中可以这样实现：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">iter</span> <span class="params">(a, i)</span></span></span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">local</span> v = a[i]</span><br><span class="line">    <span class="keyword">if</span> v <span class="keyword">then</span></span><br><span class="line">       <span class="keyword">return</span> i, v</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ipairs</span> <span class="params">(a)</span></span></span><br><span class="line">    <span class="keyword">return</span> iter, a, <span class="number">0</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p><strong>当 Lua 调用 ipairs(a) 开始循环时，他获取三个值：迭代函数 iter、状态常量 a、控制变量初始值 0；然后 Lua 调用 iter(a,0) 返回 1, a[1]（除非 a[1]=nil）；第二次迭代调用 iter(a,1) 返回 2, a[2]……直到第一个 nil 元素。</strong></p><h3 id="12.3-%E5%A4%9A%E7%8A%B6%E6%80%81%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8" tabindex="-1">12.3 多状态的迭代器</h3><ol><li>很多情况下，<strong>迭代器需要保存多个状态信息而不是简单的状态常量和控制变量</strong>，最<strong>简单的方法是使用闭包</strong>，<strong>还有一种方法</strong>就是将所有的状态<strong>信息封装到 table 内</strong>，将 table <strong>作为迭代器的状态常量</strong>，因为这种情况下可以将所有的信息存放在 table 内，<strong>所以迭代函数通常不需要第二个参数</strong>。</li><li>创建自己的迭代器</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">array = &#123;<span class="string">&quot;Google&quot;</span>, <span class="string">&quot;Runoob&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">elementIterator</span> <span class="params">(collection)</span></span></span><br><span class="line">   <span class="keyword">local</span> index = <span class="number">0</span></span><br><span class="line">   <span class="keyword">local</span> count = #collection</span><br><span class="line">   <span class="comment">-- 闭包函数</span></span><br><span class="line">   <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">      index = index + <span class="number">1</span></span><br><span class="line">      <span class="keyword">if</span> index &lt;= count</span><br><span class="line">      <span class="keyword">then</span></span><br><span class="line">         <span class="comment">--  返回迭代器的当前元素</span></span><br><span class="line">         <span class="keyword">return</span> collection[index]</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elementIterator(array)</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">   <span class="built_in">print</span>(element)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">Google</span></span><br><span class="line"><span class="comment">Runoob    </span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure><p>以上实例中我们可以看到，<strong>elementIterator 内使用了闭包函数，实现计算集合大小并输出各个元素</strong>。</p><h1 id="%E5%8D%81%E4%B8%89-table%EF%BC%88%E8%A1%A8%EF%BC%89%EF%BC%88%E2%AD%90%EF%BC%89" tabindex="-1">十三 table（表）（⭐）</h1><h3 id="13.1-%E6%A6%82%E8%BF%B0" tabindex="-1">13.1 概述</h3><ol><li><p>table 是 Lua 的<strong>一种数据结构用来帮助我们创建不同的数据类型</strong>，如：<strong>数组、字典</strong>等。</p></li><li><p>Lua table <strong>使用关联型数组</strong>，你可以<strong>用任意类型的值来作数组的索引</strong>，但这个值<strong>不能是 nil</strong>。</p></li><li><p>Lua table 是<strong>不固定大小的</strong>，你可以根据自己需要进行扩容。</p></li><li><p>Lua也是 <strong>通过table来解决模块（module）、包（package）和对象（Object）</strong> 的。 例如string.format表示使用&quot;format&quot;来索引table string。</p></li></ol><h3 id="13.2-%E8%A1%A8%EF%BC%88table%EF%BC%89%E7%9A%84%E6%9E%84%E9%80%A0" tabindex="-1">13.2 表（Table）的构造</h3><ol><li>构造器是创建和初始化表的表达式。表是Lua特有的功能强大的东西。<strong>最简单的构造函数是{}</strong>，用来创建一个空表。可以直接初始化数组:</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 初始化表</span></span><br><span class="line">mytable = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 指定值</span></span><br><span class="line">mytable[<span class="number">1</span>]= <span class="string">&quot;Lua&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 移除引用</span></span><br><span class="line">mytable = <span class="literal">nil</span></span><br><span class="line"><span class="comment">-- lua 垃圾回收会释放内存</span></span><br></pre></td></tr></table></figure><ol start="2"><li>当我们为 <strong>table a 并设置元素，然后将 a 赋值给 b，则 a 与 b 都指向同一个内存</strong>。如果 <strong>a 设置为 nil ，则 b 同样能访问 table 的元素</strong>。如果没有指定的变量指向a，Lua的垃圾回收机制会清理相对应的内存。<br>以下实例演示了以上的描述情况：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 简单的 table</span></span><br><span class="line">mytable = &#123;&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mytable 的类型是 &quot;</span>,<span class="built_in">type</span>(mytable))</span><br><span class="line"></span><br><span class="line">mytable[<span class="number">1</span>]= <span class="string">&quot;Lua&quot;</span></span><br><span class="line">mytable[<span class="string">&quot;wow&quot;</span>] = <span class="string">&quot;修改前&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mytable 索引为 1 的元素是 &quot;</span>, mytable[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mytable 索引为 wow 的元素是 &quot;</span>, mytable[<span class="string">&quot;wow&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">-- alternatetable和mytable的是指同一个 table</span></span><br><span class="line">alternatetable = mytable</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;alternatetable 索引为 1 的元素是 &quot;</span>, alternatetable[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;alternatetable 索引为 wow 的元素是 &quot;</span>, alternatetable[<span class="string">&quot;wow&quot;</span>])</span><br><span class="line"></span><br><span class="line">alternatetable[<span class="string">&quot;wow&quot;</span>] = <span class="string">&quot;修改后&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mytable 索引为 wow 的元素是 &quot;</span>, mytable[<span class="string">&quot;wow&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 释放变量</span></span><br><span class="line">alternatetable = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;alternatetable 是 &quot;</span>, alternatetable)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- mytable 仍然可以访问</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mytable 索引为 wow 的元素是 &quot;</span>, mytable[<span class="string">&quot;wow&quot;</span>])</span><br><span class="line"></span><br><span class="line">mytable = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mytable 是 &quot;</span>, mytable)</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">mytable 的类型是        table</span></span><br><span class="line"><span class="comment">mytable 索引为 1 的元素是       Lua</span></span><br><span class="line"><span class="comment">mytable 索引为 wow 的元素是     修改前</span></span><br><span class="line"><span class="comment">alternatetable 索引为 1 的元素是        Lua</span></span><br><span class="line"><span class="comment">alternatetable 索引为 wow 的元素是      修改前</span></span><br><span class="line"><span class="comment">mytable 索引为 wow 的元素是     修改后</span></span><br><span class="line"><span class="comment">alternatetable 是       nil</span></span><br><span class="line"><span class="comment">mytable 索引为 wow 的元素是     修改后</span></span><br><span class="line"><span class="comment">mytable 是      nil</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    --]]</span></span><br></pre></td></tr></table></figure><h3 id="13.3-table%E6%93%8D%E4%BD%9C" tabindex="-1">13.3 Table操作</h3><ol><li>常用方法</li></ol><table><thead><tr><th>序号</th><th>方法 &amp; 用途</th></tr></thead><tbody><tr><td>1</td><td><strong>table.concat (table [, sep [, start [, end]]])</strong><br>concat是concatenate(连锁, 连接)的缩写. table.concat()函数列出参数中<strong>指定table的数组部分从start位置到end位置的所有元素, 元素间以指定的分隔符(sep)隔开</strong>。</td></tr><tr><td>2</td><td><strong>table.insert (table, [pos,] value)</strong><br>在table的数组部分<strong>指定位置(pos)插入值为value的一个元素</strong>. pos参数可选, 默认为数组部分末尾.</td></tr><tr><td>3</td><td><strong>table.maxn (table)</strong><br>指定table中<strong>所有正数key值中最大的key值</strong>. 如果<strong>不存在</strong>key值为正数的元素, <strong>则返回0</strong>。(<strong>Lua5.2之后该方法已经不存在了</strong>,本文使用了自定义函数实现)</td></tr><tr><td>4</td><td><strong>table.remove (table [, pos])</strong><br><strong>返回table数组部分位于pos位置的元素</strong>. 其后的元素会被前移. <strong>pos参数可选, 默认为table长度, 即从最后一个元素删起</strong>。</td></tr><tr><td>5</td><td><strong>table.sort (table [, comp])</strong><br>对给定的table进行<strong>升序排序</strong>。</td></tr></tbody></table><ol start="2"><li>Table连接<br>使用 concat() 输出一个列表中元素连接成的字符串:</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">fruits = &#123;<span class="string">&quot;banana&quot;</span>,<span class="string">&quot;orange&quot;</span>,<span class="string">&quot;apple&quot;</span>&#125;</span><br><span class="line"><span class="comment">-- 返回 table 连接后的字符串</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;连接后的字符串 &quot;</span>,<span class="built_in">table</span>.<span class="built_in">concat</span>(fruits))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 指定连接字符</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;连接后的字符串 &quot;</span>,<span class="built_in">table</span>.<span class="built_in">concat</span>(fruits,<span class="string">&quot;, &quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 指定索引来连接 table</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;连接后的字符串 &quot;</span>,<span class="built_in">table</span>.<span class="built_in">concat</span>(fruits,<span class="string">&quot;, &quot;</span>, <span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">连接后的字符串     bananaorangeapple</span></span><br><span class="line"><span class="comment">连接后的字符串     banana, orange, apple</span></span><br><span class="line"><span class="comment">连接后的字符串     orange, apple</span></span><br><span class="line"><span class="comment">    --]]</span></span><br></pre></td></tr></table></figure><ol start="3"><li>插入和移除</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">fruits = &#123;<span class="string">&quot;banana&quot;</span>,<span class="string">&quot;orange&quot;</span>,<span class="string">&quot;apple&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在末尾插入</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span>(fruits,<span class="string">&quot;mango&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;索引为 4 的元素为 &quot;</span>,fruits[<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在索引为 2 的键处插入</span></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">insert</span>(fruits,<span class="number">2</span>,<span class="string">&quot;grapes&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;索引为 2 的元素为 &quot;</span>,fruits[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;最后一个元素为 &quot;</span>,fruits[<span class="number">5</span>])</span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">remove</span>(fruits)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;移除后最后一个元素为 &quot;</span>,fruits[<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">索引为 4 的元素为     mango</span></span><br><span class="line"><span class="comment">索引为 2 的元素为     grapes</span></span><br><span class="line"><span class="comment">最后一个元素为     mango</span></span><br><span class="line"><span class="comment">移除后最后一个元素为     nil</span></span><br><span class="line"><span class="comment">    --]]</span></span><br></pre></td></tr></table></figure><ol start="4"><li>Table排序<br>以下实例演示了 sort() 方法的使用，用于对 Table 进行排序：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fruits = &#123;<span class="string">&quot;banana&quot;</span>,<span class="string">&quot;orange&quot;</span>,<span class="string">&quot;apple&quot;</span>,<span class="string">&quot;grapes&quot;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;排序前&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(fruits) <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">print</span>(k,v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">table</span>.<span class="built_in">sort</span>(fruits)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;排序后&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(fruits) <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">print</span>(k,v)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h1 id="%E5%8D%81%E5%9B%9B-%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%8C%85%EF%BC%88%E2%AD%90%EF%BC%89" tabindex="-1">十四 模块与包（⭐）</h1><h3 id="14.1-%E6%A6%82%E8%BF%B0%E5%8F%8A%E5%AE%9A%E4%B9%89" tabindex="-1">14.1 概述及定义</h3><ol><li><p><strong>模块类似于一个封装库</strong>，从 Lua 5.1 开始，Lua 加入了标准的模块管理机制，可以把一些<strong>公用的代码放在一个文件里</strong>，<strong>以 API 接口的形式在其他地方调用</strong>，有利于代码的重用和降低代码耦合度</p></li><li><p><strong>Lua 的模块是由变量、函数等已知元素组成的 table</strong>，因此<strong>创建一个模块</strong>很简单，<strong>就是创建一个 table</strong>，然后把需要导出的常量、函数放入其中，最后返回这个 table 就行。以下为创建自定义模块 module.lua，文件代码格式如下：</p></li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 文件名为 module.lua</span></span><br><span class="line"><span class="comment">-- 定义一个名为 module 的模块</span></span><br><span class="line"><span class="built_in">module</span> = &#123;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">-- 定义一个常量</span></span><br><span class="line"><span class="built_in">module</span>.constant = <span class="string">&quot;这是一个常量&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">-- 定义一个函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">module.func1</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">io</span>.<span class="built_in">write</span>(<span class="string">&quot;这是一个公有函数！\n&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">func2</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;这是一个私有函数！&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">module.func3</span><span class="params">()</span></span></span><br><span class="line">    func2()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="built_in">module</span></span><br></pre></td></tr></table></figure><p>由上可知，模块的结构就是一个 table 的结构，因此可以<strong>像操作调用 table 里的元素那样来操作调用模块里的常量或函数</strong>。</p><p><strong>上面的 func2</strong> 声明为程序块的局部变量，即<strong>表示一个私有函数</strong>，因此是不能从外部访问模块里的这个私有函数，<strong>必须通过模块里的公有函数来调用</strong>.</p><h3 id="14.2-%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97%EF%BC%88require%E5%87%BD%E6%95%B0%EF%BC%89" tabindex="-1">14.2 加载模块（require函数）</h3><ol><li>Lua提供了一个名为<strong>require的函数用来加载模块</strong>。要加载一个模块，只需要简单地调用就可以了。例如：</li><li>执行 <strong>require 后会返回一个由模块常量或函数组成的 table</strong>，并且<strong>还会定义一个包含该table 的全局变量</strong>。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- test_module.lua 文件</span></span><br><span class="line"><span class="comment">-- module 模块为上文提到到 module.lua</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;module&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">module</span>.constant)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">module</span>.func3()</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">这是一个常量</span></span><br><span class="line"><span class="comment">这是一个私有函数！</span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure><p>或者给加载的模块定义一个别名变量，方便调用：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- test_module2.lua 文件</span></span><br><span class="line"><span class="comment">-- module 模块为上文提到到 module.lua</span></span><br><span class="line"><span class="comment">-- 别名变量 m</span></span><br><span class="line"><span class="keyword">local</span> m = <span class="built_in">require</span>(<span class="string">&quot;module&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(m.constant)</span><br><span class="line"> </span><br><span class="line">m.func3()</span><br></pre></td></tr></table></figure><ol start="3"><li><strong>加载机制（⭐）</strong></li></ol><ul><li><p>对于<strong>自定义的模块</strong>，模块文件<strong>不是放在哪个文件目录都行</strong>，函数 require 有它自己的文件路径加载策略，它会尝试从 Lua 文件或 C 程序库中加载模块。</p></li><li><p><strong>require 用于搜索 Lua 文件的路径是存放在全局变量 package.path</strong> 中，当 <strong>Lua 启动后</strong>，会<strong>以环境变量 LUA_PATH 的值来初始这个环境变量</strong>。如果<strong>没有找到该环境变量</strong>，<strong>则使用一个编译时定义的默认路径来初始化</strong>。</p></li><li><p>当然，<strong>如果没有 LUA_PATH 这个环境变量，也可以自定义设置，在当前用户根目录下打开 .profile 文件</strong>（<strong>没有则创建，打开 .bashrc 文件也可以</strong>），例如把 <strong>“~/lua/” 路径加入 LUA_PATH 环境变量里：</strong></p></li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#LUA_PATH</span><br><span class="line">export LUA_PATH=<span class="string">&quot;~/lua/?.lua;;&quot;</span></span><br></pre></td></tr></table></figure><ul><li><p><strong>文件路径以 “;” 号分隔</strong>，最后的 2 个 “;;” 表示新加的路径后面加上原来的默认路径。</p></li><li><p>接着，<strong>更新环境变量参数</strong>，使之立即生效。</p></li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.profile</span><br></pre></td></tr></table></figure><ul><li>这时假设 package.path 的值是：</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Users/dengjoe/lua/?.lua;./?.lua;/usr/<span class="keyword">local</span>/share/lua/<span class="number">5.1</span>/?.lua;/usr/<span class="keyword">local</span>/share/lua/<span class="number">5.1</span>/?/init.lua;/usr/<span class="keyword">local</span>/lib/lua/<span class="number">5.1</span>/?.lua;/usr/<span class="keyword">local</span>/lib/lua/<span class="number">5.1</span>/?/init.lua</span><br></pre></td></tr></table></figure><ul><li>那么调用 require(“module”) 时就会尝试打开以下文件目录去搜索目标。</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/Users/dengjoe/lua/<span class="built_in">module</span>.lua;</span><br><span class="line">./<span class="built_in">module</span>.lua</span><br><span class="line">/usr/<span class="keyword">local</span>/share/lua/<span class="number">5.1</span>/<span class="built_in">module</span>.lua</span><br><span class="line">/usr/<span class="keyword">local</span>/share/lua/<span class="number">5.1</span>/<span class="built_in">module</span>/init.lua</span><br><span class="line">/usr/<span class="keyword">local</span>/lib/lua/<span class="number">5.1</span>/<span class="built_in">module</span>.lua</span><br><span class="line">/usr/<span class="keyword">local</span>/lib/lua/<span class="number">5.1</span>/<span class="built_in">module</span>/init.lua</span><br></pre></td></tr></table></figure><h3 id="14.3-c%E5%8C%85" tabindex="-1">14.3 C包</h3><ol><li><p>Lua和C是很容易结合的，使用 C 为 Lua 写包。</p></li><li><p>与Lua中写包不同，<strong>C包在使用以前必须首先加载并连接</strong>，在大多数系统中最容易的实现方式是通过动态连接库机制。</p></li><li><p>Lua在一个叫<strong>loadlib的函数内提供了所有的动态连接的功能</strong>。这个函数有<strong>两个参数:库的绝对路径和初始化函数</strong>。所以典型的调用的例子如下:</p></li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="built_in">path</span> = <span class="string">&quot;/usr/local/lua/lib/libluasocket.so&quot;</span></span><br><span class="line"><span class="keyword">local</span> f = <span class="built_in">loadlib</span>(<span class="built_in">path</span>, <span class="string">&quot;luaopen_socket&quot;</span>)</span><br></pre></td></tr></table></figure><ul><li>loadlib 函数<strong>加载指定的库并且连接到 Lua</strong>，然而它<strong>并不打开库</strong>（也就是说<strong>没有调用初始化函数</strong>），反之他<strong>返回初始化函数作为 Lua 的一个函数</strong>，这样我们就可以<strong>直接在Lua中调用他</strong>。</li><li>如果加载动态库或者查找初始化函数时<strong>出错</strong>，<strong>loadlib 将返回 nil 和错误信息</strong>。我们可以修改前面一段代码，使其<strong>检测错误然后调用初始化函数</strong>：</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="built_in">path</span> = <span class="string">&quot;/usr/local/lua/lib/libluasocket.so&quot;</span></span><br><span class="line"><span class="comment">-- 或者 path = &quot;C:\\windows\\luasocket.dll&quot;，这是 Window 平台下</span></span><br><span class="line"><span class="keyword">local</span> f = <span class="built_in">assert</span>(<span class="built_in">loadlib</span>(<span class="built_in">path</span>, <span class="string">&quot;luaopen_socket&quot;</span>))</span><br><span class="line">f()  <span class="comment">-- 真正打开库</span></span><br></pre></td></tr></table></figure><p>一般情况下我们期望二进制的发布库包含一个与前面代码段相似的 stub 文件，安装二进制库的时候可以随便放在某个目录，只需要修改 stub 文件对应二进制库的实际路径即可。</p><p><strong>将 stub 文件所在的目录加入到 LUA_PATH，这样设定后就可以使用 require 函数加载 C 库了</strong>。</p><h1 id="%E5%8D%81%E4%BA%94-%E5%85%83%E8%A1%A8(metatable)%EF%BC%88%E2%AD%90%EF%BC%89" tabindex="-1">十五 元表(Metatable)（⭐）</h1><h3 id="15.1-%E6%A6%82%E8%BF%B0" tabindex="-1">15.1 概述</h3><ol><li><p>在 Lua table 中我们可以访问对应的 key 来得到 value 值，但是却无法对两个 table 进行操作(比如相加)。</p></li><li><p>因此 <strong>Lua 提供了元表(Metatable)</strong>，允许我们改变 table 的行为，每个行为关联了对应的<strong>元方法</strong>。<br>例如，<strong>使用元表我们可以定义 Lua 如何计算两个 table 的相加操作 a+b</strong>。</p></li><li><p>当 Lua 试图<strong>对两个表进行相加</strong>时，先<strong>检查两者之一是否有元表</strong>，<strong>之后检查</strong>是否有一个叫 <strong>__add 的字段</strong>，若<strong>找到，则调用对应的值</strong>。 <strong>__add 等即时字段</strong>，其对应的值（<strong>往往是一个函数或是 table</strong>）就是 <strong>“元方法”</strong> 。<br>有两个很重要的函数来处理元表（⭐）：</p></li></ol><ul><li><strong>setmetatable(table,metatable)</strong>: 对指定 table <strong>设置元表</strong>(metatable)，<strong>如果</strong>元表(metatable)中<strong>存在 __metatable 键值</strong>，setmetatable <strong>会失败</strong>。</li><li><strong>getmetatable(table)</strong>: <strong>返回对象的元表</strong>(metatable)。</li></ul><ol start="4"><li>以下实例演示了如何对指定的表设置元表：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mytable = &#123;&#125;                          <span class="comment">-- 普通表 </span></span><br><span class="line">mymetatable = &#123;&#125;                      <span class="comment">-- 元表</span></span><br><span class="line"><span class="built_in">setmetatable</span>(mytable,mymetatable)     <span class="comment">-- 把 mymetatable 设为 mytable 的元表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--以上代码写成一行</span></span><br><span class="line">mytable = <span class="built_in">setmetatable</span>(&#123;&#125;,&#123;&#125;)</span><br></pre></td></tr></table></figure><h3 id="15.2-__index-%E5%85%83%E6%96%B9%E6%B3%95%EF%BC%88%E2%AD%90%E2%AD%90%E2%AD%90%EF%BC%89" tabindex="-1">15.2 __index 元方法（⭐⭐⭐）</h3><ol><li><p><strong>这是 metatable 最常用的键</strong>。</p></li><li><p>当你<strong>通过键来访问</strong> table 的时候，如果<strong>这个键没有值</strong>，那么Lua就会<strong>寻找该table的metatable</strong>（假定有metatable）中的**__index 键**。如果**__index包含一个表格，Lua会在表格中查找相应的键**。我们可以在使用 lua 命令进入交互模式查看：</p></li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ lua</span><br><span class="line">Lua <span class="number">5.3</span><span class="number">.0</span>  Copyright (C) <span class="number">1994</span><span class="number">-2015</span> Lua.org, PUC-Rio</span><br><span class="line">&gt; other = &#123; foo = <span class="number">3</span> &#125; </span><br><span class="line">&gt; t = <span class="built_in">setmetatable</span>(&#123;&#125;, &#123; <span class="built_in">__index</span> = other &#125;) </span><br><span class="line">&gt; t.foo</span><br><span class="line"><span class="number">3</span></span><br><span class="line">&gt; t.bar</span><br><span class="line"><span class="literal">nil</span></span><br></pre></td></tr></table></figure><ol start="3"><li>如果 <strong>__index包含一个函数的话，Lua就会调用那个函数，table和键会作为参数传递给函数</strong>。</li></ol><p><strong>__index 元方法查看表中元素是否存在</strong>，如果<strong>不存在</strong>，返回结果<strong>为 nil</strong>；如果<strong>存在</strong>则<strong>由 __index 返回结果</strong>。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mytable = <span class="built_in">setmetatable</span>(&#123;key1 = <span class="string">&quot;value1&quot;</span>&#125;, &#123;</span><br><span class="line">  <span class="built_in">__index</span> = <span class="function"><span class="keyword">function</span><span class="params">(mytable, key)</span></span></span><br><span class="line">    <span class="keyword">if</span> key == <span class="string">&quot;key2&quot;</span> <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;metatablevalue&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(mytable.key1,mytable.key2)</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">value1    metatablevalue  </span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure><ol start="4"><li>实例解析（⭐）：</li></ol><ul><li><p>mytable 表赋值为 {key1 = “value1”}。</p></li><li><p>mytable 设置了元表，元方法为 __index。</p></li><li><p>在mytable表中查找 key1，如果找到，返回该元素，找不到则继续。</p></li><li><p>在mytable表中查找 key2，如果找到，返回 metatablevalue，找不到则继续。</p></li><li><p>判断元表有没有__index方法，如果__index方法是一个函数，则调用该函数。</p></li><li><p>元方法中查看是否传入 “key2” 键的参数（mytable.key2已设置），如果传入 “key2” 参数返回 “metatablevalue”，否则返回 mytable 对应的键值。</p></li></ul><p>5.我们可以将以上代码简单写成：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mytable = <span class="built_in">setmetatable</span>(&#123;key1 = <span class="string">&quot;value1&quot;</span>&#125;, &#123; <span class="built_in">__index</span> = &#123; key2 = <span class="string">&quot;metatablevalue&quot;</span> &#125; &#125;)</span><br><span class="line"><span class="built_in">print</span>(mytable.key1,mytable.key2)</span><br></pre></td></tr></table></figure><ol start="6"><li>总结（⭐）</li></ol><p>Lua 查找一个表元素时的规则，其实就是如下 3 个步骤:</p><ul><li><strong>在表中查找，如果找到，返回该元素，找不到则继续</strong></li><li><strong>判断该表是否有元表，如果没有元表，返回 nil，有元表则继续。</strong></li><li><strong>判断元表有没有 __index 方法，</strong><ul><li>如果 __index 方法为 <strong>nil</strong>，则返回<strong>nil</strong>；</li><li>如果 __index 方法是一个<strong>表</strong>，则<strong>重复 1、2、3</strong>；</li><li>如果 __index 方法是一个<strong>函数</strong>，则返回<strong>该函数的返回值</strong>。</li></ul></li></ul><h3 id="15.3-__newindex-%E5%85%83%E6%96%B9%E6%B3%95%EF%BC%88%E2%AD%90%EF%BC%89" tabindex="-1">15.3 __newindex 元方法（⭐）</h3><ol><li><strong>__newindex 元方法用来对表更新（赋值修改）</strong>，<strong>__index</strong>则用来<strong>对表访问</strong> 。</li><li>当你给表的一个<strong>缺少的索引赋值</strong>，解释器就会<strong>查找元表的__newindex 元方法</strong>：如果<strong>存在则调用这个函数而不进行赋值操作</strong>。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mymetatable = &#123;&#125;</span><br><span class="line">mytable = <span class="built_in">setmetatable</span>(&#123;key1 = <span class="string">&quot;value1&quot;</span>&#125;, &#123; <span class="built_in">__newindex</span> = mymetatable &#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(mytable.key1)</span><br><span class="line"></span><br><span class="line">mytable.newkey = <span class="string">&quot;新值2&quot;</span></span><br><span class="line"><span class="built_in">print</span>(mytable.newkey,mymetatable.newkey)</span><br><span class="line"></span><br><span class="line">mytable.key1 = <span class="string">&quot;新值1&quot;</span></span><br><span class="line"><span class="built_in">print</span>(mytable.key1,mymetatable.key1)</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">value1</span></span><br><span class="line"><span class="comment">nil    新值2</span></span><br><span class="line"><span class="comment">新值1    nil</span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure><p>以上实例中表<strong>设置了元方法 __newindex</strong>，在对新索引键 <strong>（newkey）赋值</strong>时（mytable.newkey = “新值2”），<strong>会调用元方法</strong>，而不进行赋值。而如果对<strong>已存在的索引键（key1）</strong>，则<strong>会进行赋值，而不调用元方法</strong> __newindex。</p><h3 id="15.4-rawget%E5%92%8Crawset" tabindex="-1">15.4 rawget和rawset</h3><ol><li>rawget</li></ol><ul><li>绕开__index 只获取表自身属性有没有 （不关心元表的）</li></ul><ol start="2"><li>rawset</li></ol><ul><li>绕开__newindex 只设置表自身属性 （不重定向到元表__newindex对应的表）</li></ul><h3 id="15.5-%E8%BF%90%E7%AE%97%E5%85%83%E6%96%B9%E6%B3%95-%E4%B8%BA%E8%A1%A8%E6%B7%BB%E5%8A%A0%E6%93%8D%E4%BD%9C%E7%AC%A6" tabindex="-1">15.5 运算元方法-为表添加操作符</h3><ol><li>表中对应的操作列表如下：(注意：__是两个下划线)</li></ol><table><thead><tr><th>模式</th><th>描述</th></tr></thead><tbody><tr><td>__add</td><td>对应的运算符 ‘+’.</td></tr><tr><td>__sub</td><td>对应的运算符 ‘-’.</td></tr><tr><td>__mul</td><td>对应的运算符 ‘*’.</td></tr><tr><td>__div</td><td>对应的运算符 ‘/’.</td></tr><tr><td>__mod</td><td>对应的运算符 ‘%’.</td></tr><tr><td>__unm</td><td>对应的运算符 ‘-’.</td></tr><tr><td>__concat</td><td>对应的运算符 ‘…’.</td></tr><tr><td>__eq</td><td>对应的运算符 ‘==’.</td></tr><tr><td>__lt</td><td>对应的运算符 ‘&lt;’.</td></tr><tr><td>__le</td><td>对应的运算符 ‘&lt;=’.</td></tr></tbody></table><ol start="2"><li>以下实例演示了两表相加操作：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 计算表中最大值，table.maxn在Lua5.2以上版本中已无法使用</span></span><br><span class="line"><span class="comment">-- 自定义计算表中最大键值函数 table_maxn，即返回表最大键值</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">table_maxn</span><span class="params">(t)</span></span></span><br><span class="line">    <span class="keyword">local</span> mn = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(t) <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">if</span> mn &lt; k <span class="keyword">then</span></span><br><span class="line">            mn = k</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> mn</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 两表相加操作</span></span><br><span class="line">mytable = <span class="built_in">setmetatable</span>(&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;, &#123;</span><br><span class="line">  <span class="built_in">__add</span> = <span class="function"><span class="keyword">function</span><span class="params">(mytable, newtable)</span></span></span><br><span class="line">    <span class="keyword">for</span> i = <span class="number">1</span>, table_maxn(newtable) <span class="keyword">do</span></span><br><span class="line">      <span class="built_in">table</span>.<span class="built_in">insert</span>(mytable, table_maxn(mytable)+<span class="number">1</span>,newtable[i])</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> mytable</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">secondtable = &#123;<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;</span><br><span class="line"></span><br><span class="line">mytable = mytable + secondtable</span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> <span class="built_in">ipairs</span>(mytable) <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">print</span>(k,v)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">1    1</span></span><br><span class="line"><span class="comment">2    2</span></span><br><span class="line"><span class="comment">3    3</span></span><br><span class="line"><span class="comment">4    4</span></span><br><span class="line"><span class="comment">5    5</span></span><br><span class="line"><span class="comment">6    6</span></span><br><span class="line"><span class="comment">--]]</span></span><br><span class="line"><span class="built_in">__add</span> 键包含在元表中，并进行相加操作。 </span><br></pre></td></tr></table></figure><h3 id="15.6-__call%E5%85%83%E6%96%B9%E6%B3%95" tabindex="-1">15.6 __call元方法</h3><ol><li>__call 元方法在 <strong>Lua 调用一个值时调用（当子表做为函数名字的形式被调用的时候，如mytable(newtable)，会调用__call函数）</strong>。以下实例演示了计算表中元素的和：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 计算表中最大值，table.maxn在Lua5.2以上版本中已无法使用</span></span><br><span class="line"><span class="comment">-- 自定义计算表中最大键值函数 table_maxn，即计算表的元素个数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">table_maxn</span><span class="params">(t)</span></span></span><br><span class="line">    <span class="keyword">local</span> mn = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(t) <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">if</span> mn &lt; k <span class="keyword">then</span></span><br><span class="line">            mn = k</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> mn</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 定义元方法__call</span></span><br><span class="line">mytable = <span class="built_in">setmetatable</span>(&#123;<span class="number">10</span>&#125;, &#123;</span><br><span class="line">  <span class="built_in">__call</span> = <span class="function"><span class="keyword">function</span><span class="params">(mytable, newtable)</span></span></span><br><span class="line">        sum = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i = <span class="number">1</span>, table_maxn(mytable) <span class="keyword">do</span></span><br><span class="line">                sum = sum + mytable[i]</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">for</span> i = <span class="number">1</span>, table_maxn(newtable) <span class="keyword">do</span></span><br><span class="line">                sum = sum + newtable[i]</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">return</span> sum</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">&#125;)</span><br><span class="line">newtable = &#123;<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(mytable(newtable))</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">70</span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure><h3 id="15.7-__tostring-%E5%85%83%E6%96%B9%E6%B3%95" tabindex="-1">15.7 __tostring 元方法</h3><ol><li>__tostring 元方法用于修改表的输出行为。以下实例我们自定义了表的输出内容：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mytable = <span class="built_in">setmetatable</span>(&#123; <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span> &#125;, &#123;</span><br><span class="line">  <span class="built_in">__tostring</span> = <span class="function"><span class="keyword">function</span><span class="params">(mytable)</span></span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(mytable) <span class="keyword">do</span></span><br><span class="line">                sum = sum + v</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;表所有元素的和为 &quot;</span> .. sum</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(mytable)</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">表所有元素的和为 60    </span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure><h1 id="%E5%8D%81%E5%85%AD-%E5%8D%8F%E5%90%8C%E7%A8%8B%E5%BA%8F%EF%BC%88coroutine%EF%BC%89%EF%BC%88%E2%AD%90%E2%AD%90%E2%AD%90%EF%BC%89" tabindex="-1">十六 协同程序（coroutine）（⭐⭐⭐）</h1><h3 id="16.1-%E4%BB%80%E4%B9%88%E6%98%AF%E5%8D%8F%E5%90%8C%EF%BC%88coroutine%EF%BC%89" tabindex="-1">16.1 什么是协同（coroutine）</h3><ol><li>Lua 协同程序(coroutine)与线程比较类似：<strong>拥有独立的堆栈，独立的局部变量，独立的指令指针，同时又与其它协同程序共享全局变量和其它大部分东西</strong>。</li><li>协同程序可以理解为<strong>一种特殊的线程</strong>，可以<strong>暂停和恢复其执行</strong>，从而允许非抢占式的多任务处理。</li><li>协同是非常强大的功能，但是用起来也很复杂。</li></ol><h3 id="16.2-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95" tabindex="-1">16.2 基本语法</h3><ol><li><p><strong>协同程序由 coroutine 模块</strong>提供支持。</p></li><li><p>使用协同程序，你可以在函数中使用 <strong>coroutine.create 创建一个新的协同程序对象</strong>，并使用 <strong>coroutine.resume 启动它的执行</strong>。协同程序可以通过调用 <strong>coroutine.yield 来主动暂停自己的执行</strong>，并将控制权交还给调用者。</p></li><li><p>具体函数方法</p></li></ol><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>coroutine.create()</td><td><strong>创建 coroutine，返回 coroutine</strong>， 参数是一个函数，当和 resume 配合使用的时候就唤醒函数调用</td></tr><tr><td>coroutine.resume()</td><td><strong>重启 coroutine</strong>，和 create 配合使用。<strong>正常结束返回true+yield的返回值，否则返回false+yield的返回值（一般对已结束的协程resume就会false）</strong>。<strong>返回值是yield()的参数。</strong></td></tr><tr><td>coroutine.yield()</td><td><strong>挂起 coroutine</strong>，将 coroutine 设置为挂起状态，这个和 resume 配合使用能有很多有用的效果。<strong>返回值是resume调用时传入的值</strong>。</td></tr><tr><td>coroutine.status()</td><td><strong>查看 coroutine 的状态</strong><br>注：coroutine 的状态有三种：dead，suspended，running(已结束、已挂起、运行中),具体什么时候有这样的状态请参考下面的程序。</td></tr><tr><td>coroutine.wrap()</td><td><strong>创建 coroutine，返回一个函数，一旦你调用这个函数，就进入 coroutine，和 create 功能重复</strong></td></tr><tr><td>coroutine.running()</td><td><strong>返回正在跑的 coroutine</strong>，一个 coroutine 就是一个线程，当使用running的时候，就是<strong>返回一个 coroutine 的线程号</strong> + <strong>true/false</strong></td></tr></tbody></table><ol start="4"><li>以下实例演示了如何使用 Lua 协同程序：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;协同程序 foo 开始执行&quot;</span>)</span><br><span class="line">    <span class="keyword">local</span> value = <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(<span class="string">&quot;暂停 foo 的执行&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;协同程序 foo 恢复执行，传入的值为: &quot;</span> .. <span class="built_in">tostring</span>(value))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;协同程序 foo 结束执行&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建协同程序</span></span><br><span class="line"><span class="keyword">local</span> co = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(foo)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 启动协同程序</span></span><br><span class="line"><span class="keyword">local</span> <span class="built_in">status</span>, result = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co)</span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment">-- 输出: 暂停 foo 的执行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 恢复协同程序的执行，并传入一个值</span></span><br><span class="line"><span class="built_in">status</span>, result = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="number">42</span>)</span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment">-- 输出: 协同程序 foo 恢复执行，传入的值为: 42</span></span><br></pre></td></tr></table></figure><ul><li><p>以上实例中，我们<strong>定义了一个名为 foo 的函数作为协同程序</strong>。在函数中，我们<strong>使用 coroutine.yield 暂停了协同程序的执行，并返回了一个值</strong></p></li><li><p>在主程序中，我们使用 <strong>coroutine.create 创建了一个协同程序对象</strong>，并使用 <strong>coroutine.resume 启动了它的执行</strong>。</p></li><li><p>在<strong>第一次调用 coroutine.resume 后，协同程序执行到 coroutine.yield 处暂停</strong>，<strong>并将值返回给主程序</strong>。然后，我们<strong>再次调用 coroutine.resume，并传入一个值作为协同程序恢复执行时的参数</strong>。</p></li></ul><p>执行以上代码输出结果为：</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">协同程序 foo 开始执行</span><br><span class="line">暂停 foo 的执行</span><br><span class="line">协同程序 foo 恢复执行，传入的值为: <span class="number">42</span></span><br><span class="line">协同程序 foo 结束执行</span><br><span class="line"><span class="literal">nil</span></span><br></pre></td></tr></table></figure><h3 id="16.3-%E5%90%84%E4%B8%AA%E8%AF%AD%E6%B3%95%E7%9A%84%E7%94%A8%E6%B3%95%E5%AE%9E%E4%BE%8B" tabindex="-1">16.3 各个语法的用法实例</h3><ol><li>实例1</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- coroutine_test.lua 文件</span></span><br><span class="line"><span class="comment">-- 创建了一个新的协同程序对象 co，其中协同程序函数打印传入的参数 i</span></span><br><span class="line">co = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(</span><br><span class="line">    <span class="function"><span class="keyword">function</span><span class="params">(i)</span></span></span><br><span class="line">        <span class="built_in">print</span>(i);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">-- 使用 coroutine.resume 启动协同程序 co 的执行，并传入参数 1。协同程序开始执行，打印输出为 1</span></span><br><span class="line"><span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="number">1</span>)   <span class="comment">-- 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 通过 coroutine.status 检查协同程序 co 的状态，输出为 dead，表示协同程序已经执行完毕</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">status</span>(co))  <span class="comment">-- dead</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;----------&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用 coroutine.wrap 创建了一个协同程序包装器，将协同程序函数转换为一个可直接调用的函数对象</span></span><br><span class="line">co = <span class="built_in">coroutine</span>.<span class="built_in">wrap</span>(</span><br><span class="line">    <span class="function"><span class="keyword">function</span><span class="params">(i)</span></span></span><br><span class="line">        <span class="built_in">print</span>(i);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line"> </span><br><span class="line">co(<span class="number">1</span>)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;----------&quot;</span>)</span><br><span class="line"><span class="comment">-- 创建了另一个协同程序对象 co2，其中的协同程序函数通过循环打印数字 1 到 10，在循环到 3 的时候输出当前协同程序的状态和正在运行的线程</span></span><br><span class="line">co2 = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(</span><br><span class="line">    <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        <span class="keyword">for</span> i=<span class="number">1</span>,<span class="number">10</span> <span class="keyword">do</span></span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">3</span> <span class="keyword">then</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">status</span>(co2))  <span class="comment">--running</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">running</span>()) <span class="comment">--thread:XXXXXX</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="built_in">coroutine</span>.<span class="built_in">yield</span>()</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 连续调用 coroutine.resume 启动协同程序 co2 的执行</span></span><br><span class="line"><span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co2) <span class="comment">--1</span></span><br><span class="line"><span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co2) <span class="comment">--2</span></span><br><span class="line"><span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co2) <span class="comment">--3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 通过 coroutine.status 检查协同程序 co2 的状态，输出为 suspended，表示协同程序暂停执行</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">status</span>(co2))   <span class="comment">-- suspended</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">coroutine</span>.<span class="built_in">running</span>())</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;----------&quot;</span>)</span><br></pre></td></tr></table></figure><p>输出结果为</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line">dead</span><br><span class="line"><span class="comment">----------</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="comment">----------</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="built_in">running</span></span><br><span class="line">thread: <span class="number">0x7fb801c05868</span>    <span class="literal">false</span></span><br><span class="line">suspended</span><br><span class="line">thread: <span class="number">0x7fb801c04c88</span>    <span class="literal">true</span></span><br><span class="line"><span class="comment">----------</span></span><br></pre></td></tr></table></figure><p>coroutine.running就可以看出来,<strong>coroutine在底层实现就是一个线程</strong>。</p><p>当<strong>create一个coroutine的时候就是在新线程中注册了一个事件</strong>。</p><p>当<strong>使用resume触发事件的时候</strong>，create的<strong>coroutine函数就被执行了</strong>，当<strong>遇到yield的时候就代表挂起当前线程</strong>，<strong>等候再次resume触发事件</strong>。</p><ol start="2"><li>接下来我们分析一个更详细的实例：</li></ol><figure class="highlight lua"><figcaption><span>&#123;.line-numbers&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> <span class="params">(a)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;foo 函数输出&quot;</span>, a)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(<span class="number">2</span> * a) <span class="comment">-- 返回  2*a 的值</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line">co = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(<span class="function"><span class="keyword">function</span> <span class="params">(a , b)</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;第一次协同程序执行输出&quot;</span>, a, b) <span class="comment">-- co-body 1 10</span></span><br><span class="line">    <span class="keyword">local</span> r = foo(a + <span class="number">1</span>)</span><br><span class="line">     </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;第二次协同程序执行输出&quot;</span>, r)</span><br><span class="line">    <span class="keyword">local</span> r, s = <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(a + b, a - b)  <span class="comment">-- a，b的值为第一次调用协同程序时传入</span></span><br><span class="line">     </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;第三次协同程序执行输出&quot;</span>, r, s)</span><br><span class="line">    <span class="keyword">return</span> b, <span class="string">&quot;结束协同程序&quot;</span>                   <span class="comment">-- b的值为第二次调用协同程序时传入</span></span><br><span class="line"><span class="keyword">end</span>)</span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;main&quot;</span>, <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="number">1</span>, <span class="number">10</span>)) <span class="comment">-- true, 4</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;--分割线----&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;main&quot;</span>, <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="string">&quot;r&quot;</span>)) <span class="comment">-- true 11 -9</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;---分割线---&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;main&quot;</span>, <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>)) <span class="comment">-- true 10 end</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;---分割线---&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;main&quot;</span>, <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(co, <span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>)) <span class="comment">-- cannot resume dead coroutine</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;---分割线---&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">第一次协同程序执行输出    1    10</span></span><br><span class="line"><span class="comment">foo 函数输出    2</span></span><br><span class="line"><span class="comment">main    true    4</span></span><br><span class="line"><span class="comment">--分割线----</span></span><br><span class="line"><span class="comment">第二次协同程序执行输出    r</span></span><br><span class="line"><span class="comment">main    true    11    -9</span></span><br><span class="line"><span class="comment">---分割线---</span></span><br><span class="line"><span class="comment">第三次协同程序执行输出    x    y</span></span><br><span class="line"><span class="comment">main    true    10    结束协同程序</span></span><br><span class="line"><span class="comment">---分割线---</span></span><br><span class="line"><span class="comment">main    false    cannot resume dead coroutine</span></span><br><span class="line"><span class="comment">---分割线---</span></span><br><span class="line"><span class="comment">--]]</span></span><br></pre></td></tr></table></figure><p>对以上程序进行详细流程说明（⭐⭐⭐）:</p><ul><li>首先按正常流程走到第6行创建协程，但没有启动</li><li>运行<strong>17行</strong>启动协程co。传入参数1，10。</li><li>此时<strong>6行</strong>的匿名函数参数a，b的值为1，10</li><li>运行<strong>7行</strong> 输出 <strong><font color="red">第一次协同程序执行输出    1    10</font></strong></li><li>运行<strong>8行</strong>执行函数1行foo，传入参数a+1 (即1+1 为2)</li><li>此时<strong>1行</strong>的函数foo参数a的值为2</li><li>运行<strong>2行</strong> 输出 <strong><font color="red">foo 函数输出    2</font></strong></li><li>运行<strong>3行</strong> <strong>中断协程</strong>，此时返回给<strong>17行</strong>的coroutine.resume(co, 1, 10) 返回值。 返回值构成为两部分：<ul><li>true(正常结束返回true，<strong>一般对已结束的协程resume就会false</strong>)</li><li>3行中coroutine.yield(2 * a)中的所有参数，这里为 2*a （即 2*2 为 4）</li><li>最终返回值为 true, 4</li></ul></li><li>返回到<strong>17行</strong> 输出 <strong><font color="red">main    true    4</font></strong></li><li>运行<strong>18行</strong> 输出 <strong><font color="red">–分割线----</font></strong></li><li>--------------------------------------------------------------------------------------------------------</li><li>运行<strong>19行</strong>再次启动协程co，传入参数“r”，并从上一次终端的位置开始运行，即<strong>3行</strong></li><li>运行<strong>3行</strong> 此时 <strong>coroutine.yield(2 * a)</strong> 的值<strong>为再次启动协程时传入的参数</strong>，即<strong>19行传入的参数 “r”</strong><ul><li><strong>因此3行执行的代码为 return “r”</strong></li></ul></li><li>运行<strong>4行</strong> end</li><li>返回<strong>8行</strong> 得到foo（a+1）的返回值为3行的返回值 <strong>“r”</strong>,并赋值给本地变量r</li><li>运行<strong>10行</strong> 输出 <strong><font color="red">第二次协同程序执行输出    r</font></strong></li><li>运行<strong>11行</strong> <strong>中断协程</strong>，此时返回给<strong>19行</strong> 的coroutine.resume(co, 1, 10) 返回值.返回值构成为：<ul><li>true(正常结束返回true，<strong>一般对已结束的协程resume就会false</strong>)</li><li>coroutine.yield(a + b, a - b)中的所有参数，即a + b, a - b -&gt; 1+10 , 1-10 -&gt; 11,-9 <strong>(a，b的值为第一次调用协同程序时传入)</strong></li><li>最终返回值为 true, 11, -9</li></ul></li><li>返回<strong>19行</strong> 输出 <strong><font color="red">main    true    11    -9</font></strong></li><li>运行<strong>20行</strong> 输出 <strong><font color="red">—分割线—</font></strong></li><li>--------------------------------------------------------------------------------------------------------</li><li>运行<strong>21行</strong> <strong>同理19行</strong>，再次启动协程co，传入参数&quot;x&quot;, “y”，并从上一次终端的位置开始运行，即<strong>11行</strong></li><li>运行<strong>11行</strong> 此时 <strong>coroutine.yield(a + b, a - b)</strong> 的值<strong>为再次启动协程时传入的参数</strong>，即<strong>21行传入的参数 “x”, “y”</strong><ul><li><strong>因此11行执行的代码为 local r, s = “x”, “y”</strong></li></ul></li><li>运行<strong>13行</strong> 输出 <strong><font color="red">第三次协同程序执行输出    x    y</font></strong></li><li>运行<strong>14行</strong> 返回协程返回值，构成为：<ul><li>true(正常结束返回true，<strong>一般对已结束的协程resume就会false</strong>)</li><li>协程正常返回值，即<strong>b, “结束协同程序”</strong> 。<strong>(a，b的值为第一次调用协同程序时传入)</strong></li><li>最终返回值为 true, 10, “结束协同程序”</li></ul></li><li>返回<strong>21行</strong> 输出 <strong><font color="red">main    true    10    结束协同程序</font></strong></li><li>运行<strong>22行</strong> 输出 <strong><font color="red">—分割线—</font></strong></li><li>运行<strong>23行</strong> 由于协程运行完成，因此启用协程会失败。输出 <strong><font color="red">main    false    cannot resume dead coroutine</font></strong></li><li>运行<strong>24行</strong> 输出 <strong><font color="red">—分割线—</font></strong></li></ul><h3 id="16.4-%E7%94%9F%E4%BA%A7%E8%80%85-%E6%B6%88%E8%B4%B9%E8%80%85%E9%97%AE%E9%A2%98" tabindex="-1">16.4 生产者-消费者问题</h3><ol><li>使用Lua的协同程序来完成生产者-消费者这一经典问题。</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> newProductor</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">productor</span><span class="params">()</span></span></span><br><span class="line">     <span class="keyword">local</span> i = <span class="number">0</span></span><br><span class="line">     <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">          i = i + <span class="number">1</span></span><br><span class="line">          send(i)     <span class="comment">-- 将生产的物品发送给消费者</span></span><br><span class="line">     <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">consumer</span><span class="params">()</span></span></span><br><span class="line">     <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">          <span class="keyword">local</span> i = receive()     <span class="comment">-- 从生产者那里得到物品</span></span><br><span class="line">          <span class="built_in">print</span>(i)</span><br><span class="line">     <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">receive</span><span class="params">()</span></span></span><br><span class="line">     <span class="keyword">local</span> <span class="built_in">status</span>, value = <span class="built_in">coroutine</span>.<span class="built_in">resume</span>(newProductor)</span><br><span class="line">     <span class="keyword">return</span> value</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">(x)</span></span></span><br><span class="line">     <span class="built_in">coroutine</span>.<span class="built_in">yield</span>(x)     <span class="comment">-- x表示需要发送的值，值返回以后，就挂起该协同程序</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 启动程序</span></span><br><span class="line">newProductor = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(productor)</span><br><span class="line">consumer()</span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">9</span></span><br><span class="line"><span class="comment">10</span></span><br><span class="line"><span class="comment">11</span></span><br><span class="line"><span class="comment">12</span></span><br><span class="line"><span class="comment">13</span></span><br><span class="line"><span class="comment">……</span></span><br><span class="line"><span class="comment">--]]</span></span><br><span class="line"><span class="comment">-- 启动程序</span></span><br><span class="line">newProductor = <span class="built_in">coroutine</span>.<span class="built_in">create</span>(productor)</span><br><span class="line">consumer()</span><br></pre></td></tr></table></figure><h3 id="16.5-%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%8D%8F%E5%90%8C%E7%A8%8B%E5%BA%8F%E5%8C%BA%E5%88%AB" tabindex="-1">16.5 线程和协同程序区别</h3><ol><li><p>线程与协同程序的<strong>主要区别在于，一个具有多个线程的程序可以同时运行几个线程，而协同程序却需要彼此协作的运行</strong>。</p></li><li><p>在<strong>任一指定时刻只有一个协同程序在运行</strong>，并且这个正在运行的协同程序只有在明确的被要求挂起的时候才会被挂起。<br>协同程序有点类似同步的多线程，在等待同一个线程锁的几个线程有点类似协同。</p></li><li><p>主要区别归纳如下：</p></li></ol><ul><li><p><strong>调度方式</strong>：<strong>线程</strong>通常由<strong>操作系统的调度器进行抢占式调度</strong>，操作系统会在不同线程之间切换执行权。而<strong>协同程序</strong>是<strong>非抢占式调度</strong>的，它们由<strong>程序员显式地控制执行权</strong>的转移。</p></li><li><p><strong>并发性</strong>：<strong>线程是并发</strong>执行的，<strong>多个线程可以同时运行</strong>在多个处理器核心上，或者通过时间片轮转在单个核心上切换执行。<strong>协同程序则是协作式</strong>的，<strong>只有一个协同程序处于运行状态</strong>，其他协同程序<strong>必须等待当前协同程序主动放弃执行权</strong>。</p></li><li><p><strong>内存占用</strong>：<strong>线程通常需要独立的堆栈和上下文环境</strong>，因此线程的<strong>创建和销毁</strong>会带来<strong>额外的开销</strong>。而<strong>协同程序可以共享相同的堆栈和上下文</strong>，因此创建和销毁协同程序的<strong>开销较小</strong>。</p></li><li><p><strong>数据共享</strong>：<strong>线程</strong>之间可以<strong>共享内存空间</strong>，但<strong>需要注意线程安全性和同步</strong>问题。<strong>协同程序</strong>通常<strong>通过参数传递和返回值</strong>来进行<strong>数据共享</strong>，<strong>不同协同程序</strong>之间的<strong>数据隔离性较好</strong>。</p></li><li><p>调试和错误处理：<strong>线程通常在调试和错误处理方面更复杂</strong>，因为多个线程之间的交互和并发执行可能导致难以调试的问题。<strong>协同程序则在调试和错误处理方面相对简单</strong>，因为它们是由程序员显式地控制执行流程的。</p></li></ul><ol start="4"><li>总体而言，<strong>线程适用于需要并发执行的场景</strong>，例如在多核处理器上利用并行性加快任务的执行速度。而<strong>协同程序适用于需要协作和协调的场景</strong>，例如<strong>状态机、事件驱动编程或协作式任务处理</strong>。选择使用线程还是协同程序取决于具体的应用需求和编程模型。</li></ol><h1 id="%E5%8D%81%E4%B8%83-%E6%96%87%E4%BB%B6i%2Fo" tabindex="-1">十七 文件I/O</h1><h3 id="17.1-%E6%A6%82%E8%BF%B0%E5%8F%8A%E7%94%A8%E6%B3%95" tabindex="-1">17.1 概述及用法</h3><ol><li>Lua I/O 库用于读取和处理文件。分为简单模式（和C一样）、完全模式。</li></ol><ul><li>简<strong>单模式（simple model）拥有一个当前输入文件和一个当前输出文件</strong>，并且提供针对这些文件相关的操作。</li><li><strong>完全模式（complete model） 使用外部的文件句柄来实现</strong>。它以一种面对对象的形式，将所有的文件操作定义为文件句柄的方法</li></ul><ol start="2"><li><p><strong>简单模式在做一些简单的文件操作时较为合适</strong>。但是在<strong>进行一些高级的文件操作的时候，简单模式就显得力不从心。例如同时读取多个文件这样的操作，使用完全模式则较为合适</strong>。</p></li><li><p>打开文件操作语句如下：</p></li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span> (filename [, mode])</span><br></pre></td></tr></table></figure><ul><li>mode的值有：</li></ul><table><thead><tr><th>模式</th><th>描述</th></tr></thead><tbody><tr><td>r</td><td>以<strong>只读方式打开文</strong>件，该<strong>文件必须存在</strong>。</td></tr><tr><td>w</td><td><strong>打开只写文件</strong>，若<strong>文件存在则</strong>文件长度清为0，即<strong>该文件内容会消失</strong>。若<strong>文件不存在则建立该文件</strong>。</td></tr><tr><td>a</td><td>以<strong>附加的方式打开只写文件</strong>。若<strong>文件不存在</strong>，则会<strong>建立</strong>该文件，如果<strong>文件存在</strong>，写入的<strong>数据会被加到文件尾</strong>，即文件<strong>原先的内容会被保留</strong>。（EOF符保留）</td></tr><tr><td>r+</td><td>以<strong>可读写方式打开文件</strong>，该<strong>文件必须存在</strong>。</td></tr><tr><td>w+</td><td><strong>打开可读写文件</strong>，若****文件存在<strong>则文件长度清为零，即该文件</strong>内容会消失**。若文件<strong>不存在则建立</strong>该文件。</td></tr><tr><td>a+</td><td>与<strong>a类似，但此文件可读可写</strong></td></tr><tr><td>b</td><td><strong>二进制模式，如果文件是二进制文件，可以加上b</strong></td></tr><tr><td>+</td><td><strong>号表示对文件既可以读也可以写</strong></td></tr></tbody></table><h3 id="17.2-%E7%AE%80%E5%8D%95%E6%A8%A1%E5%BC%8F%EF%BC%88io.%E8%B0%83%E7%94%A8%EF%BC%89" tabindex="-1">17.2 简单模式（io.调用）</h3><ol><li>简单模式使用标准的 I/O 或使用一个当前输入文件和一个当前输出文件。<br>以下为 file.lua 文件代码，操作的文件为test.lua(如果没有你需要创建该文件)，代码如下：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 以只读方式打开文件</span></span><br><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">&quot;test.lua&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置默认输入文件为 test.lua</span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">input</span>(file)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 输出文件第一行</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">io</span>.<span class="built_in">read</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关闭打开的文件</span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">close</span>(file)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 以附加的方式打开只写文件</span></span><br><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">&quot;test.lua&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置默认输出文件为 test.lua</span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">output</span>(file)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在文件最后一行添加 Lua 注释</span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">write</span>(<span class="string">&quot;--  test.lua 文件末尾注释&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关闭打开的文件</span></span><br><span class="line"><span class="built_in">io</span>.<span class="built_in">close</span>(file)</span><br></pre></td></tr></table></figure><p>执行以上代码，你会发现，输出了 test.lua 文件的第一行信息，并在该文件最后一行添加了 lua 的注释。如我这边输出的是：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- test.lua 文件</span></span><br></pre></td></tr></table></figure><ol start="2"><li>在以上实例中我们使用了 io.“x” 方法，其中 io.read() 中我们没有带参数，参数可以是下表中的一个：</li></ol><table><thead><tr><th>模式</th><th>描述</th></tr></thead><tbody><tr><td>“*n”</td><td><strong>读取一个数字并返回它</strong>。例：file.read(“*n”)</td></tr><tr><td>“*a”</td><td><strong>从当前位置读取整个文件</strong>。例：file.read(“*a”)</td></tr><tr><td>“*l”（默认）</td><td><strong>读取下一行</strong>，在文件尾 (EOF) 处返回 nil。例：file.read(“*l”)</td></tr><tr><td>number</td><td><strong>返回一个指定字符个数的字符串</strong>，如果number为0则返回空字串，或在 EOF 时返回 nil。例：file.read(5)</td></tr></tbody></table><ol start="3"><li>简单模式的I/O方法汇总<br>参考博客：<a href="https://blog.csdn.net/duanxuyun/article/details/4751118">lua 的io操作，非常详细。</a></li></ol><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>io.close ([file])</td><td>功能：相当于file:close()，关闭默认的输出文件</td></tr><tr><td>io.flush ()</td><td>功能：相当于file:flush(),<strong>输出所有缓冲中的内容到默认输出文件</strong></td></tr><tr><td>io.lines ([filename])</td><td>功能：打开指定的文件filename为读模式并<strong>返回一个迭代函数（配合循环语句使用）</strong>,每次调用将<strong>获得文件中的一行内容,当到文件尾时，将返回nil,并自动关闭文件</strong>。<strong>若不带参数时io.lines() &lt;=&gt; io.input():lines()</strong>; <strong>读取默认输入设备的内容，但结束时不关闭文件。</strong> <br>如：for line in io.lines(“main.lua”) do<br>　　print(line)<br>　　end</td></tr><tr><td>io.open (filename [, mode])</td><td>功能：<strong>按指定的模式打开一个文件</strong>，成功则返回文件句柄，失败则返回nil+错误信息。模式参数说明在 <a href="#171-%E6%A6%82%E8%BF%B0%E5%8F%8A%E7%94%A8%E6%B3%95">17.1 概述及用法</a> 中的第3点有说明</td></tr><tr><td>io.output ([file])</td><td>功能：相当于io.input，但操作在默认输出文件上</td></tr><tr><td>io.popen ([prog [, mode]])</td><td>功能：开始程序prog于额外的进程,并返回用于prog的文件句柄(并不支持所有的系统平台)</td></tr><tr><td>io.read (…)</td><td>功能：从当前输入流输入读取一行，参数在 <a href="#172-%E7%AE%80%E5%8D%95%E6%A8%A1%E5%BC%8Fio%E8%B0%83%E7%94%A8">17.2 简单模式</a> 中的第2点提到。相当于io.input():read。 <strong>不带参数时，默认每运行一次io.read()就向下读一行</strong></td></tr><tr><td>io.tmpfile ()</td><td>功能：返回一个临时文件句柄，该文件以更新模式打开，程序结束时自动删除</td></tr><tr><td>io.type (obj)</td><td>功能：检测obj是否一个可用的文件句柄<br>返回：<br>　　“file”：为一个打开的文件句柄<br>　　“closed file”：为一个已关闭的文件句柄<br>　　nil: 表示obj不是一个文件句柄</td></tr><tr><td>io.write (…)</td><td>功能：相当于io.output():write,向文件写入内容，写入方式会根据mode而不同。</td></tr></tbody></table><h3 id="17.3-%E5%AE%8C%E5%85%A8%E6%A8%A1%E5%BC%8F%EF%BC%88file%3A%E8%B0%83%E7%94%A8%EF%BC%89" tabindex="-1">17.3 完全模式（file:调用）</h3><ol><li>通常我们<strong>需要在同一时间处理多个文件</strong>。我们需要<strong>使用 file:function_name 来代替 io.function_name 方法</strong>。以下实例演示了如何同时处理同一个文件:</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 以只读方式打开文件</span></span><br><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">&quot;test.lua&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 输出文件第一行</span></span><br><span class="line"><span class="built_in">print</span>(file:<span class="built_in">read</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关闭打开的文件</span></span><br><span class="line">file:<span class="built_in">close</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 以附加的方式打开只写文件</span></span><br><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">&quot;test.lua&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在文件最后一行添加 Lua 注释</span></span><br><span class="line">file:<span class="built_in">write</span>(<span class="string">&quot;--test&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关闭打开的文件</span></span><br><span class="line">file:<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure><p><strong>read 的参数与简单模式一致。</strong></p><ol start="2"><li>完全模式的I/O方法汇总</li></ol><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>file:close()</td><td>功能：关闭文件。　注：<strong>当文件句柄被垃圾收集后，文件将自动关闭。句柄将变为一个不可预知的值</strong></td></tr><tr><td>file:flush()</td><td>功能：向文件写入缓冲中的所有数据</td></tr><tr><td>file:lines()</td><td>功能：<strong>返回一个迭代函数（配合循环语句使用）</strong>,每次调用将获得文件中的一行内容,<strong>当到文件尾时，将返回nil,但不关闭文件。</strong> <br>如：for line in file:lines() do body end</td></tr><tr><td>file:read(…)</td><td>功能：<strong>按指定的格式读取一个文件</strong>,按每个格式函数将<strong>返回一个字串或数字,如果不能正确读取将返回nil</strong>,若<strong>没有指定格式将指默认按行方式</strong>进行<strong>读取</strong>。参数与 <a href="#172-%E7%AE%80%E5%8D%95%E6%A8%A1%E5%BC%8Fio%E8%B0%83%E7%94%A8">17.2 简单模式</a> 中的第2点相同。 <strong>不带参数时，默认每运行一次io.read()就向下读一行</strong></td></tr><tr><td>file:seek([whence][,offset])</td><td>功能：<strong>设置和获取当前文件位置</strong>,<strong>成功则返回最终的文件位置</strong>(按字节),<strong>失败则返回nil加错误信息</strong><br>参数:<br>　　whence:<br>　　　“set”: 从文件头开始<br>　　　“cur”: 从当前位置开始[默认]<br>　　　“end”: 从文件尾开始<br>　　offset: 默认为0<br><strong>不带参数file:seek()则返回当前位置</strong>,file:seek(“set”)<strong>则定位到文件头</strong>,file:seek(“end”)<strong>则定位到文件尾并返回文件大小</strong></td></tr><tr><td>file:setvbuf(mode,[,size])</td><td>功能：<strong>设置输出文件的缓冲模式</strong><br>　　参数<br>　　mode:<br>　　　“no”: 没有缓冲，即直接输出<br>　　　“full”: 全缓冲，即当缓冲满后才进行输出操作(也可调用flush马上输出)<br>　　　“line”: 以行为单位，进行输出(多用于终端设备)<br><strong>最后两种模式,size可以指定缓冲的大小</strong>(按字节)，<strong>忽略size将自动调整为最佳的大小</strong></td></tr><tr><td>file:write(…)</td><td>功能：<strong>按指定的参数格式输出文件内容，参数必须为字符或数字</strong>，若要输出<strong>其它值</strong>，则需<strong>通过tostring或string.format进行转换</strong></td></tr></tbody></table><p>以下实例使用了 <strong>seek 方法</strong>，<strong>定位到文件倒数第 25 个位置并使用 read 方法的 *a 参数</strong>，<strong>即从当前位置(倒数第 25 个位置)读取整个文件</strong>:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 以只读方式打开文件</span></span><br><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">&quot;test.lua&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"></span><br><span class="line">file:seek(<span class="string">&quot;end&quot;</span>,<span class="number">-25</span>)</span><br><span class="line"><span class="built_in">print</span>(file:<span class="built_in">read</span>(<span class="string">&quot;*a&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关闭打开的文件</span></span><br><span class="line">file:<span class="built_in">close</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">st.lua 文件末尾--test</span></span><br><span class="line"><span class="comment">--]]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="%E5%8D%81%E5%85%AB-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86" tabindex="-1">十八 错误处理</h1><h3 id="18.1-%E6%A6%82%E8%BF%B0" tabindex="-1">18.1 概述</h3><ol><li><p>程序运行中错误处理是必要的，在我们进行文件操作，数据转移及web service 调用过程中都会出现不可预期的错误。如果不注重错误信息的处理，就会造成信息泄露，程序无法运行等情况。</p></li><li><p>任何程序语言中，都需要错误处理。错误类型有：</p><ul><li>语法错误</li><li>运行错误</li></ul></li></ol><h3 id="18.2-%E8%AF%AD%E6%B3%95%E9%94%99%E8%AF%AF" tabindex="-1">18.2 语法错误</h3><p>1.语法错误通常是由于对程序的组件（如运算符、表达式）使用不当引起的。一个简单的实例如下：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- test.lua 文件</span></span><br><span class="line">a == <span class="number">2</span></span><br></pre></td></tr></table></figure><p>以上代码执行结果为：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lua: test.lua:<span class="number">2</span>: syntax <span class="built_in">error</span> near <span class="string">&#x27;==&#x27;</span></span><br></pre></td></tr></table></figure><p>正如你所看到的，以上出现了语法错误，一个 “=” 号跟两个 “=” 号是有区别的。一个 “=” 是赋值表达式两个 “=” 是比较运算。</p><h3 id="18.3-%E8%BF%90%E8%A1%8C%E9%94%99%E8%AF%AF" tabindex="-1">18.3 运行错误</h3><ol><li>运行错误是程序可以正常执行，但是会输出报错信息。如下实例由于参数输入错误，程序执行时报错：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(a,b)</span></span></span><br><span class="line">   <span class="keyword">return</span> a+b</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>当我们编译运行以上代码时，编译是可以成功的，但在运行的时候会产生如下错误：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lua: test2.lua:<span class="number">2</span>: attempt to perform arithmetic on <span class="keyword">local</span> <span class="string">&#x27;b&#x27;</span> (a <span class="literal">nil</span> value)</span><br><span class="line">stack <span class="built_in">traceback</span>:</span><br><span class="line">    test2.lua:<span class="number">2</span>: <span class="keyword">in</span> <span class="function"><span class="keyword">function</span> &#x27;<span class="title">add</span>&#x27;</span></span><br><span class="line"><span class="function">    <span class="title">test2.lua</span>:5: <span class="title">in</span> <span class="title">main</span> <span class="title">chunk</span></span></span><br><span class="line"><span class="function">    [<span class="title">C</span>]: ?</span></span><br></pre></td></tr></table></figure><p>lua 里调用函数时，即使实参列表和形参列表不一致也能成功调用，多余的参数会被舍弃，缺少的参数会被补为 nil。<br><strong>以上报错信息是由于参数 b 被补为 nil 后，nil 参与了 + 运算</strong>。<br>假如 add 函数内不是 “return a+b” 而是 “print(a,b)” 的话，结果会变成 “10 nil” 不会报错。</p><h3 id="18.4-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86" tabindex="-1">18.4 错误处理</h3><p>可以使用两个函数：<strong>assert 和 error 来处理错误</strong>。实例如下：</p><ol><li>assert</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(a,b)</span></span></span><br><span class="line">   <span class="built_in">assert</span>(<span class="built_in">type</span>(a) == <span class="string">&quot;number&quot;</span>, <span class="string">&quot;a 不是一个数字&quot;</span>)</span><br><span class="line">   <span class="built_in">assert</span>(<span class="built_in">type</span>(b) == <span class="string">&quot;number&quot;</span>, <span class="string">&quot;b 不是一个数字&quot;</span>)</span><br><span class="line">   <span class="keyword">return</span> a+b</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">add(<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>执行以上程序会出现如下错误：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">lua: test.lua:<span class="number">3</span>: b 不是一个数字</span><br><span class="line">stack <span class="built_in">traceback</span>:</span><br><span class="line">    [C]: <span class="keyword">in</span> <span class="function"><span class="keyword">function</span> &#x27;<span class="title">assert</span>&#x27;</span></span><br><span class="line"><span class="function">    <span class="title">test.lua</span>:3: <span class="title">in</span> <span class="title">local</span> &#x27;<span class="title">add</span>&#x27;</span></span><br><span class="line"><span class="function">    <span class="title">test.lua</span>:6: <span class="title">in</span> <span class="title">main</span> <span class="title">chunk</span></span></span><br><span class="line"><span class="function">    [<span class="title">C</span>]: <span class="title">in</span> ?</span></span><br><span class="line"><span class="function"></span></span><br></pre></td></tr></table></figure><p>实例中<strong>assert首先检查第一个参数，若没问题</strong>，assert<strong>不做任何事情</strong>；<strong>否则</strong>，assert<strong>以第二个参数作为错误信息抛出</strong>。<br>2. error</p><ul><li>语法格式：</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">error</span> (message [, level])</span><br></pre></td></tr></table></figure><ul><li>功能：<strong>终止正在执行的函数，并返回message的内容作为错误信息</strong>(<strong>error函数永远都不会返回</strong>)</li><li>通常情况下，error会附加一些错误位置的信息到message头部。</li><li>Level参数指示获得错误的位置:<ul><li><strong>Level=1[默认]：为调用error位置(文件+行号)</strong></li><li><strong>Level=2：指出哪个调用error的函数的函数</strong></li><li><strong>Level=0:不添加错误位置信息</strong></li></ul></li></ul><h3 id="18.5-pcall-%E5%92%8C-xpcall%E3%80%81debug" tabindex="-1">18.5 pcall 和 xpcall、debug</h3><ol><li>pcall<br>(1) Lua中处理错误，可以<strong>使用函数pcall（protected call）来包装需要执行的代码</strong>。<br>(2) pcall接收<strong>一个函数和要传递给后者(即函数)的参数</strong>，并执行，<strong>执行结果: 有错误、无错误</strong>. 返回值<strong>true或false，errorinfo（实际好像只返回一个true或false，没有其他信息）</strong>。</li></ol><p>语法格式如下:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">pcall</span>(function_name, ….) <span class="keyword">then</span></span><br><span class="line"><span class="comment">-- 没有错误</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="comment">-- 一些错误</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>(3) 简单实例：</p><figure class="highlight lua"><figcaption><span>&#123;.line-numbers&#125;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">f=<span class="built_in">pcall</span>(<span class="function"><span class="keyword">function</span><span class="params">(i)</span></span> <span class="built_in">print</span>(i) <span class="keyword">end</span>, <span class="number">33</span>)</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line">   </span><br><span class="line">t=<span class="built_in">pcall</span>(<span class="function"><span class="keyword">function</span><span class="params">(i)</span></span> <span class="built_in">print</span>(i) <span class="built_in">error</span>(<span class="string">&#x27;error..&#x27;</span>) <span class="keyword">end</span>, <span class="number">33</span>)</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">33</span></span><br><span class="line"><span class="comment">true</span></span><br><span class="line"><span class="comment">33</span></span><br><span class="line"><span class="comment">false  </span></span><br><span class="line"><span class="comment">]]</span></span><br></pre></td></tr></table></figure><p>第4行 由于error(‘error…’)终止了正在进行的函数  所以返回false</p><p>(4) pcall以一种 <strong>&quot;保护模式&quot;来调用第一个参数</strong>，因此pcall可以<strong>捕获函数执行中的任何错误</strong>。通常在错误发生时，希望落得更多的调试信息，而不只是发生错误的位置。但<strong>pcall返回时，它已经销毁了调用桟的部分内容</strong>。</p><ol start="2"><li>xpcall与debug<br>(1) Lua提供了xpcall函数，<strong>xpcall接收第二个参数——一个错误处理函数</strong>，当<strong>错误发生</strong>时，<strong>Lua会在调用桟展开（unwind）前调用错误处理函数</strong>，于是就可以<strong>在这个函数中使用debug库来获取关于错误的额外信息</strong>了。</li></ol><p>(2) <strong>debug</strong>库提供了两个通用的<strong>错误处理函数</strong>:</p><ul><li>debug.debug：<strong>提供一个Lua提示符，让用户来检查错误的原因</strong></li><li>debug.traceback：<strong>根据调用桟来构建一个扩展的错误消息</strong></li></ul><p>(3) 实例</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;=<span class="built_in">xpcall</span>(<span class="function"><span class="keyword">function</span><span class="params">(i)</span></span> <span class="built_in">print</span>(i) <span class="built_in">error</span>(<span class="string">&#x27;error..&#x27;</span>) <span class="keyword">end</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span> <span class="built_in">print</span>(<span class="built_in">debug</span>.<span class="built_in">traceback</span>()) <span class="keyword">end</span>, <span class="number">33</span>)</span><br><span class="line"><span class="number">33</span></span><br><span class="line">stack <span class="built_in">traceback</span>:</span><br><span class="line"><span class="built_in">stdin</span>:<span class="number">1</span>: <span class="keyword">in</span> <span class="function"><span class="keyword">function</span> &lt;<span class="title">stdin</span>:1&gt;</span></span><br><span class="line"><span class="function">[<span class="title">C</span>]: <span class="title">in</span> <span class="title">function</span> &#x27;<span class="title">error</span>&#x27;</span></span><br><span class="line"><span class="function"><span class="title">stdin</span>:1: <span class="title">in</span> <span class="title">function</span> &lt;<span class="title">stdin</span>:1&gt;</span></span><br><span class="line"><span class="function">[<span class="title">C</span>]: <span class="title">in</span> <span class="title">function</span> &#x27;<span class="title">xpcall</span>&#x27;</span></span><br><span class="line"><span class="function"><span class="title">stdin</span>:1: <span class="title">in</span> <span class="title">main</span> <span class="title">chunk</span></span></span><br><span class="line"><span class="function">[<span class="title">C</span>]: <span class="title">in</span> ?</span></span><br><span class="line"><span class="function"><span class="title">false</span>        <span class="title">nil</span></span></span><br></pre></td></tr></table></figure><p>(4) 实例2</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myfunction</span> <span class="params">()</span></span></span><br><span class="line">   n = n/<span class="literal">nil</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myerrorhandler</span><span class="params">( err )</span></span></span><br><span class="line">   <span class="built_in">print</span>( <span class="string">&quot;ERROR:&quot;</span>, err )</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">status</span> = <span class="built_in">xpcall</span>( myfunction, myerrorhandler )</span><br><span class="line"><span class="built_in">print</span>( <span class="built_in">status</span>)</span><br></pre></td></tr></table></figure><p>执行以上程序会出现如下错误：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ERROR:    test2.lua:<span class="number">2</span>: attempt to perform arithmetic on global <span class="string">&#x27;n&#x27;</span> (a <span class="literal">nil</span> value)</span><br><span class="line"><span class="literal">false</span></span><br></pre></td></tr></table></figure><h1 id="%E5%8D%81%E4%B9%9D-%E8%B0%83%E8%AF%95(debug)" tabindex="-1">十九 调试(Debug)</h1><h3 id="19.1-%E6%A6%82%E8%BF%B0%E5%8F%8Adebug%E7%9A%84%E6%96%B9%E6%B3%95" tabindex="-1">19.1 概述及Debug的方法</h3><ol><li><p>Lua 提供了 debug 库用于提供创建我们自定义调试器的功能。Lua 本身并未有内置的调试器，但很多开发者共享了他们的 Lua 调试器代码。</p></li><li><p>Lua 中 debug 库包含以下函数：</p></li></ol><table><thead><tr><th>序号</th><th>方法</th><th>用途</th></tr></thead><tbody><tr><td>1</td><td>debug()</td><td><strong>进入一个用户交互模式，运行用户输入的每个字符串</strong>。 使用简单的命令以及其它调试设置，用户可以检阅全局变量和局部变量， 改变变量的值，计算一些表达式，等等。<br>输入一行仅包含 cont 的字符串将结束这个函数， 这样调用者就可以继续向下运行。</td></tr><tr><td>2</td><td>getfenv(object)</td><td><strong>返回对象的环境变量</strong>。</td></tr><tr><td>3</td><td>gethook(optional thread)</td><td><strong>返回三个表示线程钩子设置的值</strong>： 当前钩子函数，当前钩子掩码，当前钩子计数</td></tr><tr><td>4</td><td>getinfo ([thread,] f [, what])</td><td><strong>返回关于一个函数信息的表</strong>。 你可以直接提供该函数， 也可以用一个数字 f 表示该函数。 数字 <strong>f 表示运行在指定线程的调用栈对应层次上的函数</strong>： <strong>0 层表示当前函数</strong>（<strong>getinfo 自身</strong>）； <strong>1 层表示调用 getinfo 的函数</strong> （除非是尾调用，这种情况不计入栈）；等等。 如果 <strong>f 是一个比活动函数数量还大的数字</strong>， getinfo <strong>返回 nil</strong>。</td></tr><tr><td>5</td><td>debug.getlocal ([thread,] f, local)</td><td>此函数<strong>返回在栈的 f 层处函数的索引为 local 的局部变量 的名字和值</strong>。 这个函数不仅用于访问显式定义的局部变量，也包括形参、临时变量等。</td></tr><tr><td>6</td><td>getmetatable(value)</td><td><strong>把给定索引指向的值的元表压入堆栈</strong>。如果<strong>索引无效</strong>，或是这个值没有元表，<strong>函数将返回 0 并且不会向栈上压任何东西</strong>。</td></tr><tr><td>7.</td><td>getregistry()</td><td><strong>返回注册表表</strong>，这是一个预定义出来的表， 可以用来<strong>保存任何 C 代码想保存的 Lua 值</strong>。</td></tr><tr><td>8</td><td>getupvalue (f, up)</td><td>此函数<strong>返回函数 f 的第 up 个上值的名字和值(即函数中定义的第up个变量的名和值)</strong>。 如果该函数没有那个上值，返回 nil 。<br>以 ‘(’ （开括号）打头的变量名表示没有名字的变量 （去除了调试信息的代码块）。</td></tr><tr><td>9</td><td>sethook ([thread,] hook, mask [, count])</td><td><strong>将一个函数作为钩子函数设入</strong>。 字符串 mask 以及数字 count <strong>决定了钩子将在何时调用</strong>。 掩码是由下列字符组合成的字符串，每个字符有其含义：<strong><br>‘c’: 每当 Lua 调用一个函数时，调用钩子；<br>‘r’: 每当 Lua 从一个函数内返回时，调用钩子；<br>‘l’: 每当 Lua 进入新的一行时，调用钩子</strong>。</td></tr><tr><td>10</td><td>setlocal ([thread,] level, local, value)</td><td>这个函数<strong>将 value 赋给 栈上第 level 层函数的第 local 个局部变量</strong>。 如果<strong>没有</strong>那个变量，函数<strong>返回 nil</strong> 。 如果 level<strong>越界</strong>，<strong>抛出</strong>一个<strong>错误</strong>。</td></tr><tr><td>11</td><td>setmetatable (value, table)</td><td><strong>将 value 的元表设为 table</strong>（可以是 nil）。 返回 value。</td></tr><tr><td>12</td><td>setupvalue (f, up, value)</td><td><strong>这个函数将 value 设为函数 f 的第 up 个上值</strong>。 如果函数没有那个上值，返回 nil 否则，返回该上值的名字。</td></tr><tr><td>13</td><td>traceback ([thread,] [message [, level]])</td><td><strong>如果 message 有，且不是字符串或 nil， 函数不做任何处理直接返回 message</strong>。 <strong>否则</strong>，它<strong>返回调用栈的栈回溯信息</strong>。 字符串可选项 message 被添加在栈回溯信息的开头。 数字<strong>可选项 level 指明从栈的哪一层开始回溯</strong> （**默认为 1 **，即调用 traceback 的那里）。</td></tr></tbody></table><ol start="3"><li>上表列出了我们常用的调试函数，接下来我们可以看些简单的例子：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myfunction</span> <span class="params">()</span></span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">debug</span>.<span class="built_in">traceback</span>(<span class="string">&quot;Stack trace&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">debug</span>.<span class="built_in">getinfo</span>(<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Stack trace end&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">myfunction ()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">debug</span>.<span class="built_in">getinfo</span>(<span class="number">1</span>))</span><br></pre></td></tr></table></figure><p>执行以上代码输出结果为：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Stack trace</span><br><span class="line">stack <span class="built_in">traceback</span>:</span><br><span class="line">c:\Users\XXX\Desktop\notes\Lua\test.lua:<span class="number">2</span>: <span class="keyword">in</span> <span class="function"><span class="keyword">function</span> &#x27;<span class="title">myfunction</span>&#x27;</span></span><br><span class="line"><span class="function"><span class="title">c</span>:\<span class="title">Users</span>\<span class="title">XXX</span>\<span class="title">Desktop</span>\<span class="title">notes</span>\<span class="title">Lua</span>\<span class="title">test.lua</span>:7: <span class="title">in</span> <span class="title">main</span> <span class="title">chunk</span></span></span><br><span class="line"><span class="function">[<span class="title">C</span>]: ?</span></span><br><span class="line"><span class="function"><span class="title">table</span>: 03069<span class="title">D28</span></span></span><br><span class="line"><span class="function"><span class="title">Stack</span> <span class="title">trace</span> <span class="title">end</span></span></span><br><span class="line"><span class="function"><span class="title">table</span>: 03069<span class="title">C60</span></span></span><br></pre></td></tr></table></figure><ol start="4"><li>我们经常需要调试函数的内的局部变量。我们可以使用 setupvalue 函数来设置这些局部变量。实例如下：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">newCounter</span> <span class="params">()</span></span></span><br><span class="line">  <span class="keyword">local</span> n = <span class="number">0</span></span><br><span class="line">  <span class="keyword">local</span> k = <span class="number">0</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">    k = n</span><br><span class="line">    n = n + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">counter = newCounter ()</span><br><span class="line"><span class="built_in">print</span>(counter())</span><br><span class="line"><span class="built_in">print</span>(counter())</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> i = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">repeat</span></span><br><span class="line">  name, val = <span class="built_in">debug</span>.<span class="built_in">getupvalue</span>(counter, i)</span><br><span class="line">  <span class="keyword">if</span> name <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;index&quot;</span>, i, name, <span class="string">&quot;=&quot;</span>, val)</span><br><span class="line">        <span class="keyword">if</span>(name == <span class="string">&quot;n&quot;</span>) <span class="keyword">then</span></span><br><span class="line">                <span class="built_in">debug</span>.<span class="built_in">setupvalue</span> (counter,<span class="number">2</span>,<span class="number">10</span>)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">  <span class="keyword">end</span> <span class="comment">-- if</span></span><br><span class="line"><span class="keyword">until</span> <span class="keyword">not</span> name</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(counter())</span><br></pre></td></tr></table></figure><p>执行以上代码输出结果为：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line">index    <span class="number">1</span>    k    =    <span class="number">1</span></span><br><span class="line">index    <span class="number">2</span>    n    =    <span class="number">2</span></span><br><span class="line"><span class="number">11</span></span><br></pre></td></tr></table></figure><p>在以上实例中，计数器在每次调用时都会自增1。实例中我们使用了 getupvalue 函数查看局部变量的当前状态。我们可以<strong>设置局部变量为新值。实例中，在设置前 n 的值为 2,使用 setupvalue 函数将其设置为 10。现在我们调用函数，执行后输出为 11 而不是 3</strong>。</p><h3 id="19.2-%E8%B0%83%E8%AF%95%E7%B1%BB%E5%9E%8B" tabindex="-1">19.2 调试类型</h3><ul><li>命令行调试<ul><li>命令行调试器有：RemDebug、clidebugger、ctrace、xdbLua、LuaInterface - Debugger、Rldb、ModDebug。</li></ul></li><li>图形界面调试<ul><li>图形界调试器有：SciTE、Decoda、ZeroBrane Studio、akdebugger、luaedit。</li></ul></li></ul><h1 id="%E4%BA%8C%E5%8D%81-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6" tabindex="-1">二十 垃圾回收</h1><h3 id="20.1-%E6%A6%82%E8%BF%B0" tabindex="-1">20.1 概述</h3><ol><li><p>Lua 采用了<strong>自动内存管理</strong>。 这意味着你<strong>不用操心</strong>新创建的对象需要的内存如何分配出来， 也不用考虑在对象不再被使用后怎样释放它们所占用的内存。</p></li><li><p>Lua运行了一个<strong>垃圾收集器</strong>来收集所有<strong>死对象</strong> （即在 Lua 中不可能再访问到的对象）<strong>来完成自动内存管理的工作</strong>。 Lua 中所有用到的内存，如：<strong>字符串、表、用户数据、函数、线程、 内部结构等，都服从自动管理</strong>。</p></li><li><p>Lua 实现了一个<strong>增量标记-扫描收集器</strong>。 它<strong>使用这两个数字来控制垃圾收集循环</strong>： <strong>垃圾收集器间歇率和垃圾收集器步进倍率</strong>。 这两个数字都使用百分数为单位 （例如：值 100 在内部表示 1 ）。</p></li><li><p><strong>垃圾收集器间歇率</strong>控制着收集器需要在<strong>开启新的循环前要等待多久</strong>。 <strong>增大这个值会减少收集器的积极性</strong>。 当这个值比 100 小的时候，收集器在开启新的循环前不会有等待。 设置这个值为 200 就会让收集器等到总内存使用量达到 之前的两倍时才开始新的循环。</p></li><li><p><strong>垃圾收集器步进倍率</strong>控制着<strong>收集器运作速度相对于内存分配速度的倍率</strong>。 增大这个值<strong>不仅会让收集器更加积极，还会增加每个增量步骤的长度</strong>。 不要把这个值设得小于 100 ， 那样的话收集器就工作的太慢了以至于永远都干不完一个循环。 默认值是 200 ，这表示收集器以内存分配的&quot;两倍&quot;速工作。</p></li><li><p>如果你把步进倍率设为一个非常大的数字 （比你的程序可能用到的字节数还大 10% ）， 收集器的行为就像一个 stop-the-world 收集器。 接着你若把间歇率设为 200 ， 收集器的行为就和过去的 Lua 版本一样了： 每次 Lua 使用的内存翻倍时，就做一次完整的收集。</p></li></ol><h3 id="20.2-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E5%99%A8%E5%87%BD%E6%95%B0" tabindex="-1">20.2 垃圾回收器函数</h3><ol><li>Lua 提供了以下函数<strong>collectgarbage ([opt [, arg]])<strong>用来控制自动内存管理，根据</strong>参数opt的不同，提供不同的功能</strong>:</li></ol><ul><li><p>collectgarbage(“collect”): <strong>做一次完整的垃圾收集循环</strong>。通过参数 opt 它提供了一组不同的功能：</p></li><li><p>collectgarbage(“count”): <strong>以 K 字节数为单位返回 Lua 使用的总内存数</strong>。 这个值有小数部分，所以只需要<strong>乘上 1024 就能得到 Lua 使用的准确字节数</strong>（除非溢出）。</p></li><li><p>collectgarbage(“restart”): <strong>重启垃圾收集器的自动运行</strong>。</p></li><li><p>collectgarbage(“setpause”): 将 <strong>arg 设为收集器的 间歇率</strong>。 <strong>返回 间歇率 的前一个值</strong>。</p></li><li><p>collectgarbage(“setstepmul”): 返回 <strong>步进倍率 的前一个值</strong>。</p></li><li><p>collectgarbage(“step”): <strong>单步运行垃圾收集器</strong>。 步长&quot;大小&quot;由 arg 控制。 传入 0 时，收集器步进（不可分割的）一步。 传入非 0 值， 收集器收集相当于 Lua 分配这些多（K 字节）内存的工作。 如果收集器结束一个循环将返回 true 。</p></li><li><p>collectgarbage(“stop”): <strong>停止垃圾收集器的运行</strong>。 在调用重启前，收集器只会因显式的调用运行。</p></li></ul><ol start="2"><li>实例</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mytable = &#123;<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;orange&quot;</span>, <span class="string">&quot;banana&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">collectgarbage</span>(<span class="string">&quot;count&quot;</span>))</span><br><span class="line"></span><br><span class="line">mytable = <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">collectgarbage</span>(<span class="string">&quot;count&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">collectgarbage</span>(<span class="string">&quot;collect&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">collectgarbage</span>(<span class="string">&quot;count&quot;</span>))</span><br></pre></td></tr></table></figure><p>执行以上程序，输出结果如下(注意内存使用的变化)：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">20.9560546875</span></span><br><span class="line"><span class="number">20.9853515625</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">19.4111328125</span></span><br></pre></td></tr></table></figure><p>lua中 有自动定时执行垃圾回收的机制<br>unity中热更新开发 尽量不要去自动执行垃圾回收</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">通过<span class="built_in">collectgarbage</span>(<span class="string">&quot;setpause&quot;</span>,<span class="number">100</span>) 设置垃圾回收的间隔时间</span><br><span class="line">通过<span class="built_in">collectgarbage</span>(<span class="string">&quot;setstepmul&quot;</span>,<span class="number">200</span>) 设置垃圾回收的速度</span><br><span class="line">通过<span class="built_in">collectgarbage</span>(<span class="string">&quot;stop&quot;</span>) 停止自动执行垃圾回收</span><br><span class="line">通过<span class="built_in">collectgarbage</span>(<span class="string">&quot;restart&quot;</span>) 重新开始自动执行垃圾回收</span><br><span class="line">通过<span class="built_in">collectgarbage</span>(<span class="string">&quot;step&quot;</span>,<span class="number">100</span>) 执行一次垃圾回收</span><br><span class="line">通过<span class="built_in">collectgarbage</span>(<span class="string">&quot;isrunning&quot;</span>) 判断垃圾回收是否正在执行</span><br></pre></td></tr></table></figure><h1 id="%E4%BA%8C%E5%8D%81%E4%B8%80-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E2%AD%90%EF%BC%89" tabindex="-1">二十一 面向对象（⭐）</h1><h3 id="21.1-%E6%A6%82%E8%BF%B0" tabindex="-1">21.1 概述</h3><ol><li>面向对象编程（Object Oriented Programming，OOP）是一种非常流行的计算机编程架构。<br>以下几种编程语言都支持面向对象编程：</li></ol><ul><li>C++</li><li>Java</li><li>Objective-C</li><li>Smalltalk</li><li>C#</li><li>Ruby</li></ul><h3 id="21.2-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%89%B9%E5%BE%81" tabindex="-1">21.2 面向对象特征</h3><p><strong>一般是 封装、继承、多态</strong></p><ul><li>1） 封装：指能够把一个实体的信息、功能、响应都装入一个单独的对象中的特性。</li><li>2） 继承：继承的方法允许在不改动原程序的基础上对其进行扩充，这样使得原功能得以保存，而新功能也得以扩展。这有利于减少重复编码，提高软件的开发效率。</li><li>3） 多态：同一操作作用于不同的对象，可以有不同的解释，产生不同的执行结果。在运行时，可以通过指向基类的指针，来调用实现派生类中的方法。</li><li>4）抽象：抽象(Abstraction)是简化复杂的现实问题的途径，它可以为具体问题找到最恰当的类定义，并且可以在最恰当的继承级别解释问题。</li></ul><h3 id="21.3-lua-%E4%B8%AD%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1" tabindex="-1">21.3 Lua 中面向对象</h3><ol><li>我们知道，<strong>对象由属性和方法组成</strong>。LUA中最基本的结构是table，所以需要<strong>用table来描述对象的属性</strong>。</li><li>lua 中的<strong>function 可以用来表示方法</strong>。那么<strong>LUA中的类可以通过 table + function 模拟出来</strong>。</li><li>至于<strong>继承，可以通过 metetable 模拟出来</strong>（不推荐用，只模拟最基本的对象大部分实现够用了）。</li><li><strong>Lua 中的表不仅在某种意义上是一种对象</strong>。像对象一样，表也有状态（成员变量）；也有与对象的值独立的本性，特别是拥有两个不同值的对象（table）代表两个不同的对象；一个对象在不同的时候也可以有不同的值，但他始终是一个对象；与对象类似，表的生命周期与其由什么创建、在哪创建没有关系。对象有他们的成员函数，表也有：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Account = &#123;balance = <span class="number">0</span>&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Account.withdraw</span> <span class="params">(v)</span></span></span><br><span class="line">    Account.balance = Account.balance - v</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>这个定义创建了一个新的函数，并且保存在Account对象的withdraw域内，下面我们可以这样调用：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Account.withdraw(<span class="number">100.00</span>)</span><br></pre></td></tr></table></figure><h3 id="21.4-%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8B%EF%BC%88%E2%AD%90%EF%BC%89" tabindex="-1">21.4 简单实例（⭐）</h3><ol><li>以下简单的类包含了三个属性： area, length 和 breadth，printArea方法用于打印计算结果：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 元类</span></span><br><span class="line">Rectangle = &#123;area = <span class="number">0</span>, length = <span class="number">0</span>, breadth = <span class="number">0</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 派生类的方法 new</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle:new</span> <span class="params">(o,length,breadth)</span></span></span><br><span class="line">  o = o <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">  <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">  <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">  <span class="built_in">self</span>.length = length <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line">  <span class="built_in">self</span>.breadth = breadth <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line">  <span class="built_in">self</span>.area = length*breadth;</span><br><span class="line">  <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 派生类的方法 printArea</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle:printArea</span> <span class="params">()</span></span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;矩形面积为 &quot;</span>,<span class="built_in">self</span>.area)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ol start="2"><li>创建对象</li></ol><p>创建对象是为类的实例分配内存的过程。每个类都有属于自己的内存并共享公共数据。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r = Rectangle:new(<span class="literal">nil</span>,<span class="number">10</span>,<span class="number">20</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>访问属性</li></ol><p>我们可以使用点号(.)来访问类的属性：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(r.length)</span><br></pre></td></tr></table></figure><ol start="4"><li>访问成员函数</li></ol><p>我们可以使用冒号 : 来访问类的成员函数：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r:printArea()</span><br></pre></td></tr></table></figure><p>内存在对象初始化时分配。</p><ol start="5"><li>以下我们演示了 Lua 面向对象的完整实例：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 元类</span></span><br><span class="line">Shape = &#123;area = <span class="number">0</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 基础类方法 new</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape:new</span> <span class="params">(o,side)</span></span></span><br><span class="line">  o = o <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">  <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">  <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">  side = side <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line">  <span class="built_in">self</span>.area = side*side;</span><br><span class="line">  <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 基础类方法 printArea</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape:printArea</span> <span class="params">()</span></span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;面积为 &quot;</span>,<span class="built_in">self</span>.area)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建对象</span></span><br><span class="line">myshape = Shape:new(<span class="literal">nil</span>,<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">myshape:printArea()</span><br></pre></td></tr></table></figure><p>执行以上程序，输出结果为：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">面积为     <span class="number">100</span></span><br></pre></td></tr></table></figure><h3 id="21.5-%E7%82%B9%E8%B0%83%E7%94%A8%E5%92%8C%E5%86%92%E5%8F%B7%E8%B0%83%E7%94%A8%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%88%E2%AD%90%E2%AD%90%E2%AD%90%EF%BC%89" tabindex="-1">21.5 点调用和冒号调用的区别（⭐⭐⭐）</h3><ul><li>点就是正常调用函数</li><li>冒号是会把 调用者 作为第一个参数传入</li><li>冒号可以用来声明函数 只能是function 表名::函数名 的形式</li><li>如果是冒号声明相当于有一个默认参数self</li><li>lua中 有一个关键字 self 表示 默认传入的第一个参数 。用来冒号声明时作为第一个参数的代表</li><li>注: self不是this 只是第一个参数</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student:Speak2</span><span class="params">()</span></span></span><br><span class="line">    <span class="comment">-- lua中 有一个关键字 self 表示 默认传入的第一个参数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">self</span>.name..<span class="string">&quot;Speak2&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">Student:Speak2()</span><br><span class="line">Student.Speak2(Student)</span><br></pre></td></tr></table></figure><h3 id="21.6-lua-%E7%BB%A7%E6%89%BF(%E2%AD%90%E2%AD%90%E2%AD%90)" tabindex="-1">21.6 Lua 继承(⭐⭐⭐)</h3><ol><li>继承是指一个对象直接使用另一对象的属性和方法。可用于扩展基础类的属性和方法。<br>以下演示了一个简单的继承实例：</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Meta class</span></span><br><span class="line">Shape = &#123;area = <span class="number">0</span>&#125;</span><br><span class="line"><span class="comment">-- 基础类方法 new</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape:new</span> <span class="params">(o,side)</span></span></span><br><span class="line">  o = o <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">  <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">  <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">  side = side <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line">  <span class="built_in">self</span>.area = side*side;</span><br><span class="line">  <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 基础类方法 printArea</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape:printArea</span> <span class="params">()</span></span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;面积为 &quot;</span>,<span class="built_in">self</span>.area)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ol start="2"><li>Square 对象继承了 Shape 类:</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Square = Shape:new()</span><br><span class="line"><span class="comment">-- Derived class method new</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Square:new</span> <span class="params">(o,side)</span></span></span><br><span class="line">  o = o <span class="keyword">or</span> Shape:new(o,side)</span><br><span class="line">  <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">  <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">  <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><ol start="3"><li>完整示例（⭐⭐⭐）</li></ol><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Meta class</span></span><br><span class="line">Shape = &#123;area = <span class="number">0</span>&#125;</span><br><span class="line"><span class="comment">-- 基础类方法 new</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape:new</span> <span class="params">(o,side)</span></span></span><br><span class="line">  o = o <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">  <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">  <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">  side = side <span class="keyword">or</span> <span class="number">0</span></span><br><span class="line">  <span class="built_in">self</span>.area = side*side;</span><br><span class="line">  <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">-- 基础类方法 printArea</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Shape:printArea</span> <span class="params">()</span></span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;面积为 &quot;</span>,<span class="built_in">self</span>.area)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建对象</span></span><br><span class="line">myshape = Shape:new(<span class="literal">nil</span>,<span class="number">10</span>)</span><br><span class="line">myshape:printArea()</span><br><span class="line"></span><br><span class="line">Square = Shape:new()</span><br><span class="line"><span class="comment">-- 派生类方法 new</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Square:new</span> <span class="params">(o,side)</span></span></span><br><span class="line">  o = o <span class="keyword">or</span> Shape:new(o,side)</span><br><span class="line">  <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">  <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">  <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 派生类方法 printArea</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Square:printArea</span> <span class="params">()</span></span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;正方形面积为 &quot;</span>,<span class="built_in">self</span>.area)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建对象</span></span><br><span class="line">mysquare = Square:new(<span class="literal">nil</span>,<span class="number">10</span>)</span><br><span class="line">mysquare:printArea()</span><br><span class="line"></span><br><span class="line">Rectangle = Shape:new()</span><br><span class="line"><span class="comment">-- 派生类方法 new</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle:new</span> <span class="params">(o,length,breadth)</span></span></span><br><span class="line">  o = o <span class="keyword">or</span> Shape:new(o)</span><br><span class="line">  <span class="built_in">setmetatable</span>(o, <span class="built_in">self</span>)</span><br><span class="line">  <span class="built_in">self</span>.<span class="built_in">__index</span> = <span class="built_in">self</span></span><br><span class="line">  <span class="built_in">self</span>.area = length * breadth</span><br><span class="line">  <span class="keyword">return</span> o</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 派生类方法 printArea</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle:printArea</span> <span class="params">()</span></span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;矩形面积为 &quot;</span>,<span class="built_in">self</span>.area)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建对象</span></span><br><span class="line">myrectangle = Rectangle:new(<span class="literal">nil</span>,<span class="number">10</span>,<span class="number">20</span>)</span><br><span class="line">myrectangle:printArea()</span><br></pre></td></tr></table></figure><h3 id="21.7-lua%E5%A4%9A%E6%80%81%EF%BC%88%E5%87%BD%E6%95%B0%E9%87%8D%E5%86%99%EF%BC%89" tabindex="-1">21.7 Lua多态（函数重写）</h3><p>Lua 中我们可以重写基础类的函数，在派生类中定义自己的实现方式：</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 派生类方法 printArea</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Square:printArea</span> <span class="params">()</span></span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;正方形面积 &quot;</span>,<span class="built_in">self</span>.area)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><h1 id="%E4%BA%8C%E5%8D%81%E4%BA%8C-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BF%E9%97%AE%EF%BC%88luasql%EF%BC%89" tabindex="-1">二十二 数据库访问（LuaSQL）</h1><h3 id="22.1-%E6%A6%82%E8%BF%B0" tabindex="-1">22.1 概述</h3><ol><li>本文主要为大家介绍 Lua 数据库的操作库：LuaSQL。他是开源的，支持的数据库有：ODBC, ADO, Oracle, MySQL, SQLite 和 PostgreSQL。</li><li>本文介绍MySQL的数据库连接。</li></ol><h3 id="22.2-%E5%AE%89%E8%A3%85" tabindex="-1">22.2 安装</h3><ol><li>LuaSQL 可以使用 <a href="https://luarocks.org/">LuaRocks</a> 来安装可以根据需要安装你需要的数据库驱动。<br>LuaRocks 安装方法：</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">wget http://luarocks.org/releases/luarocks-2.2.1.tar.gz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar zxpf luarocks-2.2.1.tar.gz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> luarocks-2.2.1</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./configure; <span class="built_in">sudo</span> make bootstrap</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sudo</span> luarocks install luasocket</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">lua</span></span><br><span class="line">Lua 5.3.0 Copyright (C) 1994-2015 Lua.org, PUC-Rio</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">require <span class="string">&quot;socket&quot;</span></span></span><br></pre></td></tr></table></figure><ol start="2"><li><p>Window 下安装 LuaRocks：<a href="https://github.com/keplerproject/luarocks/wiki/Installation-instructions-for-Windows">https://github.com/keplerproject/luarocks/wiki/Installation-instructions-for-Windows</a></p></li><li><p>安装不同数据库驱动：</p></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">luarocks install luasql-sqlite3</span><br><span class="line">luarocks install luasql-postgres</span><br><span class="line">luarocks install luasql-mysql</span><br><span class="line">luarocks install luasql-sqlite</span><br><span class="line">luarocks install luasql-odbc</span><br></pre></td></tr></table></figure><ol start="4"><li>也可以使用源码安装方式，Lua Github 源码地址：<a href="https://github.com/keplerproject/luasql">https://github.com/keplerproject/luasql</a></li></ol><h3 id="22.3-%E5%AE%9E%E4%BE%8B" tabindex="-1">22.3 实例</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span> <span class="string">&quot;luasql.mysql&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--创建环境对象</span></span><br><span class="line">env = luasql.mysql()</span><br><span class="line"></span><br><span class="line"><span class="comment">--连接数据库</span></span><br><span class="line">conn = env:connect(<span class="string">&quot;数据库名&quot;</span>,<span class="string">&quot;用户名&quot;</span>,<span class="string">&quot;密码&quot;</span>,<span class="string">&quot;IP地址&quot;</span>,端口)</span><br><span class="line"></span><br><span class="line"><span class="comment">--设置数据库的编码格式</span></span><br><span class="line">conn:<span class="built_in">execute</span><span class="string">&quot;SET NAMES UTF8&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--执行数据库操作</span></span><br><span class="line">cur = conn:<span class="built_in">execute</span>(<span class="string">&quot;select * from role&quot;</span>)</span><br><span class="line"></span><br><span class="line">row = cur:fetch(&#123;&#125;,<span class="string">&quot;a&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--文件对象的创建</span></span><br><span class="line">file = <span class="built_in">io</span>.<span class="built_in">open</span>(<span class="string">&quot;role.txt&quot;</span>,<span class="string">&quot;w+&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> row <span class="keyword">do</span></span><br><span class="line">    var = <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%d %s\n&quot;</span>, row.id, row.name)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(var)</span><br><span class="line"></span><br><span class="line">    file:<span class="built_in">write</span>(var)</span><br><span class="line"></span><br><span class="line">    row = cur:fetch(row,<span class="string">&quot;a&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file:<span class="built_in">close</span>()  <span class="comment">--关闭文件对象</span></span><br><span class="line">conn:<span class="built_in">close</span>()  <span class="comment">--关闭数据库连接</span></span><br><span class="line">env:<span class="built_in">close</span>()   <span class="comment">--关闭数据库环境</span></span><br></pre></td></tr></table></figure><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content>
    
    
    <summary type="html">&lt;p&gt;lua学习笔记&lt;/p&gt;</summary>
    
    
    
    <category term="热更新相关" scheme="http://example.com/categories/%E7%83%AD%E6%9B%B4%E6%96%B0%E7%9B%B8%E5%85%B3/"/>
    
    
    <category term="热更新相关" scheme="http://example.com/tags/%E7%83%AD%E6%9B%B4%E6%96%B0%E7%9B%B8%E5%85%B3/"/>
    
  </entry>
  
</feed>
